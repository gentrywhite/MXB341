<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">

<head>

<meta charset="utf-8">
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="generator" content="pandoc" />



<meta name="progressive" content="false" />
<meta name="allow-skip" content="false" />

<title>MXB341 Worksheet 08 - Bayesian Inference</title>


<!-- highlightjs -->
<style type="text/css">code{white-space: pre;}</style>
<style type="text/css">
  pre:not([class]) {
    background-color: white;
  }
</style>
<script type="text/javascript">
if (window.hljs) {
  hljs.configure({languages: []});
  hljs.initHighlightingOnLoad();
  if (document.readyState && document.readyState === "complete") {
    window.setTimeout(function() { hljs.initHighlighting(); }, 0);
  }
}
</script>

<!-- taken from https://github.com/rstudio/rmarkdown/blob/67b7f5fc779e4cfdfd0f021d3d7745b6b6e17149/inst/rmd/h/default.html#L296-L362 -->
<!-- tabsets -->

<style type="text/css">
.tabset-dropdown > .nav-tabs {
  display: inline-table;
  max-height: 500px;
  min-height: 44px;
  overflow-y: auto;
  background: white;
  border: 1px solid #ddd;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs > li.active:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li.active:before {
  content: "&#xe258;";
  border: none;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs > li.active {
  display: block;
}

.tabset-dropdown > .nav-tabs > li > a,
.tabset-dropdown > .nav-tabs > li > a:focus,
.tabset-dropdown > .nav-tabs > li > a:hover {
  border: none;
  display: inline-block;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li {
  display: block;
  float: none;
}

.tabset-dropdown > .nav-tabs > li {
  display: none;
}
</style>

<script>
$(document).ready(function () {
  window.buildTabsets("section-TOC");
});

$(document).ready(function () {
  $('.tabset-dropdown > .nav-tabs > li').click(function () {
    $(this).parent().toggleClass('nav-tabs-open')
  });
});
</script>
<!-- end tabsets -->


<link rel="stylesheet" href="css/QUT.css" type="text/css" />
<link rel="stylesheet" href="css/QUTtutorial.css" type="text/css" />

</head>

<body>



<div class="pageContent band">
<div class="bandContent page">

<div class="topics">

<p style="margin-bottom:0.6cm;"></p>

<a><img src = "images/logo.png" height="100px" 
          alt = "MXB341 Blackboard Page"><span style="font-size:40px;color:#00407a"> &thinsp; MXB341 Statistical Inference</span></a>

<p style="margin-bottom:1cm;"></p>
<style type="text/css">
.pageContent {
}

.band {
  padding-left: 5%;
  padding-right: 5%;
  position: relative;
}

.bandContent {
  margin: 0 auto;
  max-width: 1200px;
}

.bandContent.page {
  display: flex;
  display: -ms-flexbox;
  display: -webkit-box;
  display: -webkit-flex;

  justify-content: space-between;
  -webkit-justify-content: space-between;
  -ms-flex-pack: justify;

  flex-direction: row-reverse;
  -webkit-flex-direction: row-reverse;
}

.topics {
  width: 75%;
  overflow-x: auto;
  padding-bottom: 600px;
}

.topics .tutorialTitle {
  display: none;
  border-bottom: 3px dotted #f0f0f0;
}

.topics .section.level2 {
  display: none;
  margin-bottom: 40px;
}

.topics .section.level2.current {
  display: block;
}

.topicsContainer {
  width: 23%;
  min-width: 270px;
  margin-right: 2%;
  z-index: 100;
}

.topicsPositioner {
  position: fixed;
  left: 0px;
  width: 100%;
  height: 0px;
  background-color: pink;
}

.topicsList {
  float: left;
  position: relative;
  width: 23%;
  min-width: 270px;
  overflow: auto;
  height: auto;
  scroll-behavior: smooth;
  transform: translateZ(0); /* force repaint to work on older browser used in the IDE */
}

.topicsHeader {
  display: flex;
  display: -ms-flexbox;
  display: -webkit-box;
  display: -webkit-flex;

  justify-content: space-between;
  -webkit-justify-content: space-between;
  -ms-flex-pack: justify;
}

.topicsFooter {
  margin-top: 10px;
  padding-bottom: 20px;
}

.topicsFooter .resetButton {
  padding-left: 10px;
  font-size: .66em;
  cursor: pointer;
  opacity: .7;
}

.topicsFooter .resetButton:hover {
  opacity: 1;
}

.topicsList .topic {
  line-height: 40px;
  font-size: 15px;
  padding-left: 10px;
  cursor: pointer;

  background-repeat: no-repeat;
  background-size: 2px 80px;
  background-position: left 100%;
  background-image: url(images/topicProgress.png);
  border-bottom: 1px solid #f8f8f8;

  -webkit-transition-property: background-position;
  transition-property: background-position;
  -webkit-transition-duration: 0.25s;
  transition-duration: 0.25s;
}

.topicsList .topic:hover {
  background-color: #fcfcfc;
}

.topicsList .topic.current {
  background-color: #f8f8f8;
}

.section.level3 {
  margin-bottom: 40px;
}

.paneCloser {
  display: none;
  height: 30px;
  width: 30px;
  background: url(images/close.svg) no-repeat center center;
  background-size: 30px 30px;
  border-radius: 15px;
  position: relative;
  top: 8px;
}

.paneCloser:hover {
  background-color: rgba( 0, 0, 0, .05);
}

.section.level3.hide {
  display: none;
}

.section.level3.done h3 {
  padding-left: 25px;
  background-image: url(images/exerciseDone.svg);
  background-size: 20px 20px;
  background-position: left center;
  background-repeat: no-repeat;
}

.exerciseActions {
  margin: 20px 0;
}

.skip {
  display: none;
}

.showSkip .skip {
  display: inline-block;
}

.topicActions {
  margin-top: 20px;
}

.topicActions button {
  margin-right: 10px;
}

.section.level2.hideActions .topicActions {
  display: none;
}

#doc-metadata {
  margin-bottom: 10px;
  line-height: 1.6em;
}

#doc-metadata h3 {
  margin: 0;
  font-size: 1.2em;
  line-height: 2em;
}

#doc-metadata h4 {
  margin: 0;
  font-size: 1em;
  line-height: 1.6em;
}

#doc-metadata em {
  font-style: normal;
}

@media screen and (max-width: 767px) {
  .topics {
    width: 99%;
  }

  .topics .tutorialTitle {
    display: block;
    cursor: pointer;
  }

  .topicsContainer {
    width: 1%;
    min-width: 1px;
    margin-right: 0;
  }

  .topicsList {
    padding: 0px 10px 20px 1%;
    background-color: rgba(255, 255, 255, 0.98);

    box-shadow: 0 5px 25px 0px rgba(0, 0, 0, 0.15);
    -webkit-box-shadow: 0 5px 25px 0px rgba(0, 0, 0, 0.15);
  }

  .topicsList.hideFloating {
    display: none;
  }
  

  .paneCloser {
    display: inline-block;
  }
}

.topicsList .topic.current {
    background-color: #00407a;
    color: #ecf0f1;
    border: 0px;
}

/* override the width to be 100%, not 300px wide */
.shiny-input-container:not(.shiny-input-container-inline) {
  width: 100%;
}
.tutorial-exercise-support {
  width: 100%;
  max-width: 45em;
  display: none;
}

.slide .tutorial-exercise {
  width:100%;
  max-width: 45em;
  line-height: 1.4;
}

.tutorial-exercise {
  
  width:100%;
  max-width: 45em;
  position: relative;
}

.tutorial-exercise-input {
  margin-top: 15px;
}

.tutorial-panel-heading {
  background-color: #00407a;
  color: #ecf0f1;
  padding-top: 6px;
  padding-bottom: 6px;
  padding-left: 8px;
  padding-right: 8px;
  font-size: 13px;
  font-weight: 500;
  width: 100%;
}
.tutorial-quiz-title {
  font-weight: 300;
  font-size: 18px;
  padding-top: 6px;
  padding-bottom: 0px;
  padding-left: 0px;
  padding-right: 8px;
  width: 100%;
}

.tutorial-question {
  padding-top: 10px;
  padding-bottom: 15px;
}

.tutorial-exercise-input .btn-xs {
  border-radius: 3px;
  color: #ecf0f1;
  border-color: #00407a;
  background-color: #00407a;
  margin-right: 0;
  margin-top: -1px;
  font-size: 11px;
  margin-left: 12px;
  padding-right: 8px;
  font-weight: normal;
}

.btn-light {
  border-radius: 3px;
  color: #ecf0f1;
  background-color: #00407a;
  border-color: #ecf0f1;
}

.btn-light:hover
{
   color: #ecf0f1;
  background-color: #00407a;
  border-color: #ecf0f1; 
}

.btn-primary
{
  border-radius: 3px;
     color: #ecf0f1;
  background-color: #00407a;
  border-color: #333; 
}

.btn-default
{
  border-radius: 3px;
}

.btn-primary:hover
{
     color: #ecf0f1;
  background-color: #00407a;
  border-color: #00407a; 
}

.tutorial-exercise-input .btn-tutorial-solution {
  margin-left: 15px;
}

.tutorial-exercise-input .btn-tutorial-next-hint {
  margin-left: 15px;
  padding-right: 4px;
}

.tutorial-exercise-input .btn-xs i {
  color: #ecf0f1;
  border-color: #00407a;
  width: 10px;
  margin-right: 1px;
}

.tutorial-exercise-input .panel-body {
  padding: 0;
}


.tutorial-exercise-code-editor {
  width: 100%;
}


.tutorial-solution-popover {
  max-width: none;
  width: 100%;
}

.tutorial-solution-popover.top>.arrow {
  margin-left: 0;
}

.tutorial-hint {
  background-color: #00407a;

}

.ace-tm {
  font-family: monospace;
  font-size: 90%;
}


.tutorial-video-container {
  position: relative;
  margin-top: 15px;
  margin-bottom: 15px;
}

.tutorial-exercise-output>pre {
  max-height: 500px;
  overflow-y: auto;
}

.tutorial-video {
  position: absolute;
  top: 0;
  left: 0;
  width: 100%;
  height: 100%;
  border: solid 1px #cccccc;
}

/* Change colors for tabset tabset-pills */

.nav>li>a {
    position: relative;
    display: block;
    padding: 10px 15px;
    color: #00407a;
}
.nav-pills>li.active>a, .nav-pills>li.active>a:hover, .nav-pills>li.active>a:focus {
    color: #ffffff;
    background-color: #00407a;
}


section {
    float: left;
    margin: 10px;
    width: 60%;
    max-width: 45em;
}

p {
  max-width: 45em;
}

.r
{
  width: 100%;
  max-width: 45em;
}


.sidenote {
    float: right;
    clear: right;
    margin-right: -15%;
    width: 40%;
    margin-top: 0;
    margin-bottom: 1rem;
    font-size: 1.3rem;
    lineheight: 1.3;
    vertical-align: baseline;
    position: relative;
    color: ecf0f1;
    border: 1px solid black;
    padding: 5px 10px 5px;
}

.table {
  float: left;
  width: 100%;
  max-width:45em;
  margin: 10px 500px 10px 0px;
  padding: 5px 10px 5px;
}


.boxed {
    float: left;
    color: ecf0f1;
    border: 1px solid black;
    margin: 10px 500px 10px 0px;
    width: 100%;
    max-width: 45em;
    padding: 5px 10px 5px;</style>
<style type="text/css">.navbar-default {
  background-color: #00407a;
  border-color: #00407a;
}
.navbar-default .navbar-brand {
  color: #ecf0f1;
}
.navbar-default .navbar-brand:hover,
.navbar-default .navbar-brand:focus {
  color: #ecf0f1;
}
.navbar-default .navbar-text {
  color: #ecf0f1;
}
.navbar-default .navbar-nav > li > a {
  color: #ecf0f1;
}
.navbar-default .navbar-nav > li > a:hover,
.navbar-default .navbar-nav > li > a:focus {
  color: #ecf0f1;
}
.navbar-default .navbar-nav > .active > a,
.navbar-default .navbar-nav > .active > a:hover,
.navbar-default .navbar-nav > .active > a:focus {
  color: #ecf0f1;
  background-color: #00407a;
}
.navbar-default .navbar-nav > .open > a,
.navbar-default .navbar-nav > .open > a:hover,
.navbar-default .navbar-nav > .open > a:focus {
  color: #ecf0f1;
  background-color: #00407a;
}
.navbar-default .navbar-toggle {
  border-color: #00407a;
}
.navbar-default .navbar-toggle:hover,
.navbar-default .navbar-toggle:focus {
  background-color: #00407a;
}
.navbar-default .navbar-toggle .icon-bar {
  background-color: #ecf0f1;
}
.navbar-default .navbar-collapse,
.navbar-default .navbar-form {
  border-color: #ecf0f1;
}
.navbar-default .navbar-link {
  color: #ecf0f1;
}
.navbar-default .navbar-link:hover {
  color: #ecf0f1;
}

  .navbar-default .navbar-nav .open .dropdown-menu>li>a, .navbar-default .navbar-nav .open .dropdown-menu {
    background-color: #00407a;
    color:#ecf0f1;
  }

@media (max-width: 767px) {
  .navbar-default .navbar-nav .open .dropdown-menu > li > a {
    color: #ecf0f1;
  }
  .navbar-default .navbar-nav .open .dropdown-menu > li > a:hover,
  .navbar-default .navbar-nav .open .dropdown-menu > li > a:focus {
    color: #ecf0f1;
  }
  .navbar-default .navbar-nav .open .dropdown-menu > .active > a,
  .navbar-default .navbar-nav .open .dropdown-menu > .active > a:hover,
  .navbar-default .navbar-nav .open .dropdown-menu > .active > a:focus {
    color: #ecf0f1;
    background-color: #00407a;
  }
}

/* Change colors for tabset tabset-pills */

.nav>li>a {
    position: relative;
    display: block;
    padding: 10px 15px;
    color: #00407a;
}
.nav-pills>li.active>a, .nav-pills>li.active>a:hover, .nav-pills>li.active>a:focus {
    color: #ffffff;
    background-color: #00407a;
}


section {
    float: left;
    margin: 10px;
    width: 60%;
    max-width: 45em;
}

aside {
    float: right;
    margin: 10px;
    width: 15%;
}


#TOC {
    position: fixed;
    left: 10px;
    top: 60px;
    width: 200px;
    height: 100%;
    overflow: auto;
}

.boxed {
    float: left;
    color: ecf0f1;
    border: 1px solid black;
    margin: 10px 500px 10px 0px; 
    width: 100%;
    max-width: 45em;
    padding: 5px 10px 5px;
}


.sidenote {
    float: right;
    clear: right;
    margin-right: -15%;
    width: 40%;
    margin-top: 0;
    margin-bottom: 1rem;
    font-size: 1.3rem;
    lineheight: 1.3;
    vertical-align: baseline;
    position: relative;
    color: ecf0f1;
    border: 1px solid black;
    padding: 5px 10px 5px;
} 

    /* Style the buttons that are used to open and close the accordion panel */
    
.solution {
  border-radius: 3px;
  background-color: #00407a;
  color: #ecf0f1;
  cursor: pointer;
  padding: 10px;
  margin: 1px;
  width: 20%;
  text-align: center;
  border: none;
  outline: none;
  transition: 0.1s;
}

/* Add a background color to the button if it is clicked on (add the .active class with JS), and when you move the mouse over it (hover) */
.active, .solution:hover {
  color: #00407a;
  background-color: #ecf0f1;
}

/* Style the solution panel. Note: hidden by default */
.panel {
  padding: 0 10px;
  background-color: white;
  display: none;
  overflow: hidden;
}</style>
<div class="quote">
<p>Informed decision-making comes from a long tradition of guessing and then blaming others for inadequate results. — Scott Adams (Gilbert comic strip)</p>
</div>
<div id="section-bayesian-inference" class="section level1">
<h1>Bayesian Inference</h1>
<p>The distinguishing aspect of Bayesian statistics is the conceptualisation of the parameter as a probability distribution rather than a fixed quantity. We can use this to make inference directly rather than interpret the uncertainty in terms of the random sample via the sampling distribution because we express the uncertainty about the parameter as a probability distribution. We can use the posterior distribution to make direct probabilistic statements about the parameter in some ways (confidence or credible intervals). While this makes interpreting interval estimates more straightforward, it is more computationally demanding as it requires choosing an appropriate prior and evaluating the posterior distribution. In some cases, there are no analogous procedures to classical or frequentist approaches (i.e. hypothesis testing). Lastly, it is important to recognise and understand the influence of the parameter’s prior distribution on the results of analyses.</p>
<p>Thus we will examine three approaches to inference in the Bayesian paradigm: interval estimation, hypothesis testing, and decision theory. Each of these approaches has its analogue with classical techniques, and we will explore these contrasts and comparisons as part of exploring these concepts.</p>
<div id="section-credible-intervals" class="section level2">
<h2>Credible Intervals</h2>
<p>Interval estimation in the Bayesian context uses the posterior distribution to directly compute an interval-based on a specified probability</p>
<div class="boxed">
<p><strong>Credible Intervals</strong><br />
</p>
<p>Given the posterior distribution <span class="math inline">\(\pi(\theta|\mathbf{x})\)</span> the <span class="math inline">\(1-\alpha\)</span> <strong><em>credible set</em></strong> is <span class="math display">\[C(\theta)=\left\{\theta:Pr\left(\theta\in C(\theta)\right)=1-\alpha\right\}\]</span> For univariate cases this can be defined by the interval <span class="math inline">\([a,b]\)</span> <span class="math display">\[
\int_a^b\pi(\theta|\mathbf{y})d\theta=1-\alpha
\]</span> thus <span class="math display">\[
C(\theta)=\{\theta:\theta\in[a,b]\}.
\]</span> As in the case of confidence intervals, there are limited analytical tools available to minimise <span class="math inline">\(b-a\)</span> for a given <span class="math inline">\(1-\alpha\)</span>. In many instances, numerical techniques are necessary.</p>
<p>A set <span class="math inline">\(C^*(\theta)=[a,b]\)</span> that minimises <span class="math inline">\(b-a\)</span> for a given <span class="math inline">\(1-\alpha\)</span> <span class="math display">\[
C(\theta)=\min_{b-a}\int_{a}^b\pi(\theta|\mathbf{y})d\theta=1-\alpha
\]</span> is the <strong><em>highest posterior density</em></strong> credible interval.</p>
</div>
</div>
<div id="section-hypothesis-testing" class="section level2">
<h2>Hypothesis Testing</h2>
<p>For hypotheses of the form <span class="math display">\[
H_0:\theta\in \theta_0\quad\mbox{vs}\quad H_A:\theta\in \theta_0^c
\]</span> the posterior probabilities are equivalent to testing the hypotheses <span class="math display">\[
\begin{align}
Pr(\theta\in\theta_0|\mathbf{y})&amp;\equiv Pr(\mbox{H_0 is True}|\mathbf{y})\\
Pr(\theta\in\theta_0^c|\mathbf{y})&amp;\equiv Pr(\mbox{H_0 is False}|\mathbf{y}).
\end{align}
\]</span></p>
<p>But in the case of the point-null hypothesis <span class="math display">\[
H_0:\theta=\theta_0\quad\mbox{vs}\quad H_A:\theta\neq \theta_0
\]</span> <span class="math inline">\(Pr(\theta=\theta_0)=0\)</span> which prevents meaningful hypothesis testing. (The exception being when the parameter space is discrete, but this is a rare occurrence.)</p>
</div>
<div id="section-bayes-factors" class="section level2">
<h2>Bayes Factors</h2>
<p>Bayes factors are one alternative to classical hypothesis testing. If there are two competing models, <span class="math inline">\(M_{1}\)</span> and <span class="math inline">\(M_{2}\)</span>, we compare the marginal likelihood of the hypotheses they represent. The marginal likelihood is the probability of observing the data for a given model, i.e. <span class="math inline">\(P(\text{data}) = P(\boldsymbol{x})\)</span> (this is the normalising constant in Bayes rule above!). Since we have two different models we add the conditioning: <span class="math display">\[
Pr(\mathbf{x}\vert~M_{i}) = Pr(\boldsymbol{x}\vert M_{i}) = \int_{\theta_{i}} f(\boldsymbol{x}\vert\theta_{i}, M_{i})\pi(\theta_{i}\vert M_{i}) \text{ d}\theta_{i}
\]</span> but can also be written as <span class="math display">\[
Pr(\boldsymbol{x}\vert M_{i}) =\frac{Pr(M_{i} \vert \boldsymbol{x})Pr(\boldsymbol{x})}{Pr(M_{i})}
\]</span> using Bayes rule. The Bayes factor comparing these two models is <span class="math display">\[
BF_{12} = \frac{Pr(\boldsymbol{x}~\vert~M_{1})}{Pr(\boldsymbol{x}\vert M_{2})} = \frac{Pr(M_{1} \vert \boldsymbol{x}) Pr(M_{2})}{Pr(M_{2}\vert\boldsymbol{x}) Pr(M_{1})}
\]</span> the interpretation of <span class="math inline">\(BF_{12}\)</span> is given by tables, but there is more than one that can be used.</p>
</div>
<div id="section-bayesian-decision-theory" class="section level2">
<h2>Bayesian Decision Theory</h2>
</div>
<div id="section-theory-questions" class="section level2">
<h2>Theory questions</h2>
<div id="section-question-1" class="section level3">
<h3>Question 1</h3>
<div class="boxed">
<p>Assume <span class="math inline">\(x_{1}, x_{2}, \ldots, x_{n}\)</span> are exponentially distributed with rate <span class="math inline">\(\lambda\)</span>, show that the gamma prior <span class="math inline">\(\lambda \sim \text{Gamma}(\alpha,\beta)\)</span> is conjugate for the exponential distribution. What is the marginal likelihood of the data? Show that the posterior predictive distribution is a <a href="https://en.wikipedia.org/wiki/Lomax_distribution">Lomax distribution</a>.</p>
</div>
<button class="solution">
Solution
</button>
<div class="panel">
<hr />
<p><em>Solution</em>:</p>
<p>The likelihood is <span class="math display">\[
\pi(\boldsymbol{x}~\vert~\lambda) = \lambda^{n} \exp\left\{-\lambda \sum_{i=1}^{n}x_{i}\right\}
\]</span> whilst the prior is <span class="math display">\[
\pi(\lambda) = \frac{\beta^{\alpha}}{\Gamma(\alpha)} \lambda^{\alpha-1} \exp\left\{-\beta\lambda\right\}
\]</span> which generates a posterior <span class="math display">\[
\pi(\lambda~\vert~\boldsymbol{x}) \propto \lambda^{n} \exp\left\{-\lambda \sum_{i=1}^{n}x_{i}\right\} \lambda^{\alpha-1} \exp\left\{-\beta\lambda\right\} = \lambda^{\alpha+n - 1} \exp\left\{-\lambda \left(\beta + \sum_{i=1}^{n} x_{i} \right)\right\}.
\]</span> By inspection, we see that <span class="math inline">\((\lambda~\vert~\boldsymbol{x}) \sim \text{Gamma}(\alpha + n, \beta + s)\)</span> where <span class="math inline">\(s = \sum_{i=1}^{n}x_{i}\)</span>. The prior and the posterior are in the same family, therefore the Gamma prior is conjugate for the exponential distribution.</p>
<p>The marginal likelihood of the data is <span class="math display">\[
\pi(\boldsymbol{x}) = \frac{\beta^{\alpha}/\Gamma(\alpha)}{(\beta+s)^{\alpha+n}/\Gamma(\alpha+n)} = \frac{\beta^{\alpha}\Gamma(\alpha+n)}{(\beta+s)^{\alpha+n}\Gamma(\alpha)}.
\]</span></p>
<p>The posterior predictive is <span class="math display">\[
\begin{aligned}
\pi(\tilde{x}~\vert~\boldsymbol{x}) &amp;= \int_{0}^{\infty}\pi(\tilde{x}~\vert~ \lambda)\pi(\lambda~\vert~\boldsymbol{x}) \text{ d}\lambda \\
&amp;= \frac{(\beta+s)^{\alpha+n}}{\Gamma(\alpha+n)}\int_{0}^{\infty} \lambda\exp\{-\lambda\tilde{x}\} \lambda^{\alpha+n - 1} \exp\left\{-\lambda \left(\beta + \sum_{i=1}^{n} x_{i} \right)\right\} \text{ d}\lambda \\
&amp;= \frac{(\beta+s)^{\alpha+n}}{\Gamma(\alpha+n)}\int_{0}^{\infty}  \lambda^{\alpha+n} \exp\left\{-\lambda \left(\beta + \sum_{i=1}^{n} x_{i} + \tilde{x}\right)\right\} \text{ d}\lambda \\
&amp;= \frac{(\beta+s)^{\alpha+n}}{\Gamma(\alpha+n)} \frac{\Gamma(\alpha+n+1)}{(\beta+s +\tilde{x})^{\alpha+n+1}}\\
&amp;= \frac{(\alpha+n)(\beta+s)^{\alpha+n}}{(\beta+s +\tilde{x})^{\alpha+n+1}} \\
&amp;= \frac{(\alpha+n)(\beta+s)^{-1}}{(1 + \frac{\tilde{x}}{\beta+s})^{\alpha+n+1}} 
\end{aligned}
\]</span></p>
<hr />
</div>
</div>
<div id="section-question-2" class="section level3">
<h3>Question 2</h3>
<div class="boxed">
Consider a data from a Poisson process (i.e. realisations of a Poisson random variable <span class="math inline">\(X\)</span>) where <span class="math display">\[
Pr(X=x|\lambda)=\frac{\lambda^xe^{-\lambda}
}{x!}
\]</span> Assume a prior for <span class="math inline">\(\lambda\)</span> <span class="math display">\[
\pi(\lambda)=4\lambda e^{-2\lambda}.
\]</span> For the data <span class="math inline">\(\mathbf{x}=(x_1,x_2,\ldots,x_n)\)</span> i.e.<br />

<div class="tutorial-exercise" data-label="ex4" data-caption="Code" data-completion="1" data-diagnostics="1" data-startover="1" data-lines="0">
<pre class="text"><code>x&lt;-c(2, 1, 4, 3, 4, 2, 1, 2, 0, 0)
</code></pre>
<script type="application/json" data-opts-chunk="1">{"fig.width":6.5,"fig.height":4,"fig.retina":2,"fig.align":"center","fig.keep":"high","fig.show":"asis","out.width":624,"warning":true,"error":false,"message":true,"exercise.df_print":"paged","exercise.checker":"NULL"}</script>
</div>
<ol style="list-style-type: lower-alpha">
<li><p>Find the posterior distribution of <span class="math inline">\(\lambda|\mathbf{x}\)</span></p></li>
<li><p>Find the <span class="math inline">\(95\%\)</span> credible interval <span class="math inline">\(C\)</span> for <span class="math inline">\(\lambda\)</span> and <span class="math inline">\(\lambda|\mathbf{x}\)</span></p></li>
<li><p>Find <span class="math display">\[
Pr(\lambda)&gt;1\text{ and } Pr(\lambda&gt;1|\mathbf{x})
\]</span></p></li>
<li><p>Plot the prior and posterior of <span class="math inline">\(\lambda\)</span> together, comment? How did the data effect the posterior compared to the prior. Repeat this for <span class="math display">\[
\pi(\lambda)=e^{-\lambda}
\]</span></p></li>
</ol>
</div>
<button class="solution">
Solution
</button>
<div class="panel">
<p>Consider a data from a Poisson process (i.e. realisations of a Poisson random variable <span class="math inline">\(X\)</span>) where <span class="math display">\[
Pr(X=x|\lambda)=\frac{\lambda^xe^{-\lambda}
}{x!}
\]</span> Assume a prior for <span class="math inline">\(\lambda\)</span> <span class="math display">\[
\pi(\lambda)=4\lambda e^{-2\lambda}.
\]</span> For the data <span class="math inline">\(\mathbf{x}=(x_1,x_2,\ldots,x_n)\)</span> i.e.<br />
</p>
<pre class="r"><code>x&lt;-c(2, 1, 4, 3, 4, 2, 1, 2, 0, 0)
</code></pre>
<ol style="list-style-type: lower-alpha">
<li>Find the posterior distribution of <span class="math inline">\(\lambda|\mathbf{x}\)</span></li>
</ol>
<p>For <span class="math inline">\(\sum x_i=19\)</span> and <span class="math inline">\(n=10\)</span>The posterior distribution is <span class="math display">\[
\pi(\lambda|\mathbf{y})=\frac{12^{21}\lambda^{20}e^{-12\lambda}}{\Gamma(21)}
\]</span></p>
<ol start="2" style="list-style-type: lower-alpha">
<li>Find the <span class="math inline">\(95\%\)</span> credible interval <span class="math inline">\(C\)</span> for <span class="math inline">\(\lambda\)</span> and <span class="math inline">\(\lambda|\mathbf{x}\)</span></li>
</ol>
<pre class="r"><code>x&lt;-c(2, 1, 4, 3, 4, 2, 1, 2, 0, 0)

sumx&lt;-sum(x)
n&lt;-length(x)

alpha&lt;-2+sumx
beta&lt;-2+n

##  Just compute the equal tail credible interval

ll&lt;-qgamma(0.025,shape = alpha,rate = beta)%&gt;%round(.,2)
ul&lt;-qgamma(0.975,shape = alpha, rate = beta)%&gt;%round(.,2)</code></pre>
<p>The credible interval <span class="math inline">\(C\)</span> is (1.08,2.57)</p>
<ol start="3" style="list-style-type: lower-alpha">
<li>Find <span class="math display">\[
Pr(\lambda)&gt;1\text{ and } Pr(\lambda&gt;1|\mathbf{x})
\]</span></li>
</ol>
<pre class="r"><code>x&lt;-c(2, 1, 4, 3, 4, 2, 1, 2, 0, 0)

sumx&lt;-sum(x)
n&lt;-length(x)

alpha&lt;-2+sumx
beta&lt;-2+n

##  Just compute the equal tail credible interval

prior_prob&lt;-pgamma(1,shape = 2,rate = 2)%&gt;%round(.,2)
post_prob&lt;-pgamma(1,shape = alpha, rate = beta)%&gt;%round(.2)</code></pre>
<p><span class="math display">\[
\begin{align}
Pr(\lambda&lt;1)&amp;=0.59\\
Pr(\lambda&lt;1|\mathbf{x})&amp;=0
\end{align}
\]</span></p>
<ol start="4" style="list-style-type: lower-alpha">
<li>Plot the prior and posterior of <span class="math inline">\(\lambda\)</span> together, comment? How did the data effect the posterior compared to the prior.<br />
Repeat this for <span class="math display">\[
\pi(\lambda)=e^{-\lambda}
\]</span></li>
</ol>
<pre class="r"><code>x&lt;-c(2, 1, 4, 3, 4, 2, 1, 2, 0, 0)

sumx&lt;-sum(x)
n&lt;-length(x)

alpha&lt;-2+sumx
beta&lt;-2+n

x&lt;-seq(0,5,len=1000)
prior_2&lt;-dgamma(x,shape = 2, rate = 2)
prior_1&lt;-dgamma(x, shape = 1 , rate = 1)
posterior_2&lt;-dgamma(x,shape = alpha, rate = beta)
posterior_1&lt;-dgamma(x,shape = alpha -1, rate = beta-1)

df&lt;-tibble(X=rep(x,4),pi = c(prior_2,posterior_2,prior_1,posterior_1),names=c(rep(&quot;prior 2&quot;,1000),rep(&quot;posterior 2&quot;,1000),rep(&quot;prior 1&quot;,1000),rep(&quot;posterior 1&quot;,1000)))

ggplot(df,aes(x=X,y = pi,color=names))+
  geom_line()</code></pre>
<p><img src="mxb341-ws-08_files/figure-html/tq3-1.png" width="624" style="display: block; margin: auto;" /></p>
</div>
</div>
<div id="section-question-3" class="section level3">
<h3>Question 3</h3>
<div class="boxed">
<p>Consider the the absolute and quadratic loss functions, <span class="math inline">\(L_{1}(\beta, \hat{\beta}) = \vert\beta - \hat{\beta} \vert\)</span> and <span class="math inline">\(L_{2}(\beta, \hat{\beta}) = (\beta - \hat{\beta})^{2}\)</span> respectively.</p>
<p>We are going to perform a simulation to test certain estimators (posterior mean, median, and mode) for these loss functions in a Bayesian context. Suppose you have data <span class="math inline">\((y_{i} ~ \vert ~ \beta) \sim \text{Weibull}(\lambda, k = 0.4)\)</span> distribution and wish to use prior on <span class="math inline">\(\beta \sim \text{invGamma}(\alpha_{0} = 0.1,\beta_{0} = 2)\)</span>. Note, this is a conjugate prior, and the posterior distribution has parameters <span class="math inline">\(\alpha_{n} = \alpha_{0} + n\)</span> and <span class="math inline">\(\beta_{n} = \beta_{0} + \sum_{i=1}^{n} y_{i}^{k}\)</span>.</p>
<ol style="list-style-type: lower-alpha">
<li><p>Simulate some Weibull data with <span class="math inline">\(n = 20\)</span> and the parameters <span class="math inline">\(\lambda = 1\)</span> (scale), <span class="math inline">\(k = 0.4\)</span> (shape).</p></li>
<li><p>Write functions (or a single function) that calculates the posterior distribution’s: (i) <span class="math inline">\(\alpha_{n}\)</span> and <span class="math inline">\(\beta_{n}\)</span>, (ii) posterior mean, (iii) posterior mode, and (iv) posterior median<a href="#section-fn1" class="footnote-ref" id="section-fnref1"><sup>1</sup></a> given some data points <span class="math inline">\(\boldsymbol{y}\)</span>. Make sure you test your code with the data in part (a).</p></li>
<li><p>Using (b), write a function to simulate from the posterior distribution of <span class="math inline">\(\beta\)</span>.</p></li>
<li><p>We can estimate the Bayesian risk<a href="#section-fn2" class="footnote-ref" id="section-fnref2"><sup>2</sup></a> for a given estimate by simulation from the posterior distribution and calculating an average. Write a function to calculate the average of each type of loss above using samples from the posterior. It will use a given estimator, <span class="math inline">\(\hat{\beta}\)</span>, from the posterior, as well as samples from the posterior of <span class="math inline">\(\beta\)</span> to calculate the average.</p></li>
<li><p>Use the above functions to evaluate the estimators from part (b) using the estimate Bayes risk in part (c). Also try using <span class="math inline">\(n=3\)</span> and <span class="math inline">\(n=100\)</span>. Comment on the results.</p></li>
</ol>
</div>
<button class="solution">
Solution
</button>
<div class="panel">
<hr />
<p><em>Solution</em>:</p>
<ol style="list-style-type: lower-alpha">
<li></li>
</ol>
<pre class="r"><code>
  n &lt;- 20
  
  # parameters for weibull data
  weibull_scale &lt;- 1 # what we are trying to estimate
  weibull_shape &lt;- 0.4 # fixed (equal to k)

  # simulate some weibull data
  y &lt;- rweibull(n = n, shape = weibull_shape, scale = weibull_scale)
  
  </code></pre>
<ol start="2" style="list-style-type: lower-alpha">
<li></li>
</ol>
<pre class="r"><code>
  library(extraDistr)
#&gt; 
#&gt; Attaching package: &#39;extraDistr&#39;
#&gt; The following object is masked from &#39;package:purrr&#39;:
#&gt; 
#&gt;     rdunif

 posterior_beta_weibull_invgamma &lt;- function(y, alpha_0, beta_0, k){
  
  # prior: lambda ~ invgamma(a,b)
  # data model: x ~ weibull(lambda, k = weibull_shape)
  
  # parameters for invgamma posterior:
  alpha_n &lt;- alpha_0 + length(y)
  beta_n &lt;- beta_0 + sum(y^k)
  
  # bayes estimates of beta
  post_beta_mean &lt;- beta_n / (alpha_n - 1)
  post_beta_mode &lt;-  beta_n / (alpha_n + 1)
  post_beta_median &lt;- qinvgamma(p = 0.5, alpha = alpha_n, beta = beta_n)
  
  return(
    list(
      alpha_n = alpha_n,
      beta_n = beta_n,
      mean = post_beta_mean,
      mode = post_beta_mode,
      median = post_beta_median
    )
  )
  
 }

# test code
 
# parametes for prior
prior_invgamma_alpha &lt;- 0.1
prior_invgamma_beta &lt;- 2

posterior_results &lt;- 
  posterior_beta_weibull_invgamma(y = y, 
                                  alpha_0 = prior_invgamma_alpha, 
                                  beta_0 = prior_invgamma_beta, 
                                  k = weibull_shape) 

# access one element of list:
posterior_results$alpha_n
#&gt; [1] 20.1

# one way to veiw all...
posterior_results %&gt;% c(recursive = T)
#&gt;   alpha_n    beta_n      mean      mode    median 
#&gt; 20.100000 22.432065  1.174454  1.063131  1.134786</code></pre>
<ol start="3" style="list-style-type: lower-alpha">
<li></li>
</ol>
<pre class="r"><code>
  # calculating an average loss from the posterior is a 
  # Monte Carlo estimate of the Bayesian risk
 loss_absolute_avg &lt;- function(beta_hat, beta_posterior_samples){
   
   mean( abs(beta_hat - beta_posterior_samples) )
   
 }

 loss_quadratic_avg &lt;- function(beta_hat, beta_posterior_samples){
   
   mean( (beta_hat - beta_posterior_samples)^2 )
   
 }</code></pre>
<ol start="4" style="list-style-type: lower-alpha">
<li></li>
</ol>
<pre class="r"><code>
  # compare the estimators using the estimated 
  # Bayesian risk (average of loss functions)

  # one simulation in a study would look like this:
  
  # generate data
  y &lt;- rweibull(n = 3, shape = weibull_shape, scale = weibull_scale)

  # calc posterior values
  posterior_vals &lt;- 
    posterior_beta_weibull_invgamma(y = y,
                                    alpha_0 = prior_invgamma_alpha, 
                                    beta_0 = prior_invgamma_beta, 
                                    k = weibull_shape)

  beta_posterior_samples &lt;-
    rinvgamma(n = 10000, 
              alpha = posterior_vals$alpha_n,
              beta = posterior_vals$beta_n)

  # there are better ways of doing this using the purrr packge.
  bayes_risk &lt;- tibble(
    loss_function = c(&quot;abs&quot;, &quot;abs&quot;, &quot;abs&quot;, &quot;quad&quot;, &quot;quad&quot;, &quot;quad&quot;),
    estimator = c(&quot;mean&quot;, &quot;mode&quot;, &quot;median&quot;, &quot;mean&quot;, &quot;mode&quot;, &quot;median&quot;),
    value = c(loss_absolute_avg(posterior_vals$mean, beta_posterior_samples),
              loss_absolute_avg(posterior_vals$mode, beta_posterior_samples),
              loss_absolute_avg(posterior_vals$median, beta_posterior_samples),
              loss_quadratic_avg(posterior_vals$mean, beta_posterior_samples),
              loss_quadratic_avg(posterior_vals$mode, beta_posterior_samples),
              loss_quadratic_avg(posterior_vals$median, beta_posterior_samples)
              )
  )
  
  bayes_risk</code></pre>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["loss_function"],"name":[1],"type":["chr"],"align":["left"]},{"label":["estimator"],"name":[2],"type":["chr"],"align":["left"]},{"label":["value"],"name":[3],"type":["dbl"],"align":["right"]}],"data":[{"1":"abs","2":"mean","3":"0.8508440"},{"1":"abs","2":"mode","3":"0.8847112"},{"1":"abs","2":"median","3":"0.7824389"},{"1":"quad","2":"mean","3":"2.0342435"},{"1":"quad","2":"mode","3":"2.6652034"},{"1":"quad","2":"median","3":"2.1922401"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
<hr />
</div>
</div>
</div>
<div id="section-practical-questions" class="section level2">
<h2>Practical questions</h2>
<div id="section-question-4" class="section level3">
<h3>Question 4</h3>
<div class="boxed">
<p>In this question you will use Q2 and Q3 (theory) in order to choose between using a log-normal distribution with conjugate prior and an exponential distribution with Gamma prior using a Bayes factor.</p>
<div class="figure" style="text-align: center">
<img src="mxb341-ws-08_files/figure-html/coco-1.png" alt="Old girl Coco." width="288" />
<p class="caption">
Old girl Coco.
</p>
</div>
<p>Note the following about a Bayesian model for log-normal data with a Normal-Gamma prior: The model is defined by <span class="math display">\[
\begin{aligned}
(x_{i}~\vert~\mu,\tau) &amp;\sim \text{LogN}(\mu, \tau^{-1}) \quad \text{for } i \in \{1,2,\ldots,n\}\\
(\mu~\vert~\tau, \mu_{0}) &amp;\sim \text{Normal}(\mu_{0}, \tau^{-1}) \\
(\tau~\vert~\alpha,\beta) &amp;\sim \text{Gamma}(\alpha,\beta)
\end{aligned}
\]</span> and has posterior distribution with hierarchy <span class="math display">\[
\begin{aligned}
(\mu~\vert~\boldsymbol{x},\tau, \mu_{0}) &amp;\sim \text{Normal}(\mu^{\prime}, [(n+1)\tau]^{-1}) \\
(\tau~\vert~\boldsymbol{x},\alpha,\beta) &amp;\sim \text{Gamma}(\alpha^{\prime},\beta^{\prime})\\
\mu^{\prime} &amp;= \frac{\mu_{0} + ns_{1}}{n+1}, \quad s_{1} = n^{-1}\sum_{i=1}^{n}\log x_{i}  \\
\alpha^{\prime} &amp; = \alpha + n/2\\
\beta^{\prime} &amp; = \beta + \frac{n}{2} \left(s_{2} + \frac{(s_{1} - \mu_{0})^{2}}{n+1} \right), \quad s_{2} = n^{-1}\sum_{i=1}^{n}(\log x_{i} - s_{1})^{2}.
\end{aligned}
\]</span> The marginal likelihood of the data is <span class="math display">\[
p(\boldsymbol{x}~\vert~\mu_{0}, \alpha^{\prime}, \beta^{\prime}) = (2\pi)^{-n/2}\frac{\Gamma(\alpha^{\prime}) \beta^{\alpha}}{\Gamma(\alpha) \beta^{\prime \alpha^{\prime}}} (n+1)^{-1/2}
\]</span> and the posterior predictive distribution is a Generalised Student’s t-distribution on the log-scale: <span class="math display">\[
\begin{aligned}
\tilde{x} &amp; = \exp(\tilde{y})\\
(\tilde{y}~\vert~\boldsymbol{x}, \mu_{0},\alpha,\beta) &amp;\sim \text{t}_{2\alpha^{\prime}}\left(\mu^{\prime}, \frac{\beta^{\prime}(n+2)}{\alpha^{\prime}(n+1)}\right).
\end{aligned}
\]</span></p>
<p>Coco (Figure 1) is an old dog who no longer eats as much food. Her human, Daemo, would like to determine how much he should be feeding Coco each day. Daemo decides that he would like us to model the feeding statistically, and lucky for us he is a Bayesian! Let <span class="math inline">\(x_{i}\)</span> be the amount Coco eats on day <span class="math inline">\(i\)</span>, for <span class="math inline">\(i \in \{1,2,3,\ldots\}\)</span> in kilograms. He thinks that there are two models which could describe how much coco chooses to eat: <span class="math display">\[
\begin{aligned}
&amp;M_{1}: (x_{i}~\vert~\lambda) \sim \text{Exp}(\lambda), \quad \lambda \sim \text{Gamma}(4,1)\\
&amp;M_{2}: (x_{i}~\vert~\mu, \tau) \sim \text{logN}(\mu, \tau^{-1}),  \quad (\mu ~\vert~ \tau) \sim \text{N}(-1,\tau^{-1}), \quad \tau \sim \text{Gamma}(10,1)
\end{aligned}
\]</span></p>
<ol style="list-style-type: lower-alpha">
<li><p>Write a function that calculates the median of the posterior predictive distribution for the <span class="math inline">\(M_{1}\)</span> and <span class="math inline">\(M_{2}\)</span> respectively. It should take a vector of observations as input<a href="#section-fn3" class="footnote-ref" id="section-fnref3"><sup>3</sup></a>.</p></li>
<li><p>Write a function that calculates the marginal likelihood for the <span class="math inline">\(M_{1}\)</span> and <span class="math inline">\(M_{2}\)</span> respectively. Use this to write a function for the Bayes factor comparing the two models. These functions should also take a vector of data as input.</p></li>
<li><p>Suppose you speak to Daemo each evening and he reports to you how much food Coco has eaten. Over the course of a week, he reports coco eats <span class="math inline">\(x_{1} = 1, x_{2} = 0.8, x_{3} = 0.4, x_{4} = 0.35, x_{5} = 0.45, x_{6} = 0.3, x_{7} = 0.9\)</span> kilograms of food. Show Daemo how the</p>
<ol style="list-style-type: lower-roman">
<li>Median of the posterior predictive of each model, and</li>
<li>Bayes factor</li>
</ol></li>
</ol>
<p>get updated by Bayes rule after each evening report.</p>
<ol start="4" style="list-style-type: lower-alpha">
<li><p>Additionally, for each evening report</p>
<ol start="3" style="list-style-type: lower-roman">
<li>Use the median of the predictive distributions to estimate the next observation. Record the MSE as each new observation arrives.</li>
<li>After each update, make a recommendation to Daemo on whether there is enough evidence to recommend <span class="math inline">\(M_{1}\)</span> or <span class="math inline">\(M_{2}\)</span>.</li>
</ol></li>
</ol>
</div>
<button class="solution">
Solution
</button>
<div class="panel">
<hr />
<p><em>Solution</em>:</p>
<ol style="list-style-type: lower-alpha">
<li>From Q2, the posterior predictive distribution for <span class="math inline">\(M_{1}\)</span> is a Lomax distribution with shape <span class="math inline">\(\alpha + n\)</span> and scale <span class="math inline">\(\beta + s\)</span> where <span class="math inline">\(s = n \bar{x}\)</span> and <span class="math inline">\(n\)</span> is the number of observations.</li>
</ol>
<p>The posterior predictive distribution for <span class="math inline">\(M_{2}\)</span> is the student-t given in the details of the question.</p>
<pre class="r"><code>
library(extraDistr)
library(dplyr)

# M1: Exp + Gamma
m1_postr_predict_median &lt;- function(x, alpha, beta){
  
  alpha_p &lt;- alpha + length(x)
  beta_p &lt;- beta + sum(x)
  
  # median of lomax:
  plomax(0.5, lambda = 1/beta_p, kappa = alpha_p)
  
}

m2_postr_predict_median &lt;- function(x, mu0, alpha, beta){

  s1 &lt;- mean( log(x) )
  s2 &lt;- mean( (log(x) - s1)^2 )
  n &lt;- length(x)
  
  mu_prime &lt;- (n * s1 + mu0) / (n + 1)
  alpha_prime &lt;- alpha + (n/2)
  beta_prime &lt;- beta + 
    (n/2) * ( s2 + ((s1 - mu0)^2)/(n + 1) )
  
  # params of t dist
  t_mean &lt;- mu_prime
  t_scale &lt;- ( beta_prime * (n + 2) ) / (alpha_prime * (n + 1))
  t_df &lt;- 2 * alpha_prime
  
  # median of log t dist
  # P(L &lt; t) = 0.5, L ~ log student-t
  # P(log(T) &lt; t) = P(T &lt; exp(t)) = 0.5, T ~ student-t
  exp(
    qlst(p = 0.5, df = t_df, 
         mu = t_mean, sigma = t_scale)
    )

}

x &lt;- c(1, 0.8, 0.4, 0.35, 0.45, 0.3, 0.9)


m1_alpha &lt;- 4
m1_beta &lt;- 1
m1_postr_predict_median(x, m1_alpha, m1_beta)
#&gt; [1] 0.6357384

  
m2_mu0 &lt;- -1
m2_alpha &lt;- 10
m2_beta &lt;- 1
m2_postr_predict_median(x, m2_mu0, m2_alpha, m2_beta)
#&gt; [1] 0.5157479</code></pre>
<ol start="2" style="list-style-type: lower-alpha">
<li>Marginal evidence:</li>
</ol>
<pre class="r"><code>
m1_marginal_evidence &lt;- function(x, alpha, beta){
  
  n &lt;- length(x)
  alpha_p &lt;- alpha + n
  beta_p &lt;- beta + sum(x)
  
  log_evid &lt;- alpha * log(beta) + lgamma(alpha_p) -
    alpha_p * log(beta_p) - lgamma(alpha)

  exp(log_evid)
  
}


m2_marginal_evidence &lt;- function(x, mu0, alpha, beta){
 
  s1 &lt;- mean( log(x) )
  s2 &lt;- mean( (log(x) - s1)^2 )
  n &lt;- length(x)
  
  mu_prime &lt;- (n * s1 + mu0) / (n + 1)
  alpha_prime &lt;- alpha + (n/2)
  beta_prime &lt;- beta + 
  (n/2) * ( s2 + ((s1 - mu0)^2)/(n + 1) )
  
  log_evid &lt;- -(n/2) * log(2 * pi) + 
    alpha * log(beta) + lgamma(alpha_prime) -
    alpha_prime * log(beta_prime) - lgamma(alpha) -
    (1/2) * log(n + 1)
  
  exp(log_evid)
  
}

m1_evid &lt;- m1_marginal_evidence(x, m1_alpha, m1_beta)

m2_evid &lt;- m2_marginal_evidence(x, m2_mu0, m2_alpha, m2_beta)

# Bayes factor as a function:

m1_m2_bf &lt;- function(x, m1_alpha, m1_beta, m2_mu0, m2_alpha, m2_beta){
  
m1_marginal_evidence(x, m1_alpha, m1_beta) /
m2_marginal_evidence(x, m2_mu0, m2_alpha, m2_beta)
  
}

# substantial evidence that M1 is a better model (after full week).
m1_m2_bf(x, m1_alpha, m1_beta, m2_mu0, m2_alpha, m2_beta)
#&gt; [1] 7.848256</code></pre>
<ol start="3" style="list-style-type: lower-alpha">
<li>Daily report:</li>
</ol>
<pre class="r"><code>
x_each_day &lt;- lapply(1:length(x), function(i) x[1:i])

x_each_day[[1]]
#&gt; [1] 1
x_each_day[[3]]
#&gt; [1] 1.0 0.8 0.4

# rolling update of posterior predictive median:
# m1
m1_pp_med &lt;- sapply(x_each_day, m1_postr_predict_median, 
                    alpha = m1_alpha, beta = m1_beta)


# m2
m2_pp_med &lt;- sapply(x_each_day, m2_postr_predict_median, 
                    mu0 = m2_mu0, alpha = m2_alpha, beta = m2_beta)


# rolling update of bayes factor:
bayes_factor &lt;- sapply(x_each_day, m1_m2_bf, 
                       m1_alpha = m1_alpha, m1_beta = m1_beta, 
                       m2_mu0 = m2_mu0, m2_alpha = m2_alpha, m2_beta = m2_beta)

bayes_factor
#&gt; [1] 1.4773946 0.6568921 1.2800256 2.9186234 2.3957243 7.0199331 7.8482559</code></pre>
<ol start="4" style="list-style-type: lower-alpha">
<li></li>
</ol>
<pre class="r"><code>
# cumulative mean squared error (PP median versus actual observation)

# model 1
pp_mse1 &lt;- cummean( (m1_pp_med - x)^2)

# model 2
pp_mse2 &lt;- cummean( (m2_pp_med - x)^2)

pp_mse1 &lt; pp_mse2
#&gt; [1]  TRUE  TRUE  TRUE FALSE FALSE FALSE FALSE</code></pre>
<p>According to the Bayes factor in (c), after day 6, the evidence suggests a preference for model 1. However, the evidence is not particularly strong.</p>
<p>Model 2 has a lower mean squared error for the median of the posterior predictive as the observations are taken into consideration. There is the potential for it to be more useful for prediction but it’s hard to determine with so little data.</p>
<hr />
</div>
<script>
var acc = document.getElementsByClassName("solution");
var i   ;

for (i = 0; i < acc.length; i++) {
  acc[i].addEventListener("click", function() {
    /* Toggle between adding and removing the "active" class,
    to highlight the button that controls the panel */
    this.classList.toggle("active");

    /* Toggle between hiding and showing the active panel */
    var panel = this.nextElementSibling;
    if (panel.style.display === "block") {
      panel.style.display = "none";
    } else {
      panel.style.display = "block";
    }
  });
}
</script>

<script type="application/shiny-prerendered" data-context="server-start">
# if problems with knitting directory:
# set Knit Directory = Document Directory

# install libraries needed for worksheet
knitr::opts_chunk$set(
  fig.align = 'center',
  collapse = TRUE,
  comment = "#>"
)

library(learnr)
library(kableExtra)
library(pander)
library(shiny)
library(MXB341)


</script>
 
<script type="application/shiny-prerendered" data-context="server">
learnr:::register_http_handlers(session, metadata = NULL)
</script>
 
<script type="application/shiny-prerendered" data-context="server">
session$onSessionEnded(function() {
        learnr:::session_stop_event(session)
      })
</script>
 
<script type="application/shiny-prerendered" data-context="server">
`tutorial-exercise-ex4-result` <- learnr:::setup_exercise_handler(reactive(req(input$`tutorial-exercise-ex4-code-editor`)), session)
output$`tutorial-exercise-ex4-output` <- renderUI({
  `tutorial-exercise-ex4-result`()
})
</script>
 <!--html_preserve-->
<script type="application/shiny-prerendered" data-context="dependencies">
{"type":"list","attributes":{},"value":[{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name","version","src","meta","script","stylesheet","head","attachment","package","all_files","pkgVersion"]},"class":{"type":"character","attributes":{},"value":["html_dependency"]}},"value":[{"type":"character","attributes":{},"value":["header-attrs"]},{"type":"character","attributes":{},"value":["2.11"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["file"]}},"value":[{"type":"character","attributes":{},"value":["rmd/h/pandoc"]}]},{"type":"NULL"},{"type":"character","attributes":{},"value":["header-attrs.js"]},{"type":"NULL"},{"type":"NULL"},{"type":"NULL"},{"type":"character","attributes":{},"value":["rmarkdown"]},{"type":"logical","attributes":{},"value":[true]},{"type":"character","attributes":{},"value":["2.11"]}]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name","version","src","meta","script","stylesheet","head","attachment","package","all_files"]},"class":{"type":"character","attributes":{},"value":["html_dependency"]}},"value":[{"type":"character","attributes":{},"value":["jquery"]},{"type":"character","attributes":{},"value":["3.6.0"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["file"]}},"value":[{"type":"character","attributes":{},"value":["lib/3.6.0"]}]},{"type":"NULL"},{"type":"character","attributes":{},"value":["jquery-3.6.0.min.js"]},{"type":"NULL"},{"type":"NULL"},{"type":"NULL"},{"type":"character","attributes":{},"value":["jquerylib"]},{"type":"logical","attributes":{},"value":[true]}]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name","version","src","meta","script","stylesheet","head","attachment","package","all_files","pkgVersion"]},"class":{"type":"character","attributes":{},"value":["html_dependency"]}},"value":[{"type":"character","attributes":{},"value":["bootstrap"]},{"type":"character","attributes":{},"value":["3.3.5"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["file"]}},"value":[{"type":"character","attributes":{},"value":["rmd/h/bootstrap"]}]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["viewport"]}},"value":[{"type":"character","attributes":{},"value":["width=device-width, initial-scale=1"]}]},{"type":"character","attributes":{},"value":["js/bootstrap.min.js","shim/html5shiv.min.js","shim/respond.min.js"]},{"type":"character","attributes":{},"value":["css/yeti.min.css"]},{"type":"character","attributes":{},"value":["<style>h1 {font-size: 34px;}\n       h1.title {font-size: 38px;}\n       h2 {font-size: 30px;}\n       h3 {font-size: 24px;}\n       h4 {font-size: 18px;}\n       h5 {font-size: 16px;}\n       h6 {font-size: 12px;}\n       code {color: inherit; background-color: rgba(0, 0, 0, 0.04);}\n       pre:not([class]) { background-color: white }<\/style>"]},{"type":"NULL"},{"type":"character","attributes":{},"value":["rmarkdown"]},{"type":"logical","attributes":{},"value":[true]},{"type":"character","attributes":{},"value":["2.11"]}]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name","version","src","meta","script","stylesheet","head","attachment","package","all_files","pkgVersion"]},"class":{"type":"character","attributes":{},"value":["html_dependency"]}},"value":[{"type":"character","attributes":{},"value":["pagedtable"]},{"type":"character","attributes":{},"value":["1.1"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["file"]}},"value":[{"type":"character","attributes":{},"value":["rmd/h/pagedtable-1.1"]}]},{"type":"NULL"},{"type":"character","attributes":{},"value":["js/pagedtable.js"]},{"type":"character","attributes":{},"value":["css/pagedtable.css"]},{"type":"NULL"},{"type":"NULL"},{"type":"character","attributes":{},"value":["rmarkdown"]},{"type":"logical","attributes":{},"value":[true]},{"type":"character","attributes":{},"value":["2.11"]}]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name","version","src","meta","script","stylesheet","head","attachment","package","all_files","pkgVersion"]},"class":{"type":"character","attributes":{},"value":["html_dependency"]}},"value":[{"type":"character","attributes":{},"value":["highlightjs"]},{"type":"character","attributes":{},"value":["9.12.0"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["file"]}},"value":[{"type":"character","attributes":{},"value":["rmd/h/highlightjs"]}]},{"type":"NULL"},{"type":"character","attributes":{},"value":["highlight.js"]},{"type":"character","attributes":{},"value":["textmate.css"]},{"type":"NULL"},{"type":"NULL"},{"type":"character","attributes":{},"value":["rmarkdown"]},{"type":"logical","attributes":{},"value":[true]},{"type":"character","attributes":{},"value":["2.11"]}]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name","version","src","meta","script","stylesheet","head","attachment","package","all_files","pkgVersion"]},"class":{"type":"character","attributes":{},"value":["html_dependency"]}},"value":[{"type":"character","attributes":{},"value":["tutorial"]},{"type":"character","attributes":{},"value":["0.10.1"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["file"]}},"value":[{"type":"character","attributes":{},"value":["lib/tutorial"]}]},{"type":"NULL"},{"type":"character","attributes":{},"value":["tutorial.js"]},{"type":"character","attributes":{},"value":["tutorial.css"]},{"type":"NULL"},{"type":"NULL"},{"type":"character","attributes":{},"value":["learnr"]},{"type":"logical","attributes":{},"value":[true]},{"type":"character","attributes":{},"value":["0.10.1"]}]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name","version","src","meta","script","stylesheet","head","attachment","package","all_files","pkgVersion"]},"class":{"type":"character","attributes":{},"value":["html_dependency"]}},"value":[{"type":"character","attributes":{},"value":["tutorial-autocompletion"]},{"type":"character","attributes":{},"value":["0.10.1"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["file"]}},"value":[{"type":"character","attributes":{},"value":["lib/tutorial"]}]},{"type":"NULL"},{"type":"character","attributes":{},"value":["tutorial-autocompletion.js"]},{"type":"NULL"},{"type":"NULL"},{"type":"NULL"},{"type":"character","attributes":{},"value":["learnr"]},{"type":"logical","attributes":{},"value":[true]},{"type":"character","attributes":{},"value":["0.10.1"]}]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name","version","src","meta","script","stylesheet","head","attachment","package","all_files","pkgVersion"]},"class":{"type":"character","attributes":{},"value":["html_dependency"]}},"value":[{"type":"character","attributes":{},"value":["tutorial-diagnostics"]},{"type":"character","attributes":{},"value":["0.10.1"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["file"]}},"value":[{"type":"character","attributes":{},"value":["lib/tutorial"]}]},{"type":"NULL"},{"type":"character","attributes":{},"value":["tutorial-diagnostics.js"]},{"type":"NULL"},{"type":"NULL"},{"type":"NULL"},{"type":"character","attributes":{},"value":["learnr"]},{"type":"logical","attributes":{},"value":[true]},{"type":"character","attributes":{},"value":["0.10.1"]}]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name","version","src","meta","script","stylesheet","head","attachment","package","all_files","pkgVersion"]},"class":{"type":"character","attributes":{},"value":["html_dependency"]}},"value":[{"type":"character","attributes":{},"value":["tutorial-format"]},{"type":"character","attributes":{},"value":["0.10.1"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["file"]}},"value":[{"type":"character","attributes":{},"value":["rmarkdown/templates/tutorial/resources"]}]},{"type":"NULL"},{"type":"character","attributes":{},"value":["tutorial-format.js"]},{"type":"character","attributes":{},"value":["tutorial-format.css"]},{"type":"NULL"},{"type":"NULL"},{"type":"character","attributes":{},"value":["learnr"]},{"type":"logical","attributes":{},"value":[true]},{"type":"character","attributes":{},"value":["0.10.1"]}]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name","version","src","meta","script","stylesheet","head","attachment","package","all_files"]},"class":{"type":"character","attributes":{},"value":["html_dependency"]}},"value":[{"type":"character","attributes":{},"value":["jquery"]},{"type":"character","attributes":{},"value":["3.6.0"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["file"]}},"value":[{"type":"character","attributes":{},"value":["lib/3.6.0"]}]},{"type":"NULL"},{"type":"character","attributes":{},"value":["jquery-3.6.0.min.js"]},{"type":"NULL"},{"type":"NULL"},{"type":"NULL"},{"type":"character","attributes":{},"value":["jquerylib"]},{"type":"logical","attributes":{},"value":[true]}]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name","version","src","meta","script","stylesheet","head","attachment","package","all_files","pkgVersion"]},"class":{"type":"character","attributes":{},"value":["html_dependency"]}},"value":[{"type":"character","attributes":{},"value":["navigation"]},{"type":"character","attributes":{},"value":["1.1"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["file"]}},"value":[{"type":"character","attributes":{},"value":["rmd/h/navigation-1.1"]}]},{"type":"NULL"},{"type":"character","attributes":{},"value":["tabsets.js"]},{"type":"NULL"},{"type":"NULL"},{"type":"NULL"},{"type":"character","attributes":{},"value":["rmarkdown"]},{"type":"logical","attributes":{},"value":[true]},{"type":"character","attributes":{},"value":["2.11"]}]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name","version","src","meta","script","stylesheet","head","attachment","package","all_files","pkgVersion"]},"class":{"type":"character","attributes":{},"value":["html_dependency"]}},"value":[{"type":"character","attributes":{},"value":["highlightjs"]},{"type":"character","attributes":{},"value":["9.12.0"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["file"]}},"value":[{"type":"character","attributes":{},"value":["rmd/h/highlightjs"]}]},{"type":"NULL"},{"type":"character","attributes":{},"value":["highlight.js"]},{"type":"character","attributes":{},"value":["default.css"]},{"type":"NULL"},{"type":"NULL"},{"type":"character","attributes":{},"value":["rmarkdown"]},{"type":"logical","attributes":{},"value":[true]},{"type":"character","attributes":{},"value":["2.11"]}]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name","version","src","meta","script","stylesheet","head","attachment","package","all_files"]},"class":{"type":"character","attributes":{},"value":["html_dependency"]}},"value":[{"type":"character","attributes":{},"value":["jquery"]},{"type":"character","attributes":{},"value":["3.6.0"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["file"]}},"value":[{"type":"character","attributes":{},"value":["lib/3.6.0"]}]},{"type":"NULL"},{"type":"character","attributes":{},"value":["jquery-3.6.0.min.js"]},{"type":"NULL"},{"type":"NULL"},{"type":"NULL"},{"type":"character","attributes":{},"value":["jquerylib"]},{"type":"logical","attributes":{},"value":[true]}]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name","version","src","meta","script","stylesheet","head","attachment","package","all_files","pkgVersion"]},"class":{"type":"character","attributes":{},"value":["html_dependency"]}},"value":[{"type":"character","attributes":{},"value":["font-awesome"]},{"type":"character","attributes":{},"value":["5.1.0"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["file"]}},"value":[{"type":"character","attributes":{},"value":["rmd/h/fontawesome"]}]},{"type":"NULL"},{"type":"NULL"},{"type":"character","attributes":{},"value":["css/all.css","css/v4-shims.css"]},{"type":"NULL"},{"type":"NULL"},{"type":"character","attributes":{},"value":["rmarkdown"]},{"type":"logical","attributes":{},"value":[true]},{"type":"character","attributes":{},"value":["2.11"]}]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name","version","src","meta","script","stylesheet","head","attachment","package","all_files","pkgVersion"]},"class":{"type":"character","attributes":{},"value":["html_dependency"]}},"value":[{"type":"character","attributes":{},"value":["bootbox"]},{"type":"character","attributes":{},"value":["4.4.0"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["file"]}},"value":[{"type":"character","attributes":{},"value":["lib/bootbox"]}]},{"type":"NULL"},{"type":"character","attributes":{},"value":["bootbox.min.js"]},{"type":"NULL"},{"type":"NULL"},{"type":"NULL"},{"type":"character","attributes":{},"value":["learnr"]},{"type":"logical","attributes":{},"value":[true]},{"type":"character","attributes":{},"value":["0.10.1"]}]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name","version","src","meta","script","stylesheet","head","attachment","package","all_files","pkgVersion"]},"class":{"type":"character","attributes":{},"value":["html_dependency"]}},"value":[{"type":"character","attributes":{},"value":["idb-keyvalue"]},{"type":"character","attributes":{},"value":["3.2.0"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["file"]}},"value":[{"type":"character","attributes":{},"value":["lib/idb-keyval"]}]},{"type":"NULL"},{"type":"character","attributes":{},"value":["idb-keyval-iife-compat.min.js"]},{"type":"NULL"},{"type":"NULL"},{"type":"NULL"},{"type":"character","attributes":{},"value":["learnr"]},{"type":"logical","attributes":{},"value":[false]},{"type":"character","attributes":{},"value":["0.10.1"]}]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name","version","src","meta","script","stylesheet","head","attachment","package","all_files","pkgVersion"]},"class":{"type":"character","attributes":{},"value":["html_dependency"]}},"value":[{"type":"character","attributes":{},"value":["tutorial"]},{"type":"character","attributes":{},"value":["0.10.1"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["file"]}},"value":[{"type":"character","attributes":{},"value":["lib/tutorial"]}]},{"type":"NULL"},{"type":"character","attributes":{},"value":["tutorial.js"]},{"type":"character","attributes":{},"value":["tutorial.css"]},{"type":"NULL"},{"type":"NULL"},{"type":"character","attributes":{},"value":["learnr"]},{"type":"logical","attributes":{},"value":[true]},{"type":"character","attributes":{},"value":["0.10.1"]}]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name","version","src","meta","script","stylesheet","head","attachment","package","all_files","pkgVersion"]},"class":{"type":"character","attributes":{},"value":["html_dependency"]}},"value":[{"type":"character","attributes":{},"value":["tutorial-autocompletion"]},{"type":"character","attributes":{},"value":["0.10.1"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["file"]}},"value":[{"type":"character","attributes":{},"value":["lib/tutorial"]}]},{"type":"NULL"},{"type":"character","attributes":{},"value":["tutorial-autocompletion.js"]},{"type":"NULL"},{"type":"NULL"},{"type":"NULL"},{"type":"character","attributes":{},"value":["learnr"]},{"type":"logical","attributes":{},"value":[true]},{"type":"character","attributes":{},"value":["0.10.1"]}]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name","version","src","meta","script","stylesheet","head","attachment","package","all_files","pkgVersion"]},"class":{"type":"character","attributes":{},"value":["html_dependency"]}},"value":[{"type":"character","attributes":{},"value":["tutorial-diagnostics"]},{"type":"character","attributes":{},"value":["0.10.1"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["file"]}},"value":[{"type":"character","attributes":{},"value":["lib/tutorial"]}]},{"type":"NULL"},{"type":"character","attributes":{},"value":["tutorial-diagnostics.js"]},{"type":"NULL"},{"type":"NULL"},{"type":"NULL"},{"type":"character","attributes":{},"value":["learnr"]},{"type":"logical","attributes":{},"value":[true]},{"type":"character","attributes":{},"value":["0.10.1"]}]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name","version","src","meta","script","stylesheet","head","attachment","package","all_files","pkgVersion"]},"class":{"type":"character","attributes":{},"value":["html_dependency"]}},"value":[{"type":"character","attributes":{},"value":["ace"]},{"type":"character","attributes":{},"value":["1.2.6"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["file"]}},"value":[{"type":"character","attributes":{},"value":["lib/ace"]}]},{"type":"NULL"},{"type":"character","attributes":{},"value":["ace.js"]},{"type":"NULL"},{"type":"NULL"},{"type":"NULL"},{"type":"character","attributes":{},"value":["learnr"]},{"type":"logical","attributes":{},"value":[true]},{"type":"character","attributes":{},"value":["0.10.1"]}]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name","version","src","meta","script","stylesheet","head","attachment","package","all_files","pkgVersion"]},"class":{"type":"character","attributes":{},"value":["html_dependency"]}},"value":[{"type":"character","attributes":{},"value":["clipboardjs"]},{"type":"character","attributes":{},"value":["1.5.15"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["file"]}},"value":[{"type":"character","attributes":{},"value":["lib/clipboardjs"]}]},{"type":"NULL"},{"type":"character","attributes":{},"value":["clipboard.min.js"]},{"type":"NULL"},{"type":"NULL"},{"type":"NULL"},{"type":"character","attributes":{},"value":["learnr"]},{"type":"logical","attributes":{},"value":[true]},{"type":"character","attributes":{},"value":["0.10.1"]}]}]}
</script>
<!--/html_preserve-->
<!--html_preserve-->
<script type="application/shiny-prerendered" data-context="execution_dependencies">
{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["packages"]}},"value":[{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["packages","version"]},"class":{"type":"character","attributes":{},"value":["data.frame"]},"row.names":{"type":"integer","attributes":{},"value":[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,84,85,86,87,88,89,90,91,92,93,94,95,96,97,98,99,100,101]}},"value":[{"type":"character","attributes":{},"value":["assertthat","backports","base","broom","bslib","cellranger","cli","codetools","colorspace","compiler","crayon","datasets","DBI","dbplyr","digest","dplyr","ellipsis","evaluate","extraDistr","fansi","farver","fastmap","forcats","fs","generics","ggforce","ggplot2","ggtext","glue","graphics","grDevices","grid","gridExtra","gridtext","gtable","haven","highr","hms","htmltools","htmlwidgets","httpuv","httr","jquerylib","jsonlite","kableExtra","knitr","labeling","later","learnr","lifecycle","lubridate","magrittr","markdown","MASS","methods","mime","modelr","munsell","MXB341","pander","pillar","pkgconfig","png","polyclip","pracma","promises","purrr","R6","Rcpp","readr","readxl","reprex","rlang","rmarkdown","rprojroot","rstudioapi","rvest","sass","scales","shiny","stats","stringi","stringr","svglite","systemfonts","tibble","tidyr","tidyselect","tidyverse","tools","tweenr","utf8","utils","vctrs","viridisLite","webshot","withr","xfun","xml2","xtable","yaml"]},{"type":"character","attributes":{},"value":["0.2.1","1.2.1","4.0.5","0.7.8","0.2.5.1","1.1.0","2.5.0","0.2-18","2.0-2","4.0.5","1.4.1","4.0.5","1.1.1","2.1.1","0.6.27","1.0.7","0.3.2","0.14","1.9.1","0.5.0","2.1.0","1.1.0","0.5.1","1.5.0","0.1.0","0.3.3","3.3.5","0.1.1","1.5.0","4.0.5","4.0.5","4.0.5","2.3","0.1.4","0.3.0","2.4.1","0.9","1.1.0","0.5.1.1","1.5.3","1.6.1","1.4.2","0.1.4","1.7.2","1.3.4","1.33","0.4.2","1.2.0","0.10.1","1.0.0","1.7.10","2.0.1","1.1","7.3-54","4.0.5","0.12","0.1.8","0.5.0","1.0.0.2021","0.6.4","1.6.1","2.0.3","0.1-7","1.10-0","2.3.3","1.2.0.1","0.3.4","2.5.1","1.0.6","1.4.0","1.3.1","2.0.0","0.4.12","2.11","2.0.2","0.13","1.0.0","0.4.0","1.1.1","1.6.0","4.0.5","1.6.2","1.4.0","2.0.0","1.0.2","3.1.2","1.1.3","1.1.1","1.3.1","4.0.5","1.0.2","1.2.1","4.0.5","0.3.8","0.4.0","0.5.2","2.4.2","0.24","1.3.2","1.8-4","2.2.1"]}]}]}
</script>
<!--/html_preserve-->
</div>
</div>
</div>
<div class="footnotes">
<hr />
<ol>
<li id="section-fn1"><p>Hint: The <code>R</code> package <code>extraDistr</code> has functions for the inverse gamma distribution.<a href="#section-fnref1" class="footnote-back">↩︎</a></p></li>
<li id="section-fn2"><p>Recall: Bayesian risk is the expectation of the loss function w.r.t. the posterior<a href="#section-fnref2" class="footnote-back">↩︎</a></p></li>
<li id="section-fn3"><p>The R package <code>extraDistr</code> has packages to calculate lomax and location-scale student-t distributions.<a href="#section-fnref3" class="footnote-back">↩︎</a></p></li>
</ol>
</div>

</div> <!-- topics -->

<div class="topicsContainer">
<div class="topicsPositioner">
<div class="band">
<div class="bandContent topicsListContainer">

<!-- begin doc-metadata -->
<div id="doc-metadata">
<h2 class="title toc-ignore" style="display:none;">MXB341 Worksheet 08 - Bayesian Inference</h2>
</div>
<!-- end doc-metadata -->

</div> <!-- bandContent.topicsListContainer -->
</div> <!-- band -->
</div> <!-- topicsPositioner -->
</div> <!-- topicsContainer -->


</div> <!-- bandContent page -->
</div> <!-- pageContent band -->




<script>
// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.header').parent('thead').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});
</script>


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>


</body>

</html>
