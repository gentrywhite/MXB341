<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">

<head>

<meta charset="utf-8">
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="generator" content="pandoc" />



<meta name="progressive" content="false" />
<meta name="allow-skip" content="false" />

<title>MXB341 Worksheet 12 - MCMC Diganostics</title>


<!-- highlightjs -->
<style type="text/css">code{white-space: pre;}</style>
<style type="text/css">
  pre:not([class]) {
    background-color: white;
  }
</style>
<script type="text/javascript">
if (window.hljs) {
  hljs.configure({languages: []});
  hljs.initHighlightingOnLoad();
  if (document.readyState && document.readyState === "complete") {
    window.setTimeout(function() { hljs.initHighlighting(); }, 0);
  }
}
</script>

<!-- taken from https://github.com/rstudio/rmarkdown/blob/67b7f5fc779e4cfdfd0f021d3d7745b6b6e17149/inst/rmd/h/default.html#L296-L362 -->
<!-- tabsets -->

<style type="text/css">
.tabset-dropdown > .nav-tabs {
  display: inline-table;
  max-height: 500px;
  min-height: 44px;
  overflow-y: auto;
  background: white;
  border: 1px solid #ddd;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs > li.active:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li.active:before {
  content: "&#xe258;";
  border: none;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs > li.active {
  display: block;
}

.tabset-dropdown > .nav-tabs > li > a,
.tabset-dropdown > .nav-tabs > li > a:focus,
.tabset-dropdown > .nav-tabs > li > a:hover {
  border: none;
  display: inline-block;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li {
  display: block;
  float: none;
}

.tabset-dropdown > .nav-tabs > li {
  display: none;
}
</style>

<script>
$(document).ready(function () {
  window.buildTabsets("section-TOC");
});

$(document).ready(function () {
  $('.tabset-dropdown > .nav-tabs > li').click(function () {
    $(this).parent().toggleClass('nav-tabs-open')
  });
});
</script>
<!-- end tabsets -->


<link rel="stylesheet" href="css/QUT.css" type="text/css" />
<link rel="stylesheet" href="css/QUTtutorial.css" type="text/css" />

</head>

<body>



<div class="pageContent band">
<div class="bandContent page">

<div class="topics">

<p style="margin-bottom:0.6cm;"></p>

<a><img src = "images/logo.png" height="100px" 
          alt = "MXB341 Blackboard Page"><span style="font-size:40px;color:#00407a"> &thinsp; MXB341 Statistical Inference</span></a>

<p style="margin-bottom:1cm;"></p>
<style type="text/css">
.pageContent {
}

.band {
  padding-left: 5%;
  padding-right: 5%;
  position: relative;
}

.bandContent {
  margin: 0 auto;
  max-width: 1200px;
}

.bandContent.page {
  display: flex;
  display: -ms-flexbox;
  display: -webkit-box;
  display: -webkit-flex;

  justify-content: space-between;
  -webkit-justify-content: space-between;
  -ms-flex-pack: justify;

  flex-direction: row-reverse;
  -webkit-flex-direction: row-reverse;
}

.topics {
  width: 75%;
  overflow-x: auto;
  padding-bottom: 600px;
}

.topics .tutorialTitle {
  display: none;
  border-bottom: 3px dotted #f0f0f0;
}

.topics .section.level2 {
  display: none;
  margin-bottom: 40px;
}

.topics .section.level2.current {
  display: block;
}

.topicsContainer {
  width: 23%;
  min-width: 270px;
  margin-right: 2%;
  z-index: 100;
}

.topicsPositioner {
  position: fixed;
  left: 0px;
  width: 100%;
  height: 0px;
  background-color: pink;
}

.topicsList {
  float: left;
  position: relative;
  width: 23%;
  min-width: 270px;
  overflow: auto;
  height: auto;
  scroll-behavior: smooth;
  transform: translateZ(0); /* force repaint to work on older browser used in the IDE */
}

.topicsHeader {
  display: flex;
  display: -ms-flexbox;
  display: -webkit-box;
  display: -webkit-flex;

  justify-content: space-between;
  -webkit-justify-content: space-between;
  -ms-flex-pack: justify;
}

.topicsFooter {
  margin-top: 10px;
  padding-bottom: 20px;
}

.topicsFooter .resetButton {
  padding-left: 10px;
  font-size: .66em;
  cursor: pointer;
  opacity: .7;
}

.topicsFooter .resetButton:hover {
  opacity: 1;
}

.topicsList .topic {
  line-height: 40px;
  font-size: 15px;
  padding-left: 10px;
  cursor: pointer;

  background-repeat: no-repeat;
  background-size: 2px 80px;
  background-position: left 100%;
  background-image: url(images/topicProgress.png);
  border-bottom: 1px solid #f8f8f8;

  -webkit-transition-property: background-position;
  transition-property: background-position;
  -webkit-transition-duration: 0.25s;
  transition-duration: 0.25s;
}

.topicsList .topic:hover {
  background-color: #fcfcfc;
}

.topicsList .topic.current {
  background-color: #f8f8f8;
}

.section.level3 {
  margin-bottom: 40px;
}

.paneCloser {
  display: none;
  height: 30px;
  width: 30px;
  background: url(images/close.svg) no-repeat center center;
  background-size: 30px 30px;
  border-radius: 15px;
  position: relative;
  top: 8px;
}

.paneCloser:hover {
  background-color: rgba( 0, 0, 0, .05);
}

.section.level3.hide {
  display: none;
}

.section.level3.done h3 {
  padding-left: 25px;
  background-image: url(images/exerciseDone.svg);
  background-size: 20px 20px;
  background-position: left center;
  background-repeat: no-repeat;
}

.exerciseActions {
  margin: 20px 0;
}

.skip {
  display: none;
}

.showSkip .skip {
  display: inline-block;
}

.topicActions {
  margin-top: 20px;
}

.topicActions button {
  margin-right: 10px;
}

.section.level2.hideActions .topicActions {
  display: none;
}

#doc-metadata {
  margin-bottom: 10px;
  line-height: 1.6em;
}

#doc-metadata h3 {
  margin: 0;
  font-size: 1.2em;
  line-height: 2em;
}

#doc-metadata h4 {
  margin: 0;
  font-size: 1em;
  line-height: 1.6em;
}

#doc-metadata em {
  font-style: normal;
}

@media screen and (max-width: 767px) {
  .topics {
    width: 99%;
  }

  .topics .tutorialTitle {
    display: block;
    cursor: pointer;
  }

  .topicsContainer {
    width: 1%;
    min-width: 1px;
    margin-right: 0;
  }

  .topicsList {
    padding: 0px 10px 20px 1%;
    background-color: rgba(255, 255, 255, 0.98);

    box-shadow: 0 5px 25px 0px rgba(0, 0, 0, 0.15);
    -webkit-box-shadow: 0 5px 25px 0px rgba(0, 0, 0, 0.15);
  }

  .topicsList.hideFloating {
    display: none;
  }
  

  .paneCloser {
    display: inline-block;
  }
}

.topicsList .topic.current {
    background-color: #00407a;
    color: #ecf0f1;
    border: 0px;
}

/* override the width to be 100%, not 300px wide */
.shiny-input-container:not(.shiny-input-container-inline) {
  width: 100%;
}
.tutorial-exercise-support {
  width: 100%;
  max-width: 45em;
  display: none;
}

.slide .tutorial-exercise {
  width:100%;
  max-width: 45em;
  line-height: 1.4;
}

.tutorial-exercise {
  
  width:100%;
  max-width: 45em;
  position: relative;
}

.tutorial-exercise-input {
  margin-top: 15px;
}

.tutorial-panel-heading {
  background-color: #00407a;
  color: #ecf0f1;
  padding-top: 6px;
  padding-bottom: 6px;
  padding-left: 8px;
  padding-right: 8px;
  font-size: 13px;
  font-weight: 500;
  width: 100%;
}
.tutorial-quiz-title {
  font-weight: 300;
  font-size: 18px;
  padding-top: 6px;
  padding-bottom: 0px;
  padding-left: 0px;
  padding-right: 8px;
  width: 100%;
}

.tutorial-question {
  padding-top: 10px;
  padding-bottom: 15px;
}

.tutorial-exercise-input .btn-xs {
  border-radius: 3px;
  color: #ecf0f1;
  border-color: #00407a;
  background-color: #00407a;
  margin-right: 0;
  margin-top: -1px;
  font-size: 11px;
  margin-left: 12px;
  padding-right: 8px;
  font-weight: normal;
}

.btn-light {
  border-radius: 3px;
  color: #ecf0f1;
  background-color: #00407a;
  border-color: #ecf0f1;
}

.btn-light:hover
{
   color: #ecf0f1;
  background-color: #00407a;
  border-color: #ecf0f1; 
}

.btn-primary
{
  border-radius: 3px;
     color: #ecf0f1;
  background-color: #00407a;
  border-color: #333; 
}

.btn-default
{
  border-radius: 3px;
}

.btn-primary:hover
{
     color: #ecf0f1;
  background-color: #00407a;
  border-color: #00407a; 
}

.tutorial-exercise-input .btn-tutorial-solution {
  margin-left: 15px;
}

.tutorial-exercise-input .btn-tutorial-next-hint {
  margin-left: 15px;
  padding-right: 4px;
}

.tutorial-exercise-input .btn-xs i {
  color: #ecf0f1;
  border-color: #00407a;
  width: 10px;
  margin-right: 1px;
}

.tutorial-exercise-input .panel-body {
  padding: 0;
}


.tutorial-exercise-code-editor {
  width: 100%;
}


.tutorial-solution-popover {
  max-width: none;
  width: 100%;
}

.tutorial-solution-popover.top>.arrow {
  margin-left: 0;
}

.tutorial-hint {
  background-color: #00407a;

}

.ace-tm {
  font-family: monospace;
  font-size: 90%;
}


.tutorial-video-container {
  position: relative;
  margin-top: 15px;
  margin-bottom: 15px;
}

.tutorial-exercise-output>pre {
  max-height: 500px;
  overflow-y: auto;
}

.tutorial-video {
  position: absolute;
  top: 0;
  left: 0;
  width: 100%;
  height: 100%;
  border: solid 1px #cccccc;
}

/* Change colors for tabset tabset-pills */

.nav>li>a {
    position: relative;
    display: block;
    padding: 10px 15px;
    color: #00407a;
}
.nav-pills>li.active>a, .nav-pills>li.active>a:hover, .nav-pills>li.active>a:focus {
    color: #ffffff;
    background-color: #00407a;
}


section {
    float: left;
    margin: 10px;
    width: 60%;
    max-width: 45em;
}

p {
  max-width: 45em;
}

.r
{
  width: 100%;
  max-width: 45em;
}


.sidenote {
    float: right;
    clear: right;
    margin-right: -15%;
    width: 40%;
    margin-top: 0;
    margin-bottom: 1rem;
    font-size: 1.3rem;
    lineheight: 1.3;
    vertical-align: baseline;
    position: relative;
    color: ecf0f1;
    border: 1px solid black;
    padding: 5px 10px 5px;
}

.table {
  float: left;
  width: 100%;
  max-width:45em;
  margin: 10px 500px 10px 0px;
  padding: 5px 10px 5px;
}


.boxed {
    float: left;
    color: ecf0f1;
    border: 1px solid black;
    margin: 10px 500px 10px 0px;
    width: 100%;
    max-width: 45em;
    padding: 5px 10px 5px;</style>
<style type="text/css">.navbar-default {
  background-color: #00407a;
  border-color: #00407a;
}
.navbar-default .navbar-brand {
  color: #ecf0f1;
}
.navbar-default .navbar-brand:hover,
.navbar-default .navbar-brand:focus {
  color: #ecf0f1;
}
.navbar-default .navbar-text {
  color: #ecf0f1;
}
.navbar-default .navbar-nav > li > a {
  color: #ecf0f1;
}
.navbar-default .navbar-nav > li > a:hover,
.navbar-default .navbar-nav > li > a:focus {
  color: #ecf0f1;
}
.navbar-default .navbar-nav > .active > a,
.navbar-default .navbar-nav > .active > a:hover,
.navbar-default .navbar-nav > .active > a:focus {
  color: #ecf0f1;
  background-color: #00407a;
}
.navbar-default .navbar-nav > .open > a,
.navbar-default .navbar-nav > .open > a:hover,
.navbar-default .navbar-nav > .open > a:focus {
  color: #ecf0f1;
  background-color: #00407a;
}
.navbar-default .navbar-toggle {
  border-color: #00407a;
}
.navbar-default .navbar-toggle:hover,
.navbar-default .navbar-toggle:focus {
  background-color: #00407a;
}
.navbar-default .navbar-toggle .icon-bar {
  background-color: #ecf0f1;
}
.navbar-default .navbar-collapse,
.navbar-default .navbar-form {
  border-color: #ecf0f1;
}
.navbar-default .navbar-link {
  color: #ecf0f1;
}
.navbar-default .navbar-link:hover {
  color: #ecf0f1;
}

  .navbar-default .navbar-nav .open .dropdown-menu>li>a, .navbar-default .navbar-nav .open .dropdown-menu {
    background-color: #00407a;
    color:#ecf0f1;
  }

@media (max-width: 767px) {
  .navbar-default .navbar-nav .open .dropdown-menu > li > a {
    color: #ecf0f1;
  }
  .navbar-default .navbar-nav .open .dropdown-menu > li > a:hover,
  .navbar-default .navbar-nav .open .dropdown-menu > li > a:focus {
    color: #ecf0f1;
  }
  .navbar-default .navbar-nav .open .dropdown-menu > .active > a,
  .navbar-default .navbar-nav .open .dropdown-menu > .active > a:hover,
  .navbar-default .navbar-nav .open .dropdown-menu > .active > a:focus {
    color: #ecf0f1;
    background-color: #00407a;
  }
}

/* Change colors for tabset tabset-pills */

.nav>li>a {
    position: relative;
    display: block;
    padding: 10px 15px;
    color: #00407a;
}
.nav-pills>li.active>a, .nav-pills>li.active>a:hover, .nav-pills>li.active>a:focus {
    color: #ffffff;
    background-color: #00407a;
}


section {
    float: left;
    margin: 10px;
    width: 60%;
    max-width: 45em;
}

aside {
    float: right;
    margin: 10px;
    width: 15%;
}


#TOC {
    position: fixed;
    left: 10px;
    top: 60px;
    width: 200px;
    height: 100%;
    overflow: auto;
}

.boxed {
    float: left;
    color: ecf0f1;
    border: 1px solid black;
    margin: 10px 500px 10px 0px; 
    width: 100%;
    max-width: 45em;
    padding: 5px 10px 5px;
}


.sidenote {
    float: right;
    clear: right;
    margin-right: -15%;
    width: 40%;
    margin-top: 0;
    margin-bottom: 1rem;
    font-size: 1.3rem;
    lineheight: 1.3;
    vertical-align: baseline;
    position: relative;
    color: ecf0f1;
    border: 1px solid black;
    padding: 5px 10px 5px;
} 

    /* Style the buttons that are used to open and close the accordion panel */
    
.solution {
  border-radius: 3px;
  background-color: #00407a;
  color: #ecf0f1;
  cursor: pointer;
  padding: 10px;
  margin: 1px;
  width: 20%;
  text-align: center;
  border: none;
  outline: none;
  transition: 0.1s;
}

/* Add a background color to the button if it is clicked on (add the .active class with JS), and when you move the mouse over it (hover) */
.active, .solution:hover {
  color: #00407a;
  background-color: #ecf0f1;
}

/* Style the solution panel. Note: hidden by default */
.panel {
  padding: 0 10px;
  background-color: white;
  display: none;
  overflow: hidden;
}</style>
<div class="quote">
<p>“In theory, there is no difference between practice and theory. In practice there is.”</p>
<p>— Jan van de Snepscheut</p>
</div>
<div id="section-mcmc-diagnostics" class="section level2">
<h2>MCMC Diagnostics</h2>
<p>The Monte Carlo Markov Chain techniques that we have learned so far are based on the idea of drawing random samples from a posterior distribution in order to implement Monte Carlo integration in order to make inferences about our parameters. Because these techniques are based on random variables and the schemes we have discussed are based on drawing a <em>sequence</em> of samples, there are several opportunities for errors or inefficiencies to come up.</p>
<p>Notably we need to know:</p>
<ol style="list-style-type: decimal">
<li>Are the samples drawn from the stationary target density?</li>
<li>Are the samples a good approximation of a representative sample of independent draws from the the target density</li>
<li>Finally, how does my selected model compare to other possible models?</li>
</ol>
<p>We can use tools like cummulative means plots and the Brooks-Gelman-Rubin Potential Scale Reduction Factor to determine convergence, and tools like autocorrelation plots and effective sample size to measure the quality of our samples. Finally we will introduce the deviance information criteria (DIC) as a means of making comparisons between models.</p>
</div>
<div id="section-convergence-and-stationarity" class="section level2">
<h2>Convergence and Stationarity</h2>
<div class="boxed">
<p><strong>Cummulative Means</strong></p>
<p>For a target variable <span class="math inline">\(\theta\)</span> and an MCMC scheme generating a sequence of samples <span class="math inline">\(\theta^{(t)},\theta^{(t+1)},\ldots\)</span> from the target posterior <span class="math inline">\(\pi(\theta|\mathbf{y})\)</span> the most basic definition of stationarity is <span class="math display">\[
E\left(\theta^{(t)}|\mathbf{y}\right)=E\left(\theta^{(t+1)}|\mathbf{y}\right).
\]</span> From this definition it is reasonable to assume that monitoring the cumulative average of the samples generated by the MCMC scheme can be used as a tool for monitoring convergence, by plotting <span class="math inline">\(t\)</span> versus the cumulative mean, i.e. for <span class="math inline">\(t=1,\ldots,T\)</span> plot <span class="math inline">\(t\)</span> versus <span class="math display">\[
\bar{\theta}^{(t)}=\frac{1}{t}\sum_{s=1}^t\theta^{(s)}
\]</span> The resulting plot should reach an stable value for <span class="math inline">\(\bar{\theta}^{(t)}\)</span>, indicating the point where the MCMC scheme achieves stationarity.</p>
</div>
<div class="boxed">
<p><strong>The Brooks-Gelman-Rubin (BGR) potential scale reduction factor:</strong><br />
</p>
<p>For <span class="math inline">\(m\)</span> independent chains from diverse starting points, compute the variance estimate for each chain <span class="math inline">\(j\)</span>: <span class="math display">\[
s^2_j=\frac{1}{n-1}\sum_{i=1}^n(\theta_{ij}-\bar{\theta}_j)^2
\]</span> and let <span class="math display">\[
W=\frac{1}{m}\sum_{j=1}^ms^2_j
\]</span> be the average of the variance across the chains and define the overall mean as <span class="math display">\[
\bar{\bar{\theta}}=\frac{1}{m}\sum_{j=1}^m\bar{\theta}_j
\]</span> and <span class="math display">\[
B=\frac{n}{m-1}\sum_{j=1}^m(\bar{\theta}_j-\bar{\bar{\theta}})^2
\]</span> and <span class="math display">\[
\widehat{\operatorname{Var}(\theta)}=\left(1-\frac{1}{n}\right)W+\frac{1}{n}B
\]</span> Then the B-G-R potential scale reduction factor is <span class="math display">\[
\hat{R}=\sqrt{\frac{\widehat{\operatorname{Var}(\theta)}}{W}}.
\]</span> Ploting the chains together is a useful tool for graphcially assessing whether or not the chains have converged, but calculating <span class="math inline">\(\hat{R}\)</span> is a bit more precise means of assessing convergence. Ideally, <span class="math inline">\(\hat{R}\)</span> should be close to <span class="math inline">\(1\)</span>, and as a rule of thumb, a value of <span class="math inline">\(\hat{R}&lt;1.1\)</span> is considered sufficiently close to <span class="math inline">\(1\)</span>.</p>
</div>
</div>
<div id="section-question-1" class="section level2">
<h2>Question 1</h2>
<div class="boxed">
<p>Given</p>
<p><span class="math inline">\(y=\)</span> 4, 0, 2, 0, 0, 4, 2, 0, 0, 0, 4, 0, 0, 3, 0, 0, 0, 0, 0, 1 and<br />
<span class="math inline">\(x =\)</span> 0.59, -0.67, 0.7, -0.86, -0.99, 0.92, 0.57, -0.04, -0.57, -0.74, 0.98, -0.81, -0.79, 0.51, 0.09, 0.13, 0.28, 0.14, 0.37, 0.6</p>
<ol style="list-style-type: lower-alpha">
<li>Fit a model assuming that <span class="math inline">\(y_i\sim Pois(\lambda_i)\)</span>, <span class="math inline">\(\log(\lambda_i)=\beta_0+\beta_1x_i\)</span>.</li>
<li>Plot the cummulative mean of the parameters and calculate the BGR for three chains.</li>
</ol>
</div>
<button class="solution">
Solution
</button>
<div class="panel">
<p>Given</p>
<p><span class="math inline">\(y=\)</span> 4, 0, 2, 0, 0, 4, 2, 0, 0, 0, 4, 0, 0, 3, 0, 0, 0, 0, 0, 1 and<br />
<span class="math inline">\(x =\)</span> 0.59, -0.67, 0.7, -0.86, -0.99, 0.92, 0.57, -0.04, -0.57, -0.74, 0.98, -0.81, -0.79, 0.51, 0.09, 0.13, 0.28, 0.14, 0.37, 0.6</p>
<ol style="list-style-type: lower-alpha">
<li>Fit a model assuming that <span class="math inline">\(y_i\sim Pois(\lambda_i)\)</span>, <span class="math inline">\(\log(\lambda_i)=\beta_0+\beta_1x_i\)</span>.</li>
<li>Plot the cummulative mean of the parameters and calculate the BGR for three chains.</li>
</ol>
<p><strong>Solution:</strong><br />
Write a function to evaluate the model:</p>
<pre class="r"><code>library(mvtnorm)

x&lt;-c(0.59, -0.67, 0.7, -0.86, -0.99, 0.92, 0.57, -0.04, -0.57, -0.74, 0.98, -0.81, -0.79, 0.51, 0.09, 0.13, 0.28, 0.14, 0.37, 0.6)
y&lt;-c(4, 0, 2, 0, 0, 4, 2, 0, 0, 0, 4, 0, 0, 3, 0, 0, 0, 0, 0, 1 )

X&lt;-cbind(1,x)

##  log-likelihood function

log_like&lt;-function(beta)
{
  nu&lt;-X%*%beta%&gt;%exp()
  dpois(y,nu,log=TRUE)%&gt;%sum()
}

bayes_pois&lt;-function(x,y,init,n)
{
  
  ##  Initialise beta

  beta&lt;-matrix(NA,ncol = 2, nrow = n)
  beta[1,]&lt;-init

  ##  Set up MCMC

  beta_cov&lt;-crossprod(X)%&gt;%solve()
  beta_sd&lt;-1

  n.accept&lt;-0

  set.seed(14061972)

  for(i in 2:n)
  {
    bc&lt;-rmvnorm(1,beta[i-1,],beta_sd*beta_cov)%&gt;%t()
    alpha&lt;-(log_like(bc)-log_like(beta[i-1,]))%&gt;%exp()
    u&lt;-runif(1)    
    if(u&lt;alpha)
    {
      beta[i,]&lt;-bc
      n.accept%&lt;&gt;%+(1)
    }
    else
    {
      beta[i,]&lt;-beta[i-1,]
    }
    accept.rate&lt;-n.accept/i
  
    ##  Automatically tune the candidate distribution
  
    if(accept.rate&lt;0.2|accept.rate&gt;0.4)
    {
      beta_sd%&lt;&gt;%multiply_by(0.7+accept.rate)
    }
  }
  return(list(beta = beta, accept.rate = accept.rate))
}

##  Now run multiple chains

N&lt;-10000

beta0&lt;-numeric()
beta1&lt;-numeric()

init&lt;-rbind(c(-1,-1),c(0,0),c(1,1))

for(j in 1:3)
{
  out&lt;-bayes_pois(x,y,init[j,],N)
  beta0%&lt;&gt;%c(out$beta[,1])
  beta1%&lt;&gt;%c(out$beta[,2])
}

##  Plot the results

iteration&lt;-rep(1:N,3)
chain&lt;-c(rep(&quot;1&quot;,N),rep(&quot;2&quot;,N),rep(&quot;3&quot;,N))
name&lt;-c(rep(&quot;beta[0]&quot;,3*N),rep(&quot;beta[1]&quot;,3*N))

df&lt;-tibble(beta=c(beta0,beta1),iteration = rep(iteration,2),chain = rep(chain,2),name)

##  Cummulative Mean Plots

ggplot(filter(df,chain==&quot;1&quot;)%&gt;%group_by(name)%&gt;%summarise(beta=cummean(beta), iteration = iteration), aes(x = iteration, y = beta, group = name))+
  geom_line()+
  facet_wrap(~name, labeller = label_parsed)
#&gt; `summarise()` has grouped output by &#39;name&#39;. You can override using the `.groups` argument.</code></pre>
<p><img src="mxb341-ws-12_files/figure-html/unnamed-chunk-7-1.png" width="624" style="display: block; margin: auto;" /></p>
<pre class="r"><code>
##  BGR Plot

ggplot(df,aes(x=iteration, y = beta, group = chain, color = chain ))+
  geom_line()+
  facet_wrap(~name, labeller = label_parsed)</code></pre>
<p><img src="mxb341-ws-12_files/figure-html/unnamed-chunk-7-2.png" width="624" style="display: block; margin: auto;" /></p>
<pre class="r"><code>


##  Compute BGR for beta_0

S&lt;-aggregate(beta~chain,FUN = var, data = filter(df, name ==&quot;beta[0]&quot;))
W&lt;-mean(S$beta)
B&lt;-var(S$beta)
VAR&lt;-(1-1/N)*W+B
Rhat0&lt;-(VAR/W)%&gt;%sqrt()

##  Compute BGR for beta_1

S&lt;-aggregate(beta~chain,FUN = var, data = filter(df, name ==&quot;beta[1]&quot;))
W&lt;-mean(S$beta)
B&lt;-var(S$beta)
VAR&lt;-(1-1/N)*W+B
Rhat1&lt;-(VAR/W)%&gt;%sqrt()</code></pre>
<p>The Brooks-Gelman-Rubin potential scale reduction factor for <span class="math inline">\(\beta_0\)</span> is <span class="math inline">\(\hat{R}=\)</span> 1.000201.<br />
The Brooks-Gelman-Rubin potential scale reduction factor for <span class="math inline">\(\beta_1\)</span> is <span class="math inline">\(\hat{R}=\)</span> 1.000192.</p>
</div>
</div>
<div id="section-assessing-samples" class="section level2">
<h2>Assessing Samples</h2>
<div class="boxed">
<p><strong>Autocorrelation:</strong></p>
<p>The autocorrelation between two samples in an MCMC chain is the Pearson correlation coefficient between the two samples. It is a function of the lag or number of samples between them. <span class="math display">\[
\operatorname{Cor}\left(\theta^{(t)},\theta^{(t+k)}\right)=\rho^k.
\]</span> The autocorrelation can be easily calculated and plotted to gain some understanding of the degree of correlation present in the sequence.</p>
<p>This can be done automatically in <code>R</code> using the function <code>acf()</code>.</p>
<pre class="r"><code>acf(theta)</code></pre>
</div>
<div class="boxed">
<p><strong>Effective Sample Size (ESS):</strong></p>
<p>Given the autocorrelation function <span class="math inline">\(\rho^k\)</span> can be used to compute the <em>effective</em> sample size that is less than the actual sample size <span class="math inline">\(n\)</span>. <span class="math display">\[
ESS=\frac{n}{1+2\sum_{k=1}^\infty\rho_k}.
\]</span> The effective sample size is a more quantitative measure of the efficiency of MCMC schemes and can be a useful measure of the reliability of estimates based on the samples.</p>
<p>This can be computed automatically in <code>R</code> using the function <code>ess()</code> in the <code>mcmcse</code> package.</p>
<pre class="r"><code>library(mcmcse)

ess(theta)
</code></pre>
</div>
</div>
<div id="section-question-2" class="section level2">
<h2>Question 2</h2>
<div class="boxed">
<p>Given</p>
<p><span class="math inline">\(y=\)</span> 4, 0, 2, 0, 0, 4, 2, 0, 0, 0, 4, 0, 0, 3, 0, 0, 0, 0, 0, 1 and<br />
<span class="math inline">\(x =\)</span> 0.59, -0.67, 0.7, -0.86, -0.99, 0.92, 0.57, -0.04, -0.57, -0.74, 0.98, -0.81, -0.79, 0.51, 0.09, 0.13, 0.28, 0.14, 0.37, 0.6</p>
<ol style="list-style-type: lower-alpha">
<li>Fit a model assuming that <span class="math inline">\(y_i\sim Pois(\lambda_i)\)</span>, <span class="math inline">\(\log(\lambda_i)=\beta_0+\beta_1x_i\)</span>.</li>
<li>Plot the ACF and compute the effective sample size for each parameter.</li>
</ol>
</div>
<button class="solution">
Solution
</button>
<div class="panel">
<p>Given</p>
<p><span class="math inline">\(y=\)</span> 4, 0, 2, 0, 0, 4, 2, 0, 0, 0, 4, 0, 0, 3, 0, 0, 0, 0, 0, 1 and<br />
<span class="math inline">\(x =\)</span> 0.59, -0.67, 0.7, -0.86, -0.99, 0.92, 0.57, -0.04, -0.57, -0.74, 0.98, -0.81, -0.79, 0.51, 0.09, 0.13, 0.28, 0.14, 0.37, 0.6</p>
<ol style="list-style-type: lower-alpha">
<li>Fit a model assuming that <span class="math inline">\(y_i\sim Pois(\lambda_i)\)</span>, <span class="math inline">\(\log(\lambda_i)=\beta_0+\beta_1x_i\)</span>.</li>
<li>Plot the ACF and compute the effective sample size for each parameter.</li>
</ol>
<p><strong>Solution:</strong><br />
Write a function to evaluate the model:</p>
<pre class="r"><code>library(mvtnorm)

x&lt;-c(0.59, -0.67, 0.7, -0.86, -0.99, 0.92, 0.57, -0.04, -0.57, -0.74, 0.98, -0.81, -0.79, 0.51, 0.09, 0.13, 0.28, 0.14, 0.37, 0.6)
y&lt;-c(4, 0, 2, 0, 0, 4, 2, 0, 0, 0, 4, 0, 0, 3, 0, 0, 0, 0, 0, 1 )

X&lt;-cbind(1,x)

##  log-likelihood function

log_like&lt;-function(beta)
{
  nu&lt;-X%*%beta%&gt;%exp()
  dpois(y,nu,log=TRUE)%&gt;%sum()
}

bayes_pois&lt;-function(x,y,init,n)
{
  
  ##  Initialise beta

  beta&lt;-matrix(NA,ncol = 2, nrow = n)
  beta[1,]&lt;-init

  ##  Set up MCMC

  beta_cov&lt;-crossprod(X)%&gt;%solve()
  beta_sd&lt;-1

  n.accept&lt;-0

  set.seed(14061972)

  for(i in 2:n)
  {
    bc&lt;-rmvnorm(1,beta[i-1,],beta_sd*beta_cov)%&gt;%t()
    alpha&lt;-(log_like(bc)-log_like(beta[i-1,]))%&gt;%exp()
    u&lt;-runif(1)    
    if(u&lt;alpha)
    {
      beta[i,]&lt;-bc
      n.accept%&lt;&gt;%+(1)
    }
    else
    {
      beta[i,]&lt;-beta[i-1,]
    }
    accept.rate&lt;-n.accept/i
  
    ##  Automatically tune the candidate distribution
  
    if(accept.rate&lt;0.2|accept.rate&gt;0.4)
    {
      beta_sd%&lt;&gt;%multiply_by(0.7+accept.rate)
    }
  }
  return(list(beta = beta, accept.rate = accept.rate))
}

##  Then we can generate samples for computing ACF and ESS

N&lt;-10000

out&lt;-bayes_pois(x,y,c(0,0),N)

library(mcmcse)
#&gt; mcmcse: Monte Carlo Standard Errors for MCMC
#&gt; Version 1.4-1 created on 2020-01-29.
#&gt; copyright (c) 2012, James M. Flegal, University of California, Riverside
#&gt;                     John Hughes, University of Colorado, Denver
#&gt;                     Dootika Vats, University of Warwick
#&gt;                     Ning Dai, University of Minnesota
#&gt;  For citation information, type citation(&quot;mcmcse&quot;).
#&gt;  Type help(&quot;mcmcse-package&quot;) to get started.

acf_beta_0&lt;-acf(out$beta[,1],plot = FALSE)$acf
acf_beta_1&lt;-acf(out$beta[,2],plot = FALSE)$acf
lag&lt;-rep(1:length(acf_beta_0),2)
name&lt;-c(rep(&quot;beta[0]&quot;,length(acf_beta_0)),rep(&quot;beta[1]&quot;,length(acf_beta_1)))

df&lt;-tibble(acf = c(acf_beta_0,acf_beta_1),lag,name)

ggplot(df,aes(x = lag, y = acf))+
  geom_bar(stat = &quot;identity&quot;,alpha = 0.5)+
  geom_hline(yintercept = 0.05,linetype = &quot;dashed&quot;)+
  facet_wrap(~name,labeller = label_parsed)</code></pre>
<p><img src="mxb341-ws-12_files/figure-html/unnamed-chunk-10-1.png" width="624" style="display: block; margin: auto;" /></p>
<pre class="r"><code>
ESS&lt;-mcmcse::ess(out$beta)</code></pre>
<p>The effective sample sizes for <span class="math inline">\(\beta_0\)</span> and <span class="math inline">\(\beta_1\)</span> are 210.42, 261.25.</p>
</div>
</div>
<div id="section-the-deviance-information-criteria" class="section level2">
<h2>The Deviance Information Criteria</h2>
<div class="boxed">
<p><strong>Deviance Information Criteria</strong></p>
<p>The deviance information criterion (DIC) is an information criterion much like the AIC or BIC. It is a measure that takes into account both the model complexity and goodness of fit in order for use as a model selection criteria. Defining the deviance as <span class="math display">\[
D(\theta) = -2\log(f(\mathbf{y}|\theta))
\]</span> or <span class="math inline">\(-2\)</span> times the log-likelihood, it is a measure of goodness of fit. Model complexity can also be measured in terms of deviance by one of two measures: <span class="math display">\[
p_D= \overline{D(\theta)}-D(\bar{\theta})
\]</span> where <span class="math inline">\(\overline{D(\theta)}\)</span> is the expected value of the deviance, and <span class="math inline">\(D(\bar{\theta})\)</span> is the deviance evaluated at the expected value of <span class="math inline">\(\theta\)</span>. Alternatively, the measure <span class="math display">\[
p_V = \frac{1}{2}\operatorname{Var}(D(\theta))
\]</span> can be used a a complexity measure, and the resulting DIC is <span class="math display">\[
DIC = p_D+\overline{D(\theta)},\mbox{ or }D(\bar{\theta})+2p_D
\]</span> with the second form highlighting the relationship with AIC. Note that <span class="math inline">\(p_V\)</span> can be substituted for <span class="math inline">\(p_D\)</span> if desired, but this is not standard in most implementations.</p>
<p>One can implement the DIC in any Monte Carlo scheme desired, <span class="math inline">\(\overline{D(\theta)}\)</span> and <span class="math inline">\(p_V\)</span> can be easily calculated by computing the log-likelihood at each iteration and computing the mean and variance. Calculating the <span class="math inline">\(p_D\)</span> consists of calculating the log-likelihood using the posterior mean of <span class="math inline">\(\theta\)</span>.</p>
</div>
</div>
<div id="section-question-3" class="section level2">
<h2>Question 3</h2>
<div class="boxed">
<p>Given</p>
<p><span class="math inline">\(y=\)</span> 4, 0, 2, 0, 0, 4, 2, 0, 0, 0, 4, 0, 0, 3, 0, 0, 0, 0, 0, 1 and<br />
<span class="math inline">\(x =\)</span> 0.59, -0.67, 0.7, -0.86, -0.99, 0.92, 0.57, -0.04, -0.57, -0.74, 0.98, -0.81, -0.79, 0.51, 0.09, 0.13, 0.28, 0.14, 0.37, 0.6</p>
<ol style="list-style-type: lower-alpha">
<li>Fit a model assuming that <span class="math inline">\(y_i\sim Pois(\lambda_i)\)</span>, <span class="math inline">\(\log(\lambda_i)=\beta_0+\beta_1x_i\)</span></li>
<li>Compute the <span class="math inline">\(p_D\)</span>, <span class="math inline">\(p_V\)</span>, <span class="math inline">\(\bar{D}\)</span> and <span class="math inline">\(DIC\)</span> and compare the results.</li>
</ol>
</div>
<button class="solution">
Solution
</button>
<div class="panel">
<p>Given</p>
<p><span class="math inline">\(y=\)</span> 4, 0, 2, 0, 0, 4, 2, 0, 0, 0, 4, 0, 0, 3, 0, 0, 0, 0, 0, 1 and<br />
<span class="math inline">\(x =\)</span> 0.59, -0.67, 0.7, -0.86, -0.99, 0.92, 0.57, -0.04, -0.57, -0.74, 0.98, -0.81, -0.79, 0.51, 0.09, 0.13, 0.28, 0.14, 0.37, 0.6</p>
<ol style="list-style-type: lower-alpha">
<li>Fit a model assuming that <span class="math inline">\(y_i\sim Pois(\lambda_i)\)</span>, <span class="math inline">\(\log(\lambda_i)=\beta_0+\beta_1x_i\)</span></li>
<li>Compute the <span class="math inline">\(p_D\)</span>, <span class="math inline">\(p_V\)</span>, <span class="math inline">\(\bar{D}\)</span> and <span class="math inline">\(DIC\)</span> and compare the results.</li>
</ol>
<p><strong>Solution:</strong><br />
</p>
<pre class="r"><code>library(mvtnorm)

x&lt;-c(0.59, -0.67, 0.7, -0.86, -0.99, 0.92, 0.57, -0.04, -0.57, -0.74, 0.98, -0.81, -0.79, 0.51, 0.09, 0.13, 0.28, 0.14, 0.37, 0.6)
y&lt;-c(4, 0, 2, 0, 0, 4, 2, 0, 0, 0, 4, 0, 0, 3, 0, 0, 0, 0, 0, 1 )

X&lt;-cbind(1,x)

##  log-likelihood function

log_like&lt;-function(beta)
{
  nu&lt;-X%*%beta%&gt;%exp()
  dpois(y,nu,log=TRUE)%&gt;%sum()
}

bayes_pois&lt;-function(x,y,init,n)
{
  
  ##  Initialise beta

  beta&lt;-matrix(NA,ncol = 2, nrow = n)
  beta[1,]&lt;-init
  dev&lt;-numeric(length = n)
  dev[1]&lt;--2*log_like(init)

  ##  Set up MCMC

  beta_cov&lt;-crossprod(X)%&gt;%solve()
  beta_sd&lt;-1

  n.accept&lt;-0

  set.seed(14061972)

  for(i in 2:n)
  {
    bc&lt;-rmvnorm(1,beta[i-1,],beta_sd*beta_cov)%&gt;%t()
    alpha&lt;-(log_like(bc)-log_like(beta[i-1,]))%&gt;%exp()
    u&lt;-runif(1)    
    if(u&lt;alpha)
    {
      beta[i,]&lt;-bc
      n.accept%&lt;&gt;%+(1)
    }
    else
    {
      beta[i,]&lt;-beta[i-1,]
    }
    accept.rate&lt;-n.accept/i
  
    ##  Automatically tune the candidate distribution
  
    if(accept.rate&lt;0.2|accept.rate&gt;0.4)
    {
      beta_sd%&lt;&gt;%multiply_by(0.7+accept.rate)
    }
    dev[i]&lt;--2*log_like(beta[i,])
  }
  pD&lt;-mean(dev)+2*log_like(colMeans(beta))
  pV&lt;-var(dev)/2
  Dbar&lt;-mean(dev)
  DICd&lt;-Dbar+pD
  DICv&lt;-Dbar+pV
  
  return(list(beta = beta, accept.rate = accept.rate, DICd = DICd, DICv = DICv, pD = pD, pV = pV, Dbar = Dbar))
}

out&lt;-bayes_pois(x,y,c(0,0),10000)
DICd&lt;-out$DICd%&gt;%round(2)
DICv&lt;-out$DICv%&gt;%round(2)
pD&lt;-out$pD%&gt;%round(2)
pV&lt;-out$pV%&gt;%round(2)
Dbar&lt;-out$Dbar%&gt;%round(2)</code></pre>
<div class="table-narrow">
<table>
<thead>
<tr class="header">
<th><span class="math inline">\(\bar{D}\)</span></th>
<th><span class="math inline">\(p_D\)</span></th>
<th><span class="math inline">\(p_v\)</span></th>
<th><span class="math inline">\(DIC_{p_D}\)</span></th>
<th><span class="math inline">\(DIC_{p_V}\)</span></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>32.89</td>
<td>1.92</td>
<td>2.38</td>
<td>34.81</td>
<td>35.27</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<div id="section-practical-question" class="section level2">
<h2>Practical question</h2>
<div id="section-question-4" class="section level3">
<h3>Question 4</h3>
<div class="boxed">
<p>Given</p>
<p><span class="math inline">\(y=\)</span> 4, 0, 1, 0, 0, 1, 0, 0, 0, 0, 5, 0, 0, 1, 1, 2, 0, 0, 0, 3 and<br />
<span class="math inline">\(x =\)</span> 0.59, -0.67, 0.7, -0.86, -0.99, 0.92, 0.57, -0.04, -0.57, -0.74, 0.98, -0.81, -0.79, 0.51, 0.09, 0.13, 0.28, 0.14, 0.37, 0.6</p>
<ol style="list-style-type: lower-alpha">
<li>Fit a model assuming that <span class="math inline">\(y_i\sim Pois(\lambda_i)\)</span>, <span class="math inline">\(\log(\lambda_i)=\beta_0+\beta_1x_i\)</span></li>
<li>Fit a model assuming that <span class="math inline">\(y_i\sim NegBinom(\mu_i,\eta)\)</span>, <span class="math inline">\(\log(\mu_i)=\beta_0+\beta_1x_i\)</span> For each model:</li>
<li>Plot the trace of the parameters;</li>
<li>plot the cummulative mean of the parameters and calculate the BGR for three chains;</li>
<li>plot the ACF and compute the effective sample size for each parameter; and</li>
<li>compute the <span class="math inline">\(p_D\)</span>, <span class="math inline">\(p_V\)</span>, <span class="math inline">\(\bar{D}\)</span> and <span class="math inline">\(DIC\)</span> for each of these models and compare the results.</li>
</ol>
</div>
<button class="solution">
Solution
</button>
<div class="panel">
<p>Given</p>
<p><span class="math inline">\(y=\)</span> 6, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 1, 0, 1, 0, 1, 1, 0 and<br />
<span class="math inline">\(x =\)</span> 0.59, -0.67, 0.7, -0.86, -0.99, 0.92, 0.57, -0.04, -0.57, -0.74, 0.98, -0.81, -0.79, 0.51, 0.09, 0.13, 0.28, 0.14, 0.37, 0.6</p>
<ol style="list-style-type: lower-alpha">
<li>Fit a model assuming that <span class="math inline">\(y_i\sim Pois(\lambda_i)\)</span>, <span class="math inline">\(\log(\lambda_i)=\beta_0+\beta_1x_i\)</span></li>
<li>Fit a model assuming that <span class="math inline">\(y_i\sim NegBinom(\mu_i,\eta)\)</span>, <span class="math inline">\(\log(\mu_i)=\beta_0+\beta_1x_i\)</span> For each model:</li>
<li>Plot the trace of the parameters;</li>
<li>plot the cummulative mean of the parameters and calculate the BGR for three chains;</li>
<li>plot the ACF and compute the effective sample size for each parameter; and</li>
<li>compute the <span class="math inline">\(p_D\)</span>, <span class="math inline">\(p_V\)</span>, <span class="math inline">\(\bar{D}\)</span> and <span class="math inline">\(DIC\)</span> for each of these models and compare the results.</li>
</ol>
<pre class="r"><code>library(mvtnorm)

x&lt;-c(0.59, -0.67, 0.7, -0.86, -0.99, 0.92, 0.57, -0.04, -0.57, -0.74, 0.98, -0.81, -0.79, 0.51, 0.09, 0.13, 0.28, 0.14, 0.37, 0.6)
y&lt;-c(6, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 1, 0, 1, 0, 1, 1, 0)

##  log-likelihood function

bayes_pois&lt;-function(x,y,init,n)
{

set.seed(14061972)
  
  X&lt;-cbind(1,x)
  
  log_like&lt;-function(beta)
    {
      nu&lt;-X%*%beta%&gt;%exp()
      dpois(y,nu,log=TRUE)%&gt;%sum()
    }
  
  ##  Initialise beta

  beta&lt;-matrix(NA,ncol = 2, nrow = n)
  beta[1,]&lt;-init
  dev&lt;-numeric(length = n)
  dev[1]&lt;--2*log_like(init)

  ##  Set up MCMC

  beta_cov&lt;-crossprod(X)%&gt;%solve()
  beta_sd&lt;-1

  n.accept&lt;-0

  set.seed(14061972)

  for(i in 2:n)
  {
    bc&lt;-rmvnorm(1,beta[i-1,],beta_sd*beta_cov)%&gt;%t()
    alpha&lt;-(log_like(bc)-log_like(beta[i-1,]))%&gt;%exp()
    u&lt;-runif(1)    
    if(u&lt;alpha)
    {
      beta[i,]&lt;-bc
      n.accept%&lt;&gt;%+(1)
    }
    else
    {
      beta[i,]&lt;-beta[i-1,]
    }
    accept.rate&lt;-n.accept/i
  
    ##  Automatically tune the candidate distribution
  
    if(accept.rate&lt;0.2|accept.rate&gt;0.4)
    {
      beta_sd%&lt;&gt;%multiply_by(0.7+accept.rate)
    }
    dev[i]&lt;--2*log_like(beta[i,])
  }
  pD&lt;-mean(dev)+2*log_like(colMeans(beta))
  pV&lt;-var(dev)/2
  Dbar&lt;-mean(dev)
  DICd&lt;-Dbar+pD
  DICv&lt;-Dbar+pV
  return(list(beta = beta, accept.rate = accept.rate, Dbar = Dbar, DICd = DICd, DICv = DICv, pD = pD, pV= pV))
}

#####################

bayes_nbinom&lt;-function(x,y,init,n)
{
  
set.seed(14061972)
  
  log_like&lt;-function(BETA,ETA)
  {
    mu&lt;-X%*%BETA%&gt;%exp()
    dnbinom(y,size = ETA,mu = mu, log = TRUE)%&gt;%sum()
  }
  
  X&lt;-cbind(1,x)
  
  beta&lt;-matrix(NA,ncol = 2, nrow = n)
  eta&lt;-numeric(length = n)
  dev&lt;-numeric(length = n)
  dev[1]&lt;-dnbinom(y,size = init[3],mu = exp(X%*%init[1:2]),log = TRUE)%&gt;%sum()%&gt;%multiply_by(-2)
  beta[1,]&lt;-init[1:2]
  eta[1]&lt;-init[3]
  beta_cov&lt;-crossprod(X)%&gt;%solve()
  beta_sd&lt;-1.5
  eta_var&lt;-1
  beta.accept&lt;-0
  eta.accept&lt;-0
  
    for(i in 2:n)
  {
    bc&lt;-rmvnorm(1,mean = beta[i-1,],sigma = beta_sd*beta_cov)%&gt;%t()
    alpha&lt;-(log_like(bc,eta[i-1])-log_like(beta[i-1,],eta[i-1]))%&gt;%exp()
    u&lt;-runif(1)
    if(alpha&gt;u)
    {
      beta[i,]&lt;-bc
      beta.accept%&lt;&gt;%+(1)
    }
    else
    {
      beta[i,]&lt;-beta[i-1,]
    }
    beta.accept.rate&lt;-beta.accept/i
        
    ##  Automatically tune the candidate distribution
  
    if(beta.accept.rate&lt;0.2|beta.accept.rate&gt;0.4)
    {
      beta_sd%&lt;&gt;%multiply_by(0.7+beta.accept.rate)
    }
    

  ##  update eta

    ac&lt;-eta[i-1]^2/eta_var
    bc&lt;-eta[i-1]/eta_var

    ec&lt;-rgamma(1,ac,bc)

    a&lt;-ec^2/eta_var
    b&lt;-ec/eta_var

    alpha&lt;-(log_like(beta[i,],ec)-log_like(beta[i,],eta[i-1])+dgamma(eta[i-1],a,b,log=TRUE)-dgamma(ec,ac,bc,log = TRUE)-ec+eta[i-1])%&gt;%exp()

  u&lt;-runif(1)
  if(alpha&gt;u)
  {
    eta[i]&lt;-ec
    eta.accept%&lt;&gt;%+(1)
  }
  else
  {
    eta[i]&lt;-eta[i-1]
  }

    ##  Automatically tune the candidate distribution
  
    eta.accept.rate&lt;-eta.accept/i
  
    if(eta.accept.rate&lt;0.2|eta.accept.rate&gt;0.4)
    {
      eta_var%&lt;&gt;%multiply_by(0.7+eta.accept.rate)
    }
  
    dev[i]&lt;--2*log_like(beta[i,],eta[i])
    }
  pD&lt;-mean(dev)+2*log_like(colMeans(beta),mean(eta))
  pV&lt;-var(dev)/2
  Dbar&lt;-mean(dev)
  DICd&lt;-Dbar+pD
  DICv&lt;-Dbar+pV
  return(list(beta = beta, eta = eta, beta.accept = beta.accept, beta.accept.rate = beta.accept.rate,eta.accept = eta.accept, eta.accept.rate = eta.accept.rate, Dbar = Dbar, DICd = DICd, DICv = DICv, pD = pD, pV= pV))
}

##  Now run multiple chains

N&lt;-10000

pois_out&lt;-list()
nb_out&lt;-list()

init&lt;-rbind(c(-1.7,3.1,1),c(0,1,2),c(0,0,3))


for(j in 1:3)
{
  pois_out[[j]]&lt;-bayes_pois(x,y,init[j,1:2],N)
  nb_out[[j]]&lt;-bayes_nbinom(x,y,init[j,],N)
}

p.Dbar&lt;-pois_out[[1]]$Dbar
p.pD&lt;-pois_out[[1]]$pD
p.pV&lt;-pois_out[[1]]$pV
p.DICd&lt;-pois_out[[1]]$DICd
p.DICv&lt;-pois_out[[1]]$DICv

nb.Dbar&lt;-nb_out[[1]]$Dbar
nb.pD&lt;-nb_out[[1]]$pD
nb.pV&lt;-nb_out[[1]]$pV
nb.DICd&lt;-nb_out[[1]]$DICd
nb.DICv&lt;-nb_out[[1]]$DICv

##  Plot the results for Poisson

iteration&lt;-rep(1:N,3)
chain&lt;-c(rep(&quot;1&quot;,N),rep(&quot;2&quot;,N),rep(&quot;3&quot;,N))
name&lt;-c(rep(&quot;beta[0]&quot;,3*N),rep(&quot;beta[1]&quot;,3*N))

beta.pois&lt;-rbind(pois_out[[1]]$beta,pois_out[[2]]$beta,pois_out[[3]]$beta)

df.pois&lt;-tibble(beta=c(beta.pois),iteration = rep(iteration,2),chain = rep(chain,2),name)

##  Trace Plots

ggplot(filter(df.pois,chain ==&quot;1&quot;), aes(x= iteration, y = beta))+
  geom_line()+
  facet_wrap(~name, labeller = label_parsed)</code></pre>
<p><img src="mxb341-ws-12_files/figure-html/unnamed-chunk-16-1.png" width="624" style="display: block; margin: auto;" /></p>
<pre class="r"><code>
##  Cummulative Mean Plots

ggplot(filter(df.pois,chain==&quot;1&quot;)%&gt;%group_by(name)%&gt;%summarise(beta=cummean(beta), iteration = iteration), aes(x = iteration, y = beta, group = name))+
  geom_line()+
  facet_wrap(~name, labeller = label_parsed)</code></pre>
<p><img src="mxb341-ws-12_files/figure-html/unnamed-chunk-16-2.png" width="624" style="display: block; margin: auto;" /></p>
<pre class="r"><code>
##  BGR Plot

ggplot(df.pois,aes(x=iteration, y = beta, group = chain, color = chain ))+
  geom_line()+
  facet_wrap(~name, labeller = label_parsed)</code></pre>
<p><img src="mxb341-ws-12_files/figure-html/unnamed-chunk-16-3.png" width="624" style="display: block; margin: auto;" /></p>
<pre class="r"><code>
##  Plot the results for Negative Binomial

iteration&lt;-rep(1:N,3)
chain&lt;-c(rep(&quot;1&quot;,N),rep(&quot;2&quot;,N),rep(&quot;3&quot;,N))
name&lt;-c(rep(&quot;beta[0]&quot;,3*N),rep(&quot;beta[1]&quot;,3*N),rep(&quot;eta&quot;,3*N))

beta.nb&lt;-rbind(nb_out[[1]]$beta,nb_out[[2]]$beta,nb_out[[3]]$beta)
eta&lt;-c(nb_out[[1]]$eta,nb_out[[2]]$eta, nb_out[[3]]$eta)

df.nb&lt;-tibble(beta=c(beta.nb,eta),iteration = rep(iteration,3),chain = rep(chain,3),name)

##  Trace Plots

ggplot(filter(df.nb,chain ==&quot;1&quot;), aes(x= iteration, y = beta))+
  geom_line()+
  facet_wrap(~name, labeller = label_parsed)</code></pre>
<p><img src="mxb341-ws-12_files/figure-html/unnamed-chunk-16-4.png" width="624" style="display: block; margin: auto;" /></p>
<pre class="r"><code>
##  Cummulative Mean Plots

ggplot(filter(df.nb,chain==&quot;1&quot;)%&gt;%group_by(name)%&gt;%summarise(beta=cummean(beta), iteration = iteration), aes(x = iteration, y = beta, group = name))+
  geom_line()+
  facet_wrap(~name, labeller = label_parsed)</code></pre>
<p><img src="mxb341-ws-12_files/figure-html/unnamed-chunk-16-5.png" width="624" style="display: block; margin: auto;" /></p>
<pre class="r"><code>
##  BGR Plot

ggplot(df.nb,aes(x=iteration, y = beta, group = chain, color = chain ))+
  geom_line()+
  facet_wrap(~name, labeller = label_parsed)</code></pre>
<p><img src="mxb341-ws-12_files/figure-html/unnamed-chunk-16-6.png" width="624" style="display: block; margin: auto;" /></p>
<pre class="r"><code>
##  BGR Computations

BGR&lt;-function(par,DF)
{
  S&lt;-aggregate(beta~chain,FUN = var, data = filter(DF, name == par))
  W&lt;-mean(S$beta)
  B&lt;-var(S$beta)
  VAR&lt;-(1-1/N)*W+B
  Rhat&lt;-(VAR/W)%&gt;%sqrt()
  return(Rhat)
}

bgr.pois&lt;-sapply(unique(df.pois$name),function(x) BGR(x, df.pois))
bgr.nb&lt;-sapply(unique(df.nb$name),function(x) BGR(x, df.nb))

##  ACF and ESS

##  For Poisson

acf_beta_0&lt;-acf(pois_out[[1]]$beta[,1],plot = FALSE)$acf
acf_beta_1&lt;-acf(pois_out[[1]]$beta[,2],plot = FALSE)$acf
lag&lt;-rep(1:length(acf_beta_0),2)
name&lt;-c(rep(&quot;beta[0]&quot;,length(acf_beta_0)),rep(&quot;beta[1]&quot;,length(acf_beta_1)))

df&lt;-tibble(acf = c(acf_beta_0,acf_beta_1),lag,name)

ggplot(df,aes(x = lag, y = acf))+
  geom_bar(stat = &quot;identity&quot;,alpha = 0.5)+
  geom_hline(yintercept = 0.05,linetype = &quot;dashed&quot;)+
  facet_wrap(~name,labeller = label_parsed)</code></pre>
<p><img src="mxb341-ws-12_files/figure-html/unnamed-chunk-16-7.png" width="624" style="display: block; margin: auto;" /></p>
<pre class="r"><code>
##  For negative-binomial

acf_beta_0&lt;-acf(nb_out[[1]]$beta[,1],plot = FALSE)$acf
acf_beta_1&lt;-acf(nb_out[[1]]$beta[,2],plot = FALSE)$acf
acf_eta&lt;-acf(nb_out[[1]]$eta,plot = FALSE)$acf
lag&lt;-rep(1:length(acf_beta_0),3)
name&lt;-c(rep(&quot;beta[0]&quot;,length(acf_beta_0)),rep(&quot;beta[1]&quot;,length(acf_beta_1)),rep(&quot;eta&quot;,length(acf_eta)))

df&lt;-tibble(acf = c(acf_beta_0,acf_beta_1,acf_eta),lag,name)

ggplot(df,aes(x = lag, y = acf))+
  geom_bar(stat = &quot;identity&quot;,alpha = 0.5)+
  geom_hline(yintercept = 0.05,linetype = &quot;dashed&quot;)+
  facet_wrap(~name,labeller = label_parsed)</code></pre>
<p><img src="mxb341-ws-12_files/figure-html/unnamed-chunk-16-8.png" width="624" style="display: block; margin: auto;" /></p>
<pre class="r"><code>
pois.ess&lt;-mcmcse::ess(pois_out[[1]]$beta)
nb.ess&lt;-mcmcse::ess(cbind(nb_out[[1]]$beta,nb_out[[1]]$eta))</code></pre>
<div id="section-brooks-gelman-rubin-potential-scale-reductions-factors" class="section level3">
<h3>Brooks-Gelman-Rubin Potential Scale Reductions Factors</h3>
<table>
<thead>
<tr class="header">
<th>Model</th>
<th><span class="math inline">\(\beta_0\)</span></th>
<th><span class="math inline">\(\beta_1\)</span></th>
<th><span class="math inline">\(\eta\)</span></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Poisson</td>
<td>1</td>
<td>1.001</td>
<td>-</td>
</tr>
<tr class="even">
<td>Neg-Binom</td>
<td>1</td>
<td>1.021</td>
<td>1.005</td>
</tr>
</tbody>
</table>
</div>
<div id="section-effective-sample-sizes" class="section level3">
<h3>Effective Sample Sizes</h3>
<table>
<thead>
<tr class="header">
<th>Model</th>
<th><span class="math inline">\(\beta_0\)</span></th>
<th><span class="math inline">\(\beta_1\)</span></th>
<th><span class="math inline">\(\eta\)</span></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Poisson</td>
<td>383.341</td>
<td>446.755</td>
<td>-</td>
</tr>
<tr class="even">
<td>Neg-Binom</td>
<td>499.293</td>
<td>239.469</td>
<td>549.654</td>
</tr>
</tbody>
</table>
</div>
<div id="section-deviance-information-criteria" class="section level3">
<h3>Deviance Information Criteria</h3>
<table>
<thead>
<tr class="header">
<th>Model</th>
<th><span class="math inline">\(\bar{D}\)</span></th>
<th><span class="math inline">\(p_D\)</span></th>
<th><span class="math inline">\(p_v\)</span></th>
<th><span class="math inline">\(DIC_{p_D}\)</span></th>
<th><span class="math inline">\(DIC_{p_V}\)</span></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Poisson</td>
<td>42.9767407</td>
<td>1.9965955</td>
<td>2.4106627</td>
<td>44.9733362</td>
<td>45.3874034</td>
</tr>
<tr class="even">
<td>Neg-Binom</td>
<td>36.7700776</td>
<td>2.4366927</td>
<td>2.930137</td>
<td>39.2067702</td>
<td>39.7002145</td>
</tr>
</tbody>
</table>
</div>
</div>
<script>
var acc = document.getElementsByClassName("solution");
var i   ;

for (i = 0; i < acc.length; i++) {
  acc[i].addEventListener("click", function() {
    /* Toggle between adding and removing the "active" class,
    to highlight the button that controls the panel */
    this.classList.toggle("active");

    /* Toggle between hiding and showing the active panel */
    var panel = this.nextElementSibling;
    if (panel.style.display === "block") {
      panel.style.display = "none";
    } else {
      panel.style.display = "block";
    }
  });
}
</script>

<script type="application/shiny-prerendered" data-context="server-start">
# if problems with knitting directory:
# set Knit Directory = Document Directory

# install libraries needed for worksheet
knitr::opts_chunk$set(
  fig.align = 'center',
  collapse = TRUE,
  comment = "#>"
)

library(learnr)
library(kableExtra)
library(pander)
library(shiny)
library(MXB341)


</script>
 
<script type="application/shiny-prerendered" data-context="server">
learnr:::register_http_handlers(session, metadata = NULL)
</script>
 
<script type="application/shiny-prerendered" data-context="server">
session$onSessionEnded(function() {
        learnr:::session_stop_event(session)
      })
</script>
 <!--html_preserve-->
<script type="application/shiny-prerendered" data-context="dependencies">
{"type":"list","attributes":{},"value":[{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name","version","src","meta","script","stylesheet","head","attachment","package","all_files","pkgVersion"]},"class":{"type":"character","attributes":{},"value":["html_dependency"]}},"value":[{"type":"character","attributes":{},"value":["header-attrs"]},{"type":"character","attributes":{},"value":["2.11"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["file"]}},"value":[{"type":"character","attributes":{},"value":["rmd/h/pandoc"]}]},{"type":"NULL"},{"type":"character","attributes":{},"value":["header-attrs.js"]},{"type":"NULL"},{"type":"NULL"},{"type":"NULL"},{"type":"character","attributes":{},"value":["rmarkdown"]},{"type":"logical","attributes":{},"value":[true]},{"type":"character","attributes":{},"value":["2.11"]}]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name","version","src","meta","script","stylesheet","head","attachment","package","all_files"]},"class":{"type":"character","attributes":{},"value":["html_dependency"]}},"value":[{"type":"character","attributes":{},"value":["jquery"]},{"type":"character","attributes":{},"value":["3.6.0"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["file"]}},"value":[{"type":"character","attributes":{},"value":["lib/3.6.0"]}]},{"type":"NULL"},{"type":"character","attributes":{},"value":["jquery-3.6.0.min.js"]},{"type":"NULL"},{"type":"NULL"},{"type":"NULL"},{"type":"character","attributes":{},"value":["jquerylib"]},{"type":"logical","attributes":{},"value":[true]}]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name","version","src","meta","script","stylesheet","head","attachment","package","all_files","pkgVersion"]},"class":{"type":"character","attributes":{},"value":["html_dependency"]}},"value":[{"type":"character","attributes":{},"value":["bootstrap"]},{"type":"character","attributes":{},"value":["3.3.5"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["file"]}},"value":[{"type":"character","attributes":{},"value":["rmd/h/bootstrap"]}]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["viewport"]}},"value":[{"type":"character","attributes":{},"value":["width=device-width, initial-scale=1"]}]},{"type":"character","attributes":{},"value":["js/bootstrap.min.js","shim/html5shiv.min.js","shim/respond.min.js"]},{"type":"character","attributes":{},"value":["css/yeti.min.css"]},{"type":"character","attributes":{},"value":["<style>h1 {font-size: 34px;}\n       h1.title {font-size: 38px;}\n       h2 {font-size: 30px;}\n       h3 {font-size: 24px;}\n       h4 {font-size: 18px;}\n       h5 {font-size: 16px;}\n       h6 {font-size: 12px;}\n       code {color: inherit; background-color: rgba(0, 0, 0, 0.04);}\n       pre:not([class]) { background-color: white }<\/style>"]},{"type":"NULL"},{"type":"character","attributes":{},"value":["rmarkdown"]},{"type":"logical","attributes":{},"value":[true]},{"type":"character","attributes":{},"value":["2.11"]}]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name","version","src","meta","script","stylesheet","head","attachment","package","all_files","pkgVersion"]},"class":{"type":"character","attributes":{},"value":["html_dependency"]}},"value":[{"type":"character","attributes":{},"value":["pagedtable"]},{"type":"character","attributes":{},"value":["1.1"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["file"]}},"value":[{"type":"character","attributes":{},"value":["rmd/h/pagedtable-1.1"]}]},{"type":"NULL"},{"type":"character","attributes":{},"value":["js/pagedtable.js"]},{"type":"character","attributes":{},"value":["css/pagedtable.css"]},{"type":"NULL"},{"type":"NULL"},{"type":"character","attributes":{},"value":["rmarkdown"]},{"type":"logical","attributes":{},"value":[true]},{"type":"character","attributes":{},"value":["2.11"]}]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name","version","src","meta","script","stylesheet","head","attachment","package","all_files","pkgVersion"]},"class":{"type":"character","attributes":{},"value":["html_dependency"]}},"value":[{"type":"character","attributes":{},"value":["highlightjs"]},{"type":"character","attributes":{},"value":["9.12.0"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["file"]}},"value":[{"type":"character","attributes":{},"value":["rmd/h/highlightjs"]}]},{"type":"NULL"},{"type":"character","attributes":{},"value":["highlight.js"]},{"type":"character","attributes":{},"value":["textmate.css"]},{"type":"NULL"},{"type":"NULL"},{"type":"character","attributes":{},"value":["rmarkdown"]},{"type":"logical","attributes":{},"value":[true]},{"type":"character","attributes":{},"value":["2.11"]}]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name","version","src","meta","script","stylesheet","head","attachment","package","all_files","pkgVersion"]},"class":{"type":"character","attributes":{},"value":["html_dependency"]}},"value":[{"type":"character","attributes":{},"value":["tutorial"]},{"type":"character","attributes":{},"value":["0.10.1"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["file"]}},"value":[{"type":"character","attributes":{},"value":["lib/tutorial"]}]},{"type":"NULL"},{"type":"character","attributes":{},"value":["tutorial.js"]},{"type":"character","attributes":{},"value":["tutorial.css"]},{"type":"NULL"},{"type":"NULL"},{"type":"character","attributes":{},"value":["learnr"]},{"type":"logical","attributes":{},"value":[true]},{"type":"character","attributes":{},"value":["0.10.1"]}]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name","version","src","meta","script","stylesheet","head","attachment","package","all_files","pkgVersion"]},"class":{"type":"character","attributes":{},"value":["html_dependency"]}},"value":[{"type":"character","attributes":{},"value":["tutorial-autocompletion"]},{"type":"character","attributes":{},"value":["0.10.1"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["file"]}},"value":[{"type":"character","attributes":{},"value":["lib/tutorial"]}]},{"type":"NULL"},{"type":"character","attributes":{},"value":["tutorial-autocompletion.js"]},{"type":"NULL"},{"type":"NULL"},{"type":"NULL"},{"type":"character","attributes":{},"value":["learnr"]},{"type":"logical","attributes":{},"value":[true]},{"type":"character","attributes":{},"value":["0.10.1"]}]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name","version","src","meta","script","stylesheet","head","attachment","package","all_files","pkgVersion"]},"class":{"type":"character","attributes":{},"value":["html_dependency"]}},"value":[{"type":"character","attributes":{},"value":["tutorial-diagnostics"]},{"type":"character","attributes":{},"value":["0.10.1"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["file"]}},"value":[{"type":"character","attributes":{},"value":["lib/tutorial"]}]},{"type":"NULL"},{"type":"character","attributes":{},"value":["tutorial-diagnostics.js"]},{"type":"NULL"},{"type":"NULL"},{"type":"NULL"},{"type":"character","attributes":{},"value":["learnr"]},{"type":"logical","attributes":{},"value":[true]},{"type":"character","attributes":{},"value":["0.10.1"]}]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name","version","src","meta","script","stylesheet","head","attachment","package","all_files","pkgVersion"]},"class":{"type":"character","attributes":{},"value":["html_dependency"]}},"value":[{"type":"character","attributes":{},"value":["tutorial-format"]},{"type":"character","attributes":{},"value":["0.10.1"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["file"]}},"value":[{"type":"character","attributes":{},"value":["rmarkdown/templates/tutorial/resources"]}]},{"type":"NULL"},{"type":"character","attributes":{},"value":["tutorial-format.js"]},{"type":"character","attributes":{},"value":["tutorial-format.css"]},{"type":"NULL"},{"type":"NULL"},{"type":"character","attributes":{},"value":["learnr"]},{"type":"logical","attributes":{},"value":[true]},{"type":"character","attributes":{},"value":["0.10.1"]}]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name","version","src","meta","script","stylesheet","head","attachment","package","all_files"]},"class":{"type":"character","attributes":{},"value":["html_dependency"]}},"value":[{"type":"character","attributes":{},"value":["jquery"]},{"type":"character","attributes":{},"value":["3.6.0"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["file"]}},"value":[{"type":"character","attributes":{},"value":["lib/3.6.0"]}]},{"type":"NULL"},{"type":"character","attributes":{},"value":["jquery-3.6.0.min.js"]},{"type":"NULL"},{"type":"NULL"},{"type":"NULL"},{"type":"character","attributes":{},"value":["jquerylib"]},{"type":"logical","attributes":{},"value":[true]}]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name","version","src","meta","script","stylesheet","head","attachment","package","all_files","pkgVersion"]},"class":{"type":"character","attributes":{},"value":["html_dependency"]}},"value":[{"type":"character","attributes":{},"value":["navigation"]},{"type":"character","attributes":{},"value":["1.1"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["file"]}},"value":[{"type":"character","attributes":{},"value":["rmd/h/navigation-1.1"]}]},{"type":"NULL"},{"type":"character","attributes":{},"value":["tabsets.js"]},{"type":"NULL"},{"type":"NULL"},{"type":"NULL"},{"type":"character","attributes":{},"value":["rmarkdown"]},{"type":"logical","attributes":{},"value":[true]},{"type":"character","attributes":{},"value":["2.11"]}]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name","version","src","meta","script","stylesheet","head","attachment","package","all_files","pkgVersion"]},"class":{"type":"character","attributes":{},"value":["html_dependency"]}},"value":[{"type":"character","attributes":{},"value":["highlightjs"]},{"type":"character","attributes":{},"value":["9.12.0"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["file"]}},"value":[{"type":"character","attributes":{},"value":["rmd/h/highlightjs"]}]},{"type":"NULL"},{"type":"character","attributes":{},"value":["highlight.js"]},{"type":"character","attributes":{},"value":["default.css"]},{"type":"NULL"},{"type":"NULL"},{"type":"character","attributes":{},"value":["rmarkdown"]},{"type":"logical","attributes":{},"value":[true]},{"type":"character","attributes":{},"value":["2.11"]}]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name","version","src","meta","script","stylesheet","head","attachment","package","all_files"]},"class":{"type":"character","attributes":{},"value":["html_dependency"]}},"value":[{"type":"character","attributes":{},"value":["jquery"]},{"type":"character","attributes":{},"value":["3.6.0"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["file"]}},"value":[{"type":"character","attributes":{},"value":["lib/3.6.0"]}]},{"type":"NULL"},{"type":"character","attributes":{},"value":["jquery-3.6.0.min.js"]},{"type":"NULL"},{"type":"NULL"},{"type":"NULL"},{"type":"character","attributes":{},"value":["jquerylib"]},{"type":"logical","attributes":{},"value":[true]}]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name","version","src","meta","script","stylesheet","head","attachment","package","all_files","pkgVersion"]},"class":{"type":"character","attributes":{},"value":["html_dependency"]}},"value":[{"type":"character","attributes":{},"value":["font-awesome"]},{"type":"character","attributes":{},"value":["5.1.0"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["file"]}},"value":[{"type":"character","attributes":{},"value":["rmd/h/fontawesome"]}]},{"type":"NULL"},{"type":"NULL"},{"type":"character","attributes":{},"value":["css/all.css","css/v4-shims.css"]},{"type":"NULL"},{"type":"NULL"},{"type":"character","attributes":{},"value":["rmarkdown"]},{"type":"logical","attributes":{},"value":[true]},{"type":"character","attributes":{},"value":["2.11"]}]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name","version","src","meta","script","stylesheet","head","attachment","package","all_files","pkgVersion"]},"class":{"type":"character","attributes":{},"value":["html_dependency"]}},"value":[{"type":"character","attributes":{},"value":["bootbox"]},{"type":"character","attributes":{},"value":["4.4.0"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["file"]}},"value":[{"type":"character","attributes":{},"value":["lib/bootbox"]}]},{"type":"NULL"},{"type":"character","attributes":{},"value":["bootbox.min.js"]},{"type":"NULL"},{"type":"NULL"},{"type":"NULL"},{"type":"character","attributes":{},"value":["learnr"]},{"type":"logical","attributes":{},"value":[true]},{"type":"character","attributes":{},"value":["0.10.1"]}]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name","version","src","meta","script","stylesheet","head","attachment","package","all_files","pkgVersion"]},"class":{"type":"character","attributes":{},"value":["html_dependency"]}},"value":[{"type":"character","attributes":{},"value":["idb-keyvalue"]},{"type":"character","attributes":{},"value":["3.2.0"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["file"]}},"value":[{"type":"character","attributes":{},"value":["lib/idb-keyval"]}]},{"type":"NULL"},{"type":"character","attributes":{},"value":["idb-keyval-iife-compat.min.js"]},{"type":"NULL"},{"type":"NULL"},{"type":"NULL"},{"type":"character","attributes":{},"value":["learnr"]},{"type":"logical","attributes":{},"value":[false]},{"type":"character","attributes":{},"value":["0.10.1"]}]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name","version","src","meta","script","stylesheet","head","attachment","package","all_files","pkgVersion"]},"class":{"type":"character","attributes":{},"value":["html_dependency"]}},"value":[{"type":"character","attributes":{},"value":["tutorial"]},{"type":"character","attributes":{},"value":["0.10.1"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["file"]}},"value":[{"type":"character","attributes":{},"value":["lib/tutorial"]}]},{"type":"NULL"},{"type":"character","attributes":{},"value":["tutorial.js"]},{"type":"character","attributes":{},"value":["tutorial.css"]},{"type":"NULL"},{"type":"NULL"},{"type":"character","attributes":{},"value":["learnr"]},{"type":"logical","attributes":{},"value":[true]},{"type":"character","attributes":{},"value":["0.10.1"]}]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name","version","src","meta","script","stylesheet","head","attachment","package","all_files","pkgVersion"]},"class":{"type":"character","attributes":{},"value":["html_dependency"]}},"value":[{"type":"character","attributes":{},"value":["tutorial-autocompletion"]},{"type":"character","attributes":{},"value":["0.10.1"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["file"]}},"value":[{"type":"character","attributes":{},"value":["lib/tutorial"]}]},{"type":"NULL"},{"type":"character","attributes":{},"value":["tutorial-autocompletion.js"]},{"type":"NULL"},{"type":"NULL"},{"type":"NULL"},{"type":"character","attributes":{},"value":["learnr"]},{"type":"logical","attributes":{},"value":[true]},{"type":"character","attributes":{},"value":["0.10.1"]}]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name","version","src","meta","script","stylesheet","head","attachment","package","all_files","pkgVersion"]},"class":{"type":"character","attributes":{},"value":["html_dependency"]}},"value":[{"type":"character","attributes":{},"value":["tutorial-diagnostics"]},{"type":"character","attributes":{},"value":["0.10.1"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["file"]}},"value":[{"type":"character","attributes":{},"value":["lib/tutorial"]}]},{"type":"NULL"},{"type":"character","attributes":{},"value":["tutorial-diagnostics.js"]},{"type":"NULL"},{"type":"NULL"},{"type":"NULL"},{"type":"character","attributes":{},"value":["learnr"]},{"type":"logical","attributes":{},"value":[true]},{"type":"character","attributes":{},"value":["0.10.1"]}]}]}
</script>
<!--/html_preserve-->
<!--html_preserve-->
<script type="application/shiny-prerendered" data-context="execution_dependencies">
{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["packages"]}},"value":[{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["packages","version"]},"class":{"type":"character","attributes":{},"value":["data.frame"]},"row.names":{"type":"integer","attributes":{},"value":[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,84,85,86,87,88,89,90,91,92,93,94,95,96,97,98,99,100,101]}},"value":[{"type":"character","attributes":{},"value":["assertthat","backports","base","broom","bslib","cellranger","cli","colorspace","compiler","crayon","datasets","DBI","dbplyr","digest","dplyr","ellipse","ellipsis","evaluate","fansi","farver","fastmap","forcats","fs","generics","ggforce","ggplot2","ggtext","glue","graphics","grDevices","grid","gridExtra","gridtext","gtable","haven","highr","hms","htmltools","htmlwidgets","httpuv","httr","jquerylib","jsonlite","kableExtra","knitr","labeling","later","learnr","lifecycle","lubridate","magrittr","markdown","MASS","mcmcse","methods","mime","modelr","munsell","mvtnorm","MXB341","pander","pillar","pkgconfig","polyclip","pracma","promises","purrr","R6","Rcpp","readr","readxl","reprex","rlang","rmarkdown","rprojroot","rstudioapi","rvest","sass","scales","shiny","stats","stringi","stringr","svglite","systemfonts","tibble","tidyr","tidyselect","tidyverse","tools","tweenr","utf8","utils","vctrs","viridisLite","webshot","withr","xfun","xml2","xtable","yaml"]},{"type":"character","attributes":{},"value":["0.2.1","1.2.1","4.0.5","0.7.8","0.2.5.1","1.1.0","2.5.0","2.0-2","4.0.5","1.4.1","4.0.5","1.1.1","2.1.1","0.6.27","1.0.7","0.4.2","0.3.2","0.14","0.5.0","2.1.0","1.1.0","0.5.1","1.5.0","0.1.0","0.3.3","3.3.5","0.1.1","1.5.0","4.0.5","4.0.5","4.0.5","2.3","0.1.4","0.3.0","2.4.1","0.9","1.1.0","0.5.1.1","1.5.3","1.6.1","1.4.2","0.1.4","1.7.2","1.3.4","1.33","0.4.2","1.2.0","0.10.1","1.0.0","1.7.10","2.0.1","1.1","7.3-54","1.4-1","4.0.5","0.12","0.1.8","0.5.0","1.1-2","1.0.0.2021","0.6.4","1.6.1","2.0.3","1.10-0","2.3.3","1.2.0.1","0.3.4","2.5.1","1.0.6","1.4.0","1.3.1","2.0.0","0.4.12","2.11","2.0.2","0.13","1.0.0","0.4.0","1.1.1","1.6.0","4.0.5","1.6.2","1.4.0","2.0.0","1.0.2","3.1.2","1.1.3","1.1.1","1.3.1","4.0.5","1.0.2","1.2.1","4.0.5","0.3.8","0.4.0","0.5.2","2.4.2","0.24","1.3.2","1.8-4","2.2.1"]}]}]}
</script>
<!--/html_preserve-->
</div>
</div>

</div> <!-- topics -->

<div class="topicsContainer">
<div class="topicsPositioner">
<div class="band">
<div class="bandContent topicsListContainer">

<!-- begin doc-metadata -->
<div id="doc-metadata">
<h2 class="title toc-ignore" style="display:none;">MXB341 Worksheet 12 - MCMC Diganostics</h2>
</div>
<!-- end doc-metadata -->

</div> <!-- bandContent.topicsListContainer -->
</div> <!-- band -->
</div> <!-- topicsPositioner -->
</div> <!-- topicsContainer -->


</div> <!-- bandContent page -->
</div> <!-- pageContent band -->




<script>
// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.header').parent('thead').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});
</script>


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>


</body>

</html>
