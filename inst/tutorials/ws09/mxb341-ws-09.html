<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">

<head>

<meta charset="utf-8">
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="generator" content="pandoc" />



<meta name="progressive" content="false" />
<meta name="allow-skip" content="false" />

<title>MXB341 Worksheet 09 - Bayesian Inference</title>


<!-- highlightjs -->
<style type="text/css">code{white-space: pre;}</style>
<style type="text/css">
  pre:not([class]) {
    background-color: white;
  }
</style>
<script type="text/javascript">
if (window.hljs) {
  hljs.configure({languages: []});
  hljs.initHighlightingOnLoad();
  if (document.readyState && document.readyState === "complete") {
    window.setTimeout(function() { hljs.initHighlighting(); }, 0);
  }
}
</script>

<!-- taken from https://github.com/rstudio/rmarkdown/blob/67b7f5fc779e4cfdfd0f021d3d7745b6b6e17149/inst/rmd/h/default.html#L296-L362 -->
<!-- tabsets -->

<style type="text/css">
.tabset-dropdown > .nav-tabs {
  display: inline-table;
  max-height: 500px;
  min-height: 44px;
  overflow-y: auto;
  background: white;
  border: 1px solid #ddd;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs > li.active:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li.active:before {
  content: "&#xe258;";
  border: none;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs > li.active {
  display: block;
}

.tabset-dropdown > .nav-tabs > li > a,
.tabset-dropdown > .nav-tabs > li > a:focus,
.tabset-dropdown > .nav-tabs > li > a:hover {
  border: none;
  display: inline-block;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li {
  display: block;
  float: none;
}

.tabset-dropdown > .nav-tabs > li {
  display: none;
}
</style>

<script>
$(document).ready(function () {
  window.buildTabsets("section-TOC");
});

$(document).ready(function () {
  $('.tabset-dropdown > .nav-tabs > li').click(function () {
    $(this).parent().toggleClass('nav-tabs-open')
  });
});
</script>
<!-- end tabsets -->


<link rel="stylesheet" href="css/QUT.css" type="text/css" />
<link rel="stylesheet" href="css/QUTtutorial.css" type="text/css" />

</head>

<body>



<div class="pageContent band">
<div class="bandContent page">

<div class="topics">

<p style="margin-bottom:0.6cm;"></p>

<a><img src = "images/logo.png" height="100px" 
          alt = "MXB341 Blackboard Page"><span style="font-size:40px;color:#00407a"> &thinsp; MXB341 Statistical Inference</span></a>

<p style="margin-bottom:1cm;"></p>
<style type="text/css">
.pageContent {
}

.band {
  padding-left: 5%;
  padding-right: 5%;
  position: relative;
}

.bandContent {
  margin: 0 auto;
  max-width: 1200px;
}

.bandContent.page {
  display: flex;
  display: -ms-flexbox;
  display: -webkit-box;
  display: -webkit-flex;

  justify-content: space-between;
  -webkit-justify-content: space-between;
  -ms-flex-pack: justify;

  flex-direction: row-reverse;
  -webkit-flex-direction: row-reverse;
}

.topics {
  width: 75%;
  overflow-x: auto;
  padding-bottom: 600px;
}

.topics .tutorialTitle {
  display: none;
  border-bottom: 3px dotted #f0f0f0;
}

.topics .section.level2 {
  display: none;
  margin-bottom: 40px;
}

.topics .section.level2.current {
  display: block;
}

.topicsContainer {
  width: 23%;
  min-width: 270px;
  margin-right: 2%;
  z-index: 100;
}

.topicsPositioner {
  position: fixed;
  left: 0px;
  width: 100%;
  height: 0px;
  background-color: pink;
}

.topicsList {
  float: left;
  position: relative;
  width: 23%;
  min-width: 270px;
  overflow: auto;
  height: auto;
  scroll-behavior: smooth;
  transform: translateZ(0); /* force repaint to work on older browser used in the IDE */
}

.topicsHeader {
  display: flex;
  display: -ms-flexbox;
  display: -webkit-box;
  display: -webkit-flex;

  justify-content: space-between;
  -webkit-justify-content: space-between;
  -ms-flex-pack: justify;
}

.topicsFooter {
  margin-top: 10px;
  padding-bottom: 20px;
}

.topicsFooter .resetButton {
  padding-left: 10px;
  font-size: .66em;
  cursor: pointer;
  opacity: .7;
}

.topicsFooter .resetButton:hover {
  opacity: 1;
}

.topicsList .topic {
  line-height: 40px;
  font-size: 15px;
  padding-left: 10px;
  cursor: pointer;

  background-repeat: no-repeat;
  background-size: 2px 80px;
  background-position: left 100%;
  background-image: url(images/topicProgress.png);
  border-bottom: 1px solid #f8f8f8;

  -webkit-transition-property: background-position;
  transition-property: background-position;
  -webkit-transition-duration: 0.25s;
  transition-duration: 0.25s;
}

.topicsList .topic:hover {
  background-color: #fcfcfc;
}

.topicsList .topic.current {
  background-color: #f8f8f8;
}

.section.level3 {
  margin-bottom: 40px;
}

.paneCloser {
  display: none;
  height: 30px;
  width: 30px;
  background: url(images/close.svg) no-repeat center center;
  background-size: 30px 30px;
  border-radius: 15px;
  position: relative;
  top: 8px;
}

.paneCloser:hover {
  background-color: rgba( 0, 0, 0, .05);
}

.section.level3.hide {
  display: none;
}

.section.level3.done h3 {
  padding-left: 25px;
  background-image: url(images/exerciseDone.svg);
  background-size: 20px 20px;
  background-position: left center;
  background-repeat: no-repeat;
}

.exerciseActions {
  margin: 20px 0;
}

.skip {
  display: none;
}

.showSkip .skip {
  display: inline-block;
}

.topicActions {
  margin-top: 20px;
}

.topicActions button {
  margin-right: 10px;
}

.section.level2.hideActions .topicActions {
  display: none;
}

#doc-metadata {
  margin-bottom: 10px;
  line-height: 1.6em;
}

#doc-metadata h3 {
  margin: 0;
  font-size: 1.2em;
  line-height: 2em;
}

#doc-metadata h4 {
  margin: 0;
  font-size: 1em;
  line-height: 1.6em;
}

#doc-metadata em {
  font-style: normal;
}

@media screen and (max-width: 767px) {
  .topics {
    width: 99%;
  }

  .topics .tutorialTitle {
    display: block;
    cursor: pointer;
  }

  .topicsContainer {
    width: 1%;
    min-width: 1px;
    margin-right: 0;
  }

  .topicsList {
    padding: 0px 10px 20px 1%;
    background-color: rgba(255, 255, 255, 0.98);

    box-shadow: 0 5px 25px 0px rgba(0, 0, 0, 0.15);
    -webkit-box-shadow: 0 5px 25px 0px rgba(0, 0, 0, 0.15);
  }

  .topicsList.hideFloating {
    display: none;
  }
  

  .paneCloser {
    display: inline-block;
  }
}

.topicsList .topic.current {
    background-color: #00407a;
    color: #ecf0f1;
    border: 0px;
}

/* override the width to be 100%, not 300px wide */
.shiny-input-container:not(.shiny-input-container-inline) {
  width: 100%;
}
.tutorial-exercise-support {
  width: 100%;
  max-width: 45em;
  display: none;
}

.slide .tutorial-exercise {
  width:100%;
  max-width: 45em;
  line-height: 1.4;
}

.tutorial-exercise {
  
  width:100%;
  max-width: 45em;
  position: relative;
}

.tutorial-exercise-input {
  margin-top: 15px;
}

.tutorial-panel-heading {
  background-color: #00407a;
  color: #ecf0f1;
  padding-top: 6px;
  padding-bottom: 6px;
  padding-left: 8px;
  padding-right: 8px;
  font-size: 13px;
  font-weight: 500;
  width: 100%;
}
.tutorial-quiz-title {
  font-weight: 300;
  font-size: 18px;
  padding-top: 6px;
  padding-bottom: 0px;
  padding-left: 0px;
  padding-right: 8px;
  width: 100%;
}

.tutorial-question {
  padding-top: 10px;
  padding-bottom: 15px;
}

.tutorial-exercise-input .btn-xs {
  border-radius: 3px;
  color: #ecf0f1;
  border-color: #00407a;
  background-color: #00407a;
  margin-right: 0;
  margin-top: -1px;
  font-size: 11px;
  margin-left: 12px;
  padding-right: 8px;
  font-weight: normal;
}

.btn-light {
  border-radius: 3px;
  color: #ecf0f1;
  background-color: #00407a;
  border-color: #ecf0f1;
}

.btn-light:hover
{
   color: #ecf0f1;
  background-color: #00407a;
  border-color: #ecf0f1; 
}

.btn-primary
{
  border-radius: 3px;
     color: #ecf0f1;
  background-color: #00407a;
  border-color: #333; 
}

.btn-default
{
  border-radius: 3px;
}

.btn-primary:hover
{
     color: #ecf0f1;
  background-color: #00407a;
  border-color: #00407a; 
}

.tutorial-exercise-input .btn-tutorial-solution {
  margin-left: 15px;
}

.tutorial-exercise-input .btn-tutorial-next-hint {
  margin-left: 15px;
  padding-right: 4px;
}

.tutorial-exercise-input .btn-xs i {
  color: #ecf0f1;
  border-color: #00407a;
  width: 10px;
  margin-right: 1px;
}

.tutorial-exercise-input .panel-body {
  padding: 0;
}


.tutorial-exercise-code-editor {
  width: 100%;
}


.tutorial-solution-popover {
  max-width: none;
  width: 100%;
}

.tutorial-solution-popover.top>.arrow {
  margin-left: 0;
}

.tutorial-hint {
  background-color: #00407a;

}

.ace-tm {
  font-family: monospace;
  font-size: 90%;
}


.tutorial-video-container {
  position: relative;
  margin-top: 15px;
  margin-bottom: 15px;
}

.tutorial-exercise-output>pre {
  max-height: 500px;
  overflow-y: auto;
}

.tutorial-video {
  position: absolute;
  top: 0;
  left: 0;
  width: 100%;
  height: 100%;
  border: solid 1px #cccccc;
}

/* Change colors for tabset tabset-pills */

.nav>li>a {
    position: relative;
    display: block;
    padding: 10px 15px;
    color: #00407a;
}
.nav-pills>li.active>a, .nav-pills>li.active>a:hover, .nav-pills>li.active>a:focus {
    color: #ffffff;
    background-color: #00407a;
}


section {
    float: left;
    margin: 10px;
    width: 60%;
    max-width: 45em;
}

p {
  max-width: 45em;
}

.r
{
  width: 100%;
  max-width: 45em;
}


.sidenote {
    float: right;
    clear: right;
    margin-right: -15%;
    width: 40%;
    margin-top: 0;
    margin-bottom: 1rem;
    font-size: 1.3rem;
    lineheight: 1.3;
    vertical-align: baseline;
    position: relative;
    color: ecf0f1;
    border: 1px solid black;
    padding: 5px 10px 5px;
}

.table {
  float: left;
  width: 100%;
  max-width:45em;
  margin: 10px 500px 10px 0px;
  padding: 5px 10px 5px;
}


.boxed {
    float: left;
    color: ecf0f1;
    border: 1px solid black;
    margin: 10px 500px 10px 0px;
    width: 100%;
    max-width: 45em;
    padding: 5px 10px 5px;</style>
<style type="text/css">.navbar-default {
  background-color: #00407a;
  border-color: #00407a;
}
.navbar-default .navbar-brand {
  color: #ecf0f1;
}
.navbar-default .navbar-brand:hover,
.navbar-default .navbar-brand:focus {
  color: #ecf0f1;
}
.navbar-default .navbar-text {
  color: #ecf0f1;
}
.navbar-default .navbar-nav > li > a {
  color: #ecf0f1;
}
.navbar-default .navbar-nav > li > a:hover,
.navbar-default .navbar-nav > li > a:focus {
  color: #ecf0f1;
}
.navbar-default .navbar-nav > .active > a,
.navbar-default .navbar-nav > .active > a:hover,
.navbar-default .navbar-nav > .active > a:focus {
  color: #ecf0f1;
  background-color: #00407a;
}
.navbar-default .navbar-nav > .open > a,
.navbar-default .navbar-nav > .open > a:hover,
.navbar-default .navbar-nav > .open > a:focus {
  color: #ecf0f1;
  background-color: #00407a;
}
.navbar-default .navbar-toggle {
  border-color: #00407a;
}
.navbar-default .navbar-toggle:hover,
.navbar-default .navbar-toggle:focus {
  background-color: #00407a;
}
.navbar-default .navbar-toggle .icon-bar {
  background-color: #ecf0f1;
}
.navbar-default .navbar-collapse,
.navbar-default .navbar-form {
  border-color: #ecf0f1;
}
.navbar-default .navbar-link {
  color: #ecf0f1;
}
.navbar-default .navbar-link:hover {
  color: #ecf0f1;
}

  .navbar-default .navbar-nav .open .dropdown-menu>li>a, .navbar-default .navbar-nav .open .dropdown-menu {
    background-color: #00407a;
    color:#ecf0f1;
  }

@media (max-width: 767px) {
  .navbar-default .navbar-nav .open .dropdown-menu > li > a {
    color: #ecf0f1;
  }
  .navbar-default .navbar-nav .open .dropdown-menu > li > a:hover,
  .navbar-default .navbar-nav .open .dropdown-menu > li > a:focus {
    color: #ecf0f1;
  }
  .navbar-default .navbar-nav .open .dropdown-menu > .active > a,
  .navbar-default .navbar-nav .open .dropdown-menu > .active > a:hover,
  .navbar-default .navbar-nav .open .dropdown-menu > .active > a:focus {
    color: #ecf0f1;
    background-color: #00407a;
  }
}

/* Change colors for tabset tabset-pills */

.nav>li>a {
    position: relative;
    display: block;
    padding: 10px 15px;
    color: #00407a;
}
.nav-pills>li.active>a, .nav-pills>li.active>a:hover, .nav-pills>li.active>a:focus {
    color: #ffffff;
    background-color: #00407a;
}


section {
    float: left;
    margin: 10px;
    width: 60%;
    max-width: 45em;
}

aside {
    float: right;
    margin: 10px;
    width: 15%;
}


#TOC {
    position: fixed;
    left: 10px;
    top: 60px;
    width: 200px;
    height: 100%;
    overflow: auto;
}

.boxed {
    float: left;
    color: ecf0f1;
    border: 1px solid black;
    margin: 10px 500px 10px 0px; 
    width: 100%;
    max-width: 45em;
    padding: 5px 10px 5px;
}


.sidenote {
    float: right;
    clear: right;
    margin-right: -15%;
    width: 40%;
    margin-top: 0;
    margin-bottom: 1rem;
    font-size: 1.3rem;
    lineheight: 1.3;
    vertical-align: baseline;
    position: relative;
    color: ecf0f1;
    border: 1px solid black;
    padding: 5px 10px 5px;
} 

    /* Style the buttons that are used to open and close the accordion panel */
    
.solution {
  border-radius: 3px;
  background-color: #00407a;
  color: #ecf0f1;
  cursor: pointer;
  padding: 10px;
  margin: 1px;
  width: 20%;
  text-align: center;
  border: none;
  outline: none;
  transition: 0.1s;
}

/* Add a background color to the button if it is clicked on (add the .active class with JS), and when you move the mouse over it (hover) */
.active, .solution:hover {
  color: #00407a;
  background-color: #ecf0f1;
}

/* Style the solution panel. Note: hidden by default */
.panel {
  padding: 0 10px;
  background-color: white;
  display: none;
  overflow: hidden;
}</style>
<div class="quote">
<p>“Most of us have grown so blase about computer developments and capabilities — even some that are spectacular — that it is difficult to believe or imagine there was a time when we suffered the noisy, painstakingly slow, electromechanical devices that chomped away on punched cards.” — Nick Metropolis</p>
</div>
<div id="section-recap-sampling-based-methods-for-bayesian-results" class="section level1">
<h1>Recap: Sampling Based Methods for Bayesian Results</h1>
<div id="section-monte-carlo-integration" class="section level2">
<h2>Monte Carlo Integration</h2>
<div class="boxed">
<p>The basic idea of Monte Carlo integration is <span class="math display">\[
\int_0^1f(x)dx\approx\frac{1}{N}\sum_{i=1}^Nf(x_i),\:x_i\stackrel{iid}{\sim}U(0,1)
\]</span> or that the value of the integral is the expected value of the probability density function with respect to a uniform density over the range of integration</p>
<p>This integral, or expectation, can be approximated by the sample mean of the density function evaluated at random values drawn uniformly over <span class="math inline">\((0,1)\)</span>. The sample mean converges to the true value and is an unbiased estimator of the integrand.</p>
<p>This can be generalised over any interval <span class="math display">\[
\int_a^bf(x)dx\approx(b-a)\frac{1}{N}\sum_{i=1}^Nf(x_i),\:x_i\stackrel{iid}{\sim}U(a,b).
\]</span></p>
<p>Rather than sampling from a uniform distribution and evaluating the probability density function, if samples can be drawn from the probability density function, then one can write the integral in terms of the sample expectation of the indicator function <span class="math display">\[
\int_a^bf(x)dx\approx(b-a)\frac{1}{N}\sum_{i=1}^Nf(x_i),\:x_i\stackrel{iid}{\sim}U(a,b)\\
\equiv \frac{1}{N}\sum_{i=1}^N\mathbb{I}_{x_i\in(a,b)},\:x_i\stackrel{iid}{\sim}f(x).
\]</span> and for any function <span class="math inline">\(h(x)\)</span> <span class="math display">\[
E(h(x))\approx\frac{1}{N}\sum_{i=1}^Nh(x_i),\:x_i\stackrel{iid}{\sim}f(x).
\]</span></p>
</div>
</div>
<div id="section-the-fundamental-theorem-of-simulation" class="section level2">
<h2>The Fundamental Theorem of Simulation</h2>
<div class="boxed">
<p><strong>The Fundamental Theorem of Simulation</strong><br />
One definition of the Fundamental Theorem of Simulation is that <span class="math display">\[
F(x)\sim U(0,1).
\]</span> or that if <span class="math inline">\(x\)</span> is is a realisation of the random vaiable <span class="math inline">\(X\sim f(x)\)</span> then cdf <span class="math inline">\(F(x)\)</span> evaluated at <span class="math inline">\(x\)</span> follows a uniform distribution over the interval <span class="math inline">\((0,1)\)</span>.</p>
</div>
<div class="boxed">
<p><strong>The Fundamental Theorem of Simulation (cont’d)</strong><br />
Note the identity for any density <span class="math inline">\(f\)</span>: <span class="math display">\[
f(x)=\int_0^{f(x)}1du
\]</span> this is the equivalent of saying that <span class="math inline">\(f\)</span> is the marginal density of <span class="math inline">\(X\)</span> for the joint distribution: <span class="math display">\[
(X,U)\sim\{(x,u):0&lt;u&lt;f(x)\}.
\]</span></p>
</div>
</div>
<div id="section-rejection-sampling" class="section level2">
<h2>Rejection Sampling</h2>
<div class="boxed">
<p><strong>Rejection Sampling:</strong><br />
We can generalise the algorithm developed above and state that given a target distribution for some random variable <span class="math inline">\(Y\)</span> with density function <span class="math inline">\(g(y)\)</span>, possibly known up to a proportionality constant, (i.e. <span class="math inline">\(\int_Yg(y)dy\propto 1\)</span>), we can generate samples from <span class="math inline">\(g(y)\)</span> by drawing samples from some arbitrary but known probability distribution for <span class="math inline">\(X\)</span> with density function <span class="math inline">\(f(x)\)</span> and accepting the generate <span class="math inline">\(x\)</span> as a sample from <span class="math inline">\(g(y)\)</span> with the probability <span class="math inline">\(g(x)/Mf(x)\)</span>.</p>
<p>In the actual implementation, we initialise the algorithm by identifying some candidate distribution <span class="math inline">\(f(x)\)</span> that we can readily use to generate random samples and compute <span class="math inline">\(M\)</span> such that <span class="math display">\[
g(y)\leq Mf(y)\: \forall\, y\in Y
\]</span> meaning that <span class="math display">\[
M = \sup_Y \frac{g(y)}{f(y)}.
\]</span> Then the resulting algorithm is</p>
<ol style="list-style-type: decimal">
<li>Draw a sample <span class="math inline">\(x\)</span> from the candidate density <span class="math inline">\(f(x)\)</span> and a random sample <span class="math inline">\(u\sim U(0,1)\)</span>.</li>
<li>Compute <span class="math inline">\(u^*= \frac{g(x)}{Mf(x)}\)</span></li>
<li>If <span class="math inline">\(u\leq u^*\)</span> accept <span class="math inline">\(x\)</span> as a random sample from <span class="math inline">\(g(\cdot)\)</span>. Else reject <span class="math inline">\(x\)</span></li>
<li>Repeat until the desired number of samples is reached.</li>
</ol>
<p>Provided that both densities are normalised, on average, it will take <span class="math inline">\(M\)</span> draws from <span class="math inline">\(X\)</span> to generate 1 sample from <span class="math inline">\(Y\)</span>.</p>
</div>
</div>
<div id="section-monte-carlo-markov-chain-mcmc-and-the-metropolis-hastings-algorithm" class="section level2">
<h2>Monte Carlo Markov Chain (MCMC) and the Metropolis Hastings Algorithm</h2>
<div id="section-the-metropolis-hastings-algorithm" class="section level3 unnumbered boxed">
<h3 class="unnumbered">The Metropolis-Hastings Algorithm</h3>
<p>For some some target density <span class="math inline">\(f(x)\)</span> let <span class="math inline">\(g(x)\propto f(x)\)</span>.</p>
<ol style="list-style-type: decimal">
<li><p>Pick and initial value for <span class="math inline">\(x_0\)</span></p></li>
<li><p>for <span class="math inline">\(t\)</span> in <span class="math inline">\(1:T\)</span>:</p></li>
<li><p>Given an current value of <span class="math inline">\(x_t\)</span> choose an arbitrary distribution <span class="math inline">\(q\)</span> that has the same support as <span class="math inline">\(f\)</span> and is symmetric, i.e. <span class="math inline">\(q(x|y)=q(y|x)\)</span> and generate a proposed new value <span class="math inline">\(x&#39;\)</span>.</p></li>
<li><p>Calculate the acceptance probability: <span class="math display">\[\alpha=\min\left(1,\frac{g(x&#39;)}{g(x_t)}\right)\]</span></p></li>
<li><p>Accept <span class="math inline">\(x_{t+1}=x&#39;\)</span> with probability <span class="math inline">\(\alpha\)</span>, else <span class="math inline">\(x_{t+1}=x_t\)</span>.</p></li>
</ol>
<p><span class="math display">\[
\alpha=\min\left(1,\frac{g(x&#39;)q(x_t|x&#39;)}{g(x_t)q(x&#39;|x_t)}\right)
\]</span></p>
<p>It is important to note that working with the function <span class="math inline">\(g\)</span> instead of the proper density works because the normalising constant will be the same for <span class="math inline">\(f(x_t)\)</span> and <span class="math inline">\(f(x&#39;)\)</span>, thus they would cancel out in the ratio, making the acceptance probability the same if calculated with <span class="math inline">\(f\)</span> or <span class="math inline">\(g\)</span>. In a Bayesian context, this is useful because if <span class="math inline">\(g(\theta) = f(\mathbf{y}|\theta)\pi(\theta)\)</span> from Bayes theorem, then it the Metropolis-Hastings algorithm for drawing samples from a posterior distribution is</p>
<ol style="list-style-type: decimal">
<li><p>Pick and initial value for <span class="math inline">\(\theta_0\)</span></p></li>
<li><p>for <span class="math inline">\(t\)</span> in <span class="math inline">\(1:T\)</span>:</p></li>
<li><p>Given an current value of <span class="math inline">\(\theta_t\)</span> choose an arbitrary distribution <span class="math inline">\(q\)</span> that has the same support as <span class="math inline">\(\pi(\theta|\mathbf{y})\)</span> to generate a proposed new value <span class="math inline">\(\theta&#39;\)</span>.</p></li>
<li><p>Calculate the acceptance probability: <span class="math display">\[\alpha=\min\left(1,\frac{f(\mathbf{y}|\theta&#39;)\pi(\theta&#39;)q(\theta_t|\theta&#39;)}{f(\mathbf{y}|\theta_t)\pi(\theta_t)q(\theta&#39;|\theta_t)}\right)\]</span></p></li>
<li><p>Accept <span class="math inline">\(\theta_{t+1}=\theta&#39;\)</span> with probability <span class="math inline">\(\alpha\)</span>, else <span class="math inline">\(\theta_{t+1}=\theta_t\)</span>.</p></li>
</ol>
<p>Running these algorithms for time <span class="math inline">\(T\)</span> results in a sample of size <span class="math inline">\(T\)</span> of random samples from the target density function.</p>
</div>
<div class="boxed">
<p><strong>The Random Walk Metropolis-Hastings Algorithm</strong><br />
</p>
<ol style="list-style-type: decimal">
<li><p>Pick and initial value for <span class="math inline">\(x_1\)</span></p></li>
<li><p>for <span class="math inline">\(t\)</span> in <span class="math inline">\(1:T\)</span>:</p></li>
<li><p>Choose a distribution <span class="math inline">\(q(x&#39;|x_t)\)</span> such that <span class="math inline">\(E(x&#39;|x_t)=x_t\)</span> that has the same support as <span class="math inline">\(f\)</span> and generate a proposed new value <span class="math inline">\(x&#39;\)</span>.</p></li>
<li><p>Calculate the acceptance probability: <span class="math display">\[\alpha=\min\left(1,\frac{g(x&#39;)q(x_t|x&#39;)}{g(x_t)q(x&#39;|x_t)}\right)\]</span></p></li>
<li><p>Accept <span class="math inline">\(x_{t+1}=x&#39;\)</span> with probability <span class="math inline">\(\alpha\)</span>, else <span class="math inline">\(x_{t+1}=x_t\)</span>.</p></li>
</ol>
<p><span class="math display">\[
\alpha=\min\left(1,\frac{g(x&#39;)q(x_t|x&#39;)}{g(x_t)q(x&#39;|x_t)}\right)
\]</span></p>
</div>
</div>
</div>
<div id="section-theory-questions" class="section level1">
<h1>Theory questions</h1>
<div id="section-question-1" class="section level2">
<h2>Question 1</h2>
<div class="boxed">
<p>Antibiotics are sometimes taken by people who have influenza symptoms although ’flu is caused by a virus. Various controlled comparative trials have been undertaken to investigate the efficacy of antibiotics for various diseases. It is expected, for example, that antibiotics would have little effect in reducing ’flu symptoms.</p>
<p>We have collected data on the times from infection until symptoms disappear for a given disease when patients are treated using the standard treatment <span class="math inline">\(S\)</span> and using a new treatment <span class="math inline">\(N\)</span>. We assume exponentially distributed times Exp<span class="math inline">\((\theta_1)\)</span> for the standard and Exp<span class="math inline">\((\theta_2)\)</span> for the new treatment. We assume a priori that <span class="math inline">\(\theta_1\)</span> and <span class="math inline">\(\theta_2\)</span> are independent both with Gamma<span class="math inline">\((c,c)\)</span> distributions, for some constant <span class="math inline">\(c\)</span>. Suppose there are <span class="math inline">\(n_{1}=10\)</span> patients for the standard treatment with sample mean <span class="math inline">\(\bar{y}_1=6.5\)</span> days, whilst there are <span class="math inline">\(n_{2}=15\)</span> patients for the new treatment with sample mean <span class="math inline">\(\bar{y}_2=5.0\)</span> days. Let <span class="math inline">\(c = 10^{-3}\)</span>.</p>
<p>Show that the likelihood<br />
<span class="math display">\[
p(\mathbf{y}_{1},\mathbf{y}_{2}~\vert~\theta_{1},\theta_{2}) \propto \theta_1^{n_{1}} \exp\{-\theta_1 n_{1} \bar{y}_1\} \times \theta_2^{n_{2}} \exp\{-\theta_2 n_{2} \bar{y}_2\}
\]</span> and that the posterior for <span class="math inline">\(\theta_1\)</span> and <span class="math inline">\(\theta_2\)</span> is given by <span class="math display">\[
p(\theta_1,\theta_2,|\mathbf{y}) \propto \theta_1^{n_{1}+c-1} \exp\{-\theta_1 (n_{1} \bar{y}_1+c)\} \times \theta_2^{n_{2}+c-1} \exp\{-\theta_2 (n_{2} \bar{y}_2+c)\},
\]</span> i.e. the posterior distributions for <span class="math inline">\(\theta_1\)</span> and <span class="math inline">\(\theta_2\)</span> are given by independent Gamma<span class="math inline">\((n_{1}+c,n_{1}\bar{y}_1+c)\)</span> and Gamma<span class="math inline">\((n_{2}+c,n_{2}\bar{y}_2+c)\)</span> random variables, respectively.</p>
</div>
<button class="solution">
Solution
</button>
<div class="panel">
<hr />
<p><em>Solution</em>:</p>
<p>The likelihood for an exponential data <span class="math inline">\(\mathbf{y}\)</span> is</p>
<p><span class="math display">\[
p(\mathbf{y}~\vert~\theta) = \prod_{i=1}^{n}\theta \exp\{-\theta y_{i}\} = \theta^{n}\exp\{-\theta n \bar{y}\}
\]</span> so for two groups of data with means <span class="math inline">\(\bar{y}_{1}\)</span> and <span class="math inline">\(\bar{y}_{2}\)</span> is the product of likelihoods <span class="math inline">\(p(\mathbf{y}_{1}~\vert~\theta_{1})\)</span> and <span class="math inline">\(p(\mathbf{y}_{2}~\vert~\theta_{2})\)</span> which is</p>
<p><span class="math display">\[
p(\mathbf{y}_{1},\mathbf{y}_{2}~\vert~\theta_{1},\theta_{2}) \propto \theta_1^{n_{1}} \exp\{-\theta_1 n_{1} \bar{y}_1\} \times \theta_2^{n_{2}} \exp\{-\theta_2 n_{2} \bar{y}_2\}
\]</span></p>
<p>The Gamma priors for <span class="math inline">\(\theta_{1}\)</span> and <span class="math inline">\(\theta_{2}\)</span> have density proprtional to</p>
<p><span class="math display">\[
p(\theta_{i}) \propto \theta_{i}^{c-1}\exp\{-c\theta_{i}\}
\]</span> so the posterior is</p>
<p><span class="math display">\[
p(\theta_{1},\theta_{2}~\vert~\mathbf{y}_{1},\mathbf{y}_{2}) \propto p(\mathbf{y}_{1},\mathbf{y}_{2}~\vert~\theta_{1},\theta_{2}) p(\theta_{1}) p(\theta_{2})
\]</span> which can be simplified to give the desired result.</p>
<hr />
</div>
</div>
<div id="section-question-2" class="section level2">
<h2>Question 2</h2>
<div class="boxed">
<p>When we use Monte Carlo simulation methods to estimate a quantity, usually a mean in statistics, then we should take into account the accuracy of the estimate by finding a standard error of the estimate. The standard error can be reduced by taking more Monte Carlo simulations. The accuracy of the estimate can be defined in terms of a fraction or percentage of the mean, <span class="math inline">\(\frac{\text{SE}(\hat{\mu})}{\hat{\mu}} = 1\%\)</span>. This question is about using sufficient Monte Carlo samples to obtain a given accuracy.</p>
<p>Let <span class="math inline">\(\theta_1\)</span> be the probability that treatment <span class="math inline">\(ABC\)</span> for an injured knee is successful. Suppose I assess my uncertainty about <span class="math inline">\(\theta_1\)</span> as represented by a Beta <span class="math inline">\((20,30)\)</span> distribution. That is, <span class="math inline">\(\theta_1\)</span> behaves like a random variable.</p>
<ol style="list-style-type: lower-alpha">
<li><p>By simulating <span class="math inline">\(1000\)</span> values from the Beta <span class="math inline">\((20,30)\)</span> distribution, estimate the means of <span class="math inline">\(\theta_1\)</span> and <span class="math inline">\(\tau = \theta_1/(1-\theta_1)\)</span>, the odds of success. How accurate are these estimates?<a href="#section-fn1" class="footnote-ref" id="section-fnref1"><sup>1</sup></a></p></li>
<li><p>If the mean of <span class="math inline">\(\theta_1\)</span> is to be estimated with <span class="math inline">\(1\%\)</span> accuracy (or standard error of estimate <span class="math inline">\(= 0.01 \times\)</span> estimated value) or better, are <span class="math inline">\(1000\)</span> values sufficient in number? How many values should be used in this simulation? Now repeat the same calculation for the mean of the odds <span class="math inline">\(\theta_1/(1-\theta_1)\)</span>. Compare the sample sizes required.</p></li>
<li><p>Let <span class="math inline">\(\theta_2\)</span> be the probability that treatment <span class="math inline">\(XYZ\)</span> is successful. My uncertainty about <span class="math inline">\(\theta_2\)</span> is represented by a Beta<span class="math inline">\((30,20)\)</span> distribution, independent of <span class="math inline">\(\theta_1\)</span>. By simulating <span class="math inline">\(1000\)</span> pairs of values of <span class="math inline">\((\theta_1,\theta_2)\)</span>, estimate the means of <span class="math inline">\(\theta_2-\theta_1\)</span>, <span class="math inline">\(\theta_2/\theta_1\)</span>, <span class="math inline">\(\frac{\theta_2/(1-\theta_2)}{\theta_1/(1-\theta_1)}\)</span> (the odds ratio success for treatment <span class="math inline">\(XYZ\)</span> to treatment <span class="math inline">\(ABC\)</span>), estimate the lower and upper <span class="math inline">\(25\%\)</span> percentiles of each of these distributions. What is my belief that treatment <span class="math inline">\(XYZ\)</span> is better than treatment <span class="math inline">\(ABC\)</span>?</p></li>
<li><p>Repeat parts (a)-(c) with <span class="math inline">\(\theta_1 \sim \text{Beta}(2,3)\)</span> and <span class="math inline">\(\theta_2\sim \text{Beta}(3,2)\)</span>. Do these distributions represent more or less certainty than above? Explain why the final conclusion about treatment <span class="math inline">\(XYZ\)</span> being better than treatment <span class="math inline">\(ABC\)</span> is different.</p></li>
</ol>
</div>
<button class="solution">
Solution
</button>
<div class="panel">
<hr />
<p><em>Solution</em>:</p>
<ol style="list-style-type: lower-alpha">
<li></li>
</ol>
<p><span class="math display">\[
\hat{\theta} = N^{-1}\sum_{i=1}^{N}x_{i}, \quad x_{i} \overset{\text{iid}}{\sim} \text{Beta}(20,30)
\]</span></p>
<p><span class="math display">\[
\text{Var}(\hat{\theta}) = N^{-2}\sum_{i=1}^{N}\text{Var}(x_{i}) = N^{-1}\frac{a b}{ (a+b)^2 (a+b+1) } = 4.705882 \times 10^{-6}
\]</span> since <span class="math inline">\(\text{Var}(x) = \frac{a b}{ (a+b)^2 (a+b+1) }\)</span> if <span class="math inline">\(x \sim \text{Beta}(a,b)\)</span>.</p>
<p>Therefore the standard error of <span class="math inline">\(\hat{\theta}\)</span> is 0.002169.</p>
<p>The estimator <span class="math inline">\(\hat{\tau} = \sum_{i=1}^{N}\frac{x_{i}}{1-x_{i}}\)</span> but each <span class="math inline">\(\frac{x_{i}}{1-x_{i}}\)</span> has a Beta prime distribution, with <span class="math display">\[
\text{Var}\left(\frac{x_{i}}{1-x_{i}}\right) = \frac{a(a+b-1)}{(b-2)(b-1)^{2}}
\]</span></p>
<p>Therefore, the variance of <span class="math inline">\(\hat\tau\)</span> is <span class="math display">\[
\text{Var}\left(\hat\tau\right) = N^{-1}\frac{a(a+b-1)}{(b-2)(b-1)^{2}}
\]</span> which corresponds to a standard error of 0.006451.</p>
<pre class="r"><code>
N &lt;- 1000
a &lt;- 20
b &lt;- 30

var_beta &lt;- a * b / ( ((a + b)^2) * (a + b + 1) )
var_beta_prime &lt;- a * (a + b - 1) / ( (b - 2) * (b - 1)^2 )
  
# standard error of \hat{\theta}:
se_theta_hat &lt;- sqrt(var_beta / N)

# standard error of \hat{\tau}:
se_tau_hat &lt;- sqrt(var_beta_prime / N)

# calculate means:
x &lt;- rbeta(n = N, shape1 = a, shape2 = b)

theta1_hat &lt;- mean( x )
approx_se_theta1_hat &lt;- sqrt( var(x)/N )
  
tau_hat &lt;- mean( x / (1 - x) )
approx_se_tau_hat &lt;- sqrt( var(x / (1 - x))/N )

cat(&quot;Theta1 estimate:\n&quot;)
#&gt; Theta1 estimate:
cat(theta1_hat,&quot;, true SE =&quot;, se_theta_hat, &quot;, approximate SE = &quot;, approx_se_theta1_hat)
#&gt; 0.3974962 , true SE = 0.002169305 , approximate SE =  0.002143427

cat(&quot;Tau estimate:\n&quot;)
#&gt; Tau estimate:
cat(tau_hat, &quot;, true SE =&quot;, se_tau_hat, &quot;, approximate SE = &quot;, approx_se_tau_hat)
#&gt; 0.6816917 , true SE = 0.006451133 , approximate SE =  0.006265368</code></pre>
<ol start="2" style="list-style-type: lower-alpha">
<li></li>
</ol>
<pre class="r"><code>
# use true or approximate SE...
se_theta_hat / theta1_hat
#&gt; [1] 0.005457422

se_tau_hat / tau_hat
#&gt; [1] 0.009463417

# both less than 1% currently. 
# Change N to determine required samples for desired accuracy.</code></pre>
<ol start="3" style="list-style-type: lower-alpha">
<li></li>
</ol>
<pre class="r"><code>
theta1 &lt;- rbeta(n = N, shape1 = a, shape2 = b)
theta2 &lt;- rbeta(n = N, shape1 = b, shape2 = a)

theta2_minus_theta1 &lt;- theta2 - theta1
theta2_div_theta1 &lt;- theta2 / theta1
odds_ratio &lt;- (theta2 / (1 - theta2)) / (theta1 / (1 - theta1))

mean(theta2_minus_theta1)
#&gt; [1] 0.2006144
mean(theta2_div_theta1)
#&gt; [1] 1.55204
mean(odds_ratio)
#&gt; [1] 2.49538

quantile(theta2_minus_theta1, probs = c(0.25,0.75))
#&gt;       25%       75% 
#&gt; 0.1351051 0.2695423
quantile(theta2_div_theta1, probs = c(0.25,0.75))
#&gt;      25%      75% 
#&gt; 1.318249 1.751834
quantile(odds_ratio, probs = c(0.25,0.75))
#&gt;      25%      75% 
#&gt; 1.741332 3.059637</code></pre>
<ol start="4" style="list-style-type: lower-alpha">
<li></li>
</ol>
<pre class="r"><code>
theta1 &lt;- rbeta(N, 2, 3, ncp = 0)
theta2 &lt;- rbeta(N, 3, 2, ncp = 0)

theta_est &lt;- mean(theta1)       # theoretical value = 0.4
theta_se &lt;- sqrt(var(theta1)/N)
theta_se/theta_est
#&gt; [1] 0.01580259
if(theta_se/theta_est &gt; 0.01){
  n &lt;- N
  while(theta_se/theta_est &gt; 0.01){
    n &lt;- n + 1
    theta_new &lt;- rbeta(n, 2, 3, ncp = 0)
    theta_est &lt;- mean(theta_new) 
    theta_se &lt;- sqrt(var(theta_new)/n)
  }
}
n
#&gt; [1] 2371


odds_est &lt;- mean(theta1/(1-theta1)) 
odds_se &lt;- sqrt(var((theta1/(1-theta1)))/N)
odds_se/odds_est
#&gt; [1] 0.03489535
if(odds_se/odds_est &gt; 0.01){
  n &lt;- N
  while(odds_se/odds_est &gt; 0.01){
    n &lt;- n + 10
    theta_new &lt;- rbeta(n, 2, 3, ncp = 0)
    odds_est &lt;- mean(theta_new/(1-theta_new))   
    odds_se &lt;- sqrt(var((theta_new/(1-theta_new)))/n)
  }
}
n
#&gt; [1] 16080


theta2_minus_theta1 &lt;- theta2 - theta1
mean(theta2_minus_theta1)
#&gt; [1] 0.2071164
quantile(theta2_minus_theta1, probs = c(0.25,0.75))
#&gt;        25%        75% 
#&gt; 0.01972805 0.40638968

theta2_div_theta1 &lt;- theta2/theta1
mean(theta2_div_theta1)
#&gt; [1] 2.347106
quantile(theta2_div_theta1, probs = c(0.25,0.75))
#&gt;      25%      75% 
#&gt; 1.048008 2.532933

theta_odds &lt;- (theta2 / (1 - theta2)) / (theta1 / (1 - theta1))
mean(theta_odds)
#&gt; [1] 9.374986
quantile(theta_odds, probs = c(0.25,0.75))
#&gt;      25%      75% 
#&gt; 1.094672 6.715998</code></pre>
<hr />
</div>
</div>
</div>
<div id="section-practical-questions" class="section level1">
<h1>Practical questions</h1>
<div id="section-question-3" class="section level2">
<h2>Question 3</h2>
<div class="boxed">
<p>This question continues from Question 1 (theory).</p>
<ol style="list-style-type: lower-alpha">
<li><p>By simulating pairs of values of <span class="math inline">\(\theta_1,\theta_2\)</span> from the posterior <span class="math inline">\(p(\theta_1,\theta_2|\mathbf{y})\)</span> estimate the posterior distribution of <span class="math inline">\(r = \theta_1^{-1}-\theta_2^{-1}\)</span>, the mean reduction in infection time until symptom free, comparing the new treatment with the standard.</p></li>
<li><p>What is the approximate probability that <span class="math inline">\(p(r \leq 1 ~\vert~ \boldsymbol{y})\)</span>?</p></li>
<li><p>Write a random-walk Metropolis-Hastings (RWMH) algorithm to simulate from <span class="math inline">\(p(\theta_1,\theta_2|\mathbf{y})\)</span> using</p>
<ol style="list-style-type: lower-roman">
<li>Truncated normal proposal (truncated at zero to avoid having negative proposals).</li>
<li>Pareto proposal distribution, with support on <span class="math inline">\([0,\infty)\)</span>.</li>
</ol></li>
<li><p>Approximate <span class="math inline">\(E(r)\)</span> using the samples from the two RWMH for a fixed number of samples. Compare to iid Gamma samples from the posterior. Approximate how large <span class="math inline">\(N\)</span> needs to be before you the three estimates are indistinguishable (use graphical methods).</p></li>
<li><p>Evalulate the performance of the RWMH algoirthms using trace, running mean, and (partial) auto-correlation plots, as well as effective sample size approximations.<a href="#section-fn2" class="footnote-ref" id="section-fnref2"><sup>2</sup></a> Based on these metrics, should you run your sampler for a longer than <span class="math inline">\(N=3000\)</span> iterations?</p></li>
<li><p>What proportion of iterations were accepted (by the MH ratio)? Is this proportion close to optimal?</p></li>
</ol>
</div>
<button class="solution">
Solution
</button>
<div class="panel">
<hr />
<p><em>Solution</em>:</p>
<p>(a)/(b) Exact sampling with independent Gamma</p>
<pre class="r"><code>
n &lt;- c(10, 15)
y_bar &lt;- c(6.5,5.0)

sim_gamma_posterior &lt;- function(n_sim, n_sample, y_bar){
  
  cbind(
    rgamma(n = n_sim, shape = n[1] + 10e-03, rate = n[1]*y_bar[1] + 10e-03),
    rgamma(n = n_sim, shape = n[2] + 10e-03, rate = n[2]*y_bar[2] + 10e-03)
  )
  
}

exact_samples &lt;- sim_gamma_posterior(n_sim = 5000, n_sample = n, y_bar = y_bar)

# (a) approximate distribution of r = \theta_1^{-1}-\theta_2^{-1}:

r_sim_exact &lt;- exact_samples[,1]^(-1) - exact_samples[,2]^(-1)

hist(r_sim_exact)</code></pre>
<div class="figure" style="text-align: center">
<img src="mxb341-ws-09_files/figure-html/mh-algorithm-q2-1.png" alt="Approx posterior distribution of r" width="624" />
<p class="caption">
Approx posterior distribution of r
</p>
</div>
<pre class="r"><code>
# (b) P(r &lt;= 1 | y)
mean(r_sim_exact &lt;= 1)
#&gt; [1] 0.4068</code></pre>
<ol start="3" style="list-style-type: lower-alpha">
<li>Random-walk metropolis Hasting Algorithm with independent normal distributions truncated at zero as proposal <span class="math display">\[
q(\theta_{1}&#39;, \theta_{2}&#39; ~\vert~ \theta_{1}, \theta_{2}) = \text{N}(\theta_{1}, s^2) \times \text{N}(\theta_{1}, s^2) \quad \text{s.t.} \quad \theta_{1} &gt; 0,~ \theta_{2} &gt; 0.
\]</span> <span class="math inline">\((\theta_{1}&#39;, \theta_{2}&#39;)\)</span> is “new” or proposed random variable, and <span class="math inline">\((\theta_{1}, \theta_{2})\)</span> is the current random variable.</li>
</ol>
<pre class="r"><code>
# (c)(i) This code is for the RWMH algorithm with truncated normal proposal

library(extraDistr)
#&gt; 
#&gt; Attaching package: &#39;extraDistr&#39;
#&gt; The following object is masked from &#39;package:purrr&#39;:
#&gt; 
#&gt;     rdunif

gamma2_log_posterior_prop &lt;- 
  function(theta1, theta2, 
          n1, n2, y1_mean, y2_mean, 
          alpha_prior = 10e-03, beta_prior = 10e-03){
  
  if(theta1 &lt;= 0 | theta2 &lt;= 0) return(-Inf)
  
  (n1 + alpha_prior - 1) * log( theta1 ) - theta1 * (y1_mean * n1 + beta_prior) +
    (n2 + alpha_prior - 1) * log( theta2 ) - theta2 * (y2_mean * n2 + beta_prior)
  
}

n1 &lt;- 10
y1_mean &lt;- 6.5
n2 &lt;- 15
y2_mean &lt;- 5.0

gamma2_log_posterior_prop(theta1 = 1, theta2 = 1,
                          n1 = n1, n2 = n2, 
                          y1_mean = y1_mean, y2_mean = y2_mean)
#&gt; [1] -140.02


rwmh_sampler_gibbs &lt;- function(n_samples, kernel_scale){
  
  # storage and initialise samples
  samples &lt;- matrix(0, nrow = n_samples, ncol = 2)
  samples[1,] &lt;- 1
  
  sum_accept &lt;- 0
  
  for(t in 2:n_samples){
    
    # sample proposal
    proposal &lt;- rtnorm(n = 2, mean = samples[t-1,], sd = kernel_scale, a = 0)
    
    # calculate densities at proposal and current position
    log_proposal_given_current_dens &lt;- 
      sum(dtnorm(proposal, mean = samples[t-1,], sd = kernel_scale, a = 0, log = TRUE))
    
    log_current_given_proposal_dens &lt;- 
      sum(dtnorm(samples[t-1,], mean = proposal, sd = kernel_scale, a = 0, log = TRUE))
    
    log_posterior_proposal_density &lt;- 
      gamma2_log_posterior_prop(theta1 = proposal[1], theta2 = proposal[2],
                            n1 = n1, n2 = n2, 
                            y1_mean = y1_mean, y2_mean = y2_mean)
    
    log_posterior_current_density &lt;- 
      gamma2_log_posterior_prop(theta1 = samples[t-1,1], theta2 = samples[t-1,2],
                            n1 = n1, n2 = n2, 
                            y1_mean = y1_mean, y2_mean = y2_mean)
    
    log_ratio &lt;- log_posterior_proposal_density + log_current_given_proposal_dens - 
      (log_posterior_current_density + log_proposal_given_current_dens)
    
    accept &lt;- exp(log_ratio) &gt; runif(1)
    if(accept){
      samples[t,] &lt;- proposal
    } else {
      samples[t,] &lt;- samples[t-1,]
    }
  
    sum_accept &lt;- sum_accept + accept
    
  }
   
  cat(&quot;Proportion accepted:&quot;, round(sum_accept/(n_samples-1),2) )
   
  return(samples)
  
}

samples &lt;- rwmh_sampler_gibbs(n_samples=10000, kernel_scale=0.1)
#&gt; Proportion accepted: 0.32

samples_post_burnin &lt;- samples[5001:10000,]</code></pre>
<ol start="4" style="list-style-type: lower-alpha">
<li></li>
</ol>
<pre class="r"><code>
# (d)

# running mean of samples:
plot(
  cumsum(samples_post_burnin[,1])/(1:nrow(samples_post_burnin)),
  type = &quot;l&quot;, xlab = &quot;Iteration&quot;, ylab = &quot;Theta1&quot;)</code></pre>
<div class="figure" style="text-align: center">
<img src="mxb341-ws-09_files/figure-html/run-mean-1.png" alt="Running mean plot" width="624" />
<p class="caption">
Running mean plot
</p>
</div>
<pre class="r"><code>
plot(
  cumsum(samples_post_burnin[,2])/(1:nrow(samples_post_burnin)), 
  type = &quot;l&quot;, xlab = &quot;Iteration&quot;, ylab = &quot;Theta2&quot;)</code></pre>
<div class="figure" style="text-align: center">
<img src="mxb341-ws-09_files/figure-html/run-mean-2.png" alt="Running mean plot" width="624" />
<p class="caption">
Running mean plot
</p>
</div>
<pre class="r"><code>
# compared to 
mean(r_sim_exact)
#&gt; [1] 1.869796</code></pre>
<ol start="5" style="list-style-type: lower-alpha">
<li></li>
</ol>
<pre class="r"><code>
# trace plot

plot(samples_post_burnin[,1], type = &quot;l&quot;,  
     xlab = &quot;Iteration&quot;, ylab = &quot;Theta1&quot;)</code></pre>
<div class="figure" style="text-align: center">
<img src="mxb341-ws-09_files/figure-html/trace-1.png" alt="Trace plot" width="624" />
<p class="caption">
Trace plot
</p>
</div>
<pre class="r"><code>plot(samples_post_burnin[,2], type = &quot;l&quot;,  
     xlab = &quot;Iteration&quot;, ylab = &quot;Theta2&quot;)</code></pre>
<div class="figure" style="text-align: center">
<img src="mxb341-ws-09_files/figure-html/trace-2.png" alt="Trace plot" width="624" />
<p class="caption">
Trace plot
</p>
</div>
<pre class="r"><code>
# effective sample size
library(coda)

effectiveSize(samples_post_burnin[,1])
#&gt;     var1 
#&gt; 728.7268
effectiveSize(samples_post_burnin[,2])
#&gt;    var1 
#&gt; 680.633</code></pre>
<pre class="r"><code>
# (p)acf

pacf(samples_post_burnin[,1])</code></pre>
<div class="figure" style="text-align: center">
<img src="mxb341-ws-09_files/figure-html/pacf-1.png" alt="PACF plot" width="624" />
<p class="caption">
PACF plot
</p>
</div>
<pre class="r"><code>
#pacf(samples_post_burnin[,2])</code></pre>
<ol start="6" style="list-style-type: lower-alpha">
<li>The optimal (asymptotic) acceptance rate is 0.234 for a limited set of target distributions (see <a href="https://projecteuclid.org/euclid.bj/1251463281" class="uri">https://projecteuclid.org/euclid.bj/1251463281</a> for more information). A rate of 0.25 is generally what is aimed for in practice. Check your rejection rate against this.</li>
</ol>
<hr />
</div>
<script>
var acc = document.getElementsByClassName("solution");
var i   ;

for (i = 0; i < acc.length; i++) {
  acc[i].addEventListener("click", function() {
    /* Toggle between adding and removing the "active" class,
    to highlight the button that controls the panel */
    this.classList.toggle("active");

    /* Toggle between hiding and showing the active panel */
    var panel = this.nextElementSibling;
    if (panel.style.display === "block") {
      panel.style.display = "none";
    } else {
      panel.style.display = "block";
    }
  });
}
</script>

<script type="application/shiny-prerendered" data-context="server-start">
# if problems with knitting directory:
# set Knit Directory = Document Directory

# install libraries needed for worksheet
knitr::opts_chunk$set(
  fig.align = 'center',
  collapse = TRUE,
  comment = "#>"
)

library(learnr)
library(kableExtra)
library(pander)
library(shiny)
library(MXB341)


</script>
 
<script type="application/shiny-prerendered" data-context="server">
learnr:::register_http_handlers(session, metadata = NULL)
</script>
 
<script type="application/shiny-prerendered" data-context="server">
session$onSessionEnded(function() {
        learnr:::session_stop_event(session)
      })
</script>
 <!--html_preserve-->
<script type="application/shiny-prerendered" data-context="dependencies">
{"type":"list","attributes":{},"value":[{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name","version","src","meta","script","stylesheet","head","attachment","package","all_files","pkgVersion"]},"class":{"type":"character","attributes":{},"value":["html_dependency"]}},"value":[{"type":"character","attributes":{},"value":["header-attrs"]},{"type":"character","attributes":{},"value":["2.11"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["file"]}},"value":[{"type":"character","attributes":{},"value":["rmd/h/pandoc"]}]},{"type":"NULL"},{"type":"character","attributes":{},"value":["header-attrs.js"]},{"type":"NULL"},{"type":"NULL"},{"type":"NULL"},{"type":"character","attributes":{},"value":["rmarkdown"]},{"type":"logical","attributes":{},"value":[true]},{"type":"character","attributes":{},"value":["2.11"]}]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name","version","src","meta","script","stylesheet","head","attachment","package","all_files"]},"class":{"type":"character","attributes":{},"value":["html_dependency"]}},"value":[{"type":"character","attributes":{},"value":["jquery"]},{"type":"character","attributes":{},"value":["3.6.0"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["file"]}},"value":[{"type":"character","attributes":{},"value":["lib/3.6.0"]}]},{"type":"NULL"},{"type":"character","attributes":{},"value":["jquery-3.6.0.min.js"]},{"type":"NULL"},{"type":"NULL"},{"type":"NULL"},{"type":"character","attributes":{},"value":["jquerylib"]},{"type":"logical","attributes":{},"value":[true]}]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name","version","src","meta","script","stylesheet","head","attachment","package","all_files","pkgVersion"]},"class":{"type":"character","attributes":{},"value":["html_dependency"]}},"value":[{"type":"character","attributes":{},"value":["bootstrap"]},{"type":"character","attributes":{},"value":["3.3.5"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["file"]}},"value":[{"type":"character","attributes":{},"value":["rmd/h/bootstrap"]}]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["viewport"]}},"value":[{"type":"character","attributes":{},"value":["width=device-width, initial-scale=1"]}]},{"type":"character","attributes":{},"value":["js/bootstrap.min.js","shim/html5shiv.min.js","shim/respond.min.js"]},{"type":"character","attributes":{},"value":["css/yeti.min.css"]},{"type":"character","attributes":{},"value":["<style>h1 {font-size: 34px;}\n       h1.title {font-size: 38px;}\n       h2 {font-size: 30px;}\n       h3 {font-size: 24px;}\n       h4 {font-size: 18px;}\n       h5 {font-size: 16px;}\n       h6 {font-size: 12px;}\n       code {color: inherit; background-color: rgba(0, 0, 0, 0.04);}\n       pre:not([class]) { background-color: white }<\/style>"]},{"type":"NULL"},{"type":"character","attributes":{},"value":["rmarkdown"]},{"type":"logical","attributes":{},"value":[true]},{"type":"character","attributes":{},"value":["2.11"]}]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name","version","src","meta","script","stylesheet","head","attachment","package","all_files","pkgVersion"]},"class":{"type":"character","attributes":{},"value":["html_dependency"]}},"value":[{"type":"character","attributes":{},"value":["pagedtable"]},{"type":"character","attributes":{},"value":["1.1"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["file"]}},"value":[{"type":"character","attributes":{},"value":["rmd/h/pagedtable-1.1"]}]},{"type":"NULL"},{"type":"character","attributes":{},"value":["js/pagedtable.js"]},{"type":"character","attributes":{},"value":["css/pagedtable.css"]},{"type":"NULL"},{"type":"NULL"},{"type":"character","attributes":{},"value":["rmarkdown"]},{"type":"logical","attributes":{},"value":[true]},{"type":"character","attributes":{},"value":["2.11"]}]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name","version","src","meta","script","stylesheet","head","attachment","package","all_files","pkgVersion"]},"class":{"type":"character","attributes":{},"value":["html_dependency"]}},"value":[{"type":"character","attributes":{},"value":["highlightjs"]},{"type":"character","attributes":{},"value":["9.12.0"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["file"]}},"value":[{"type":"character","attributes":{},"value":["rmd/h/highlightjs"]}]},{"type":"NULL"},{"type":"character","attributes":{},"value":["highlight.js"]},{"type":"character","attributes":{},"value":["textmate.css"]},{"type":"NULL"},{"type":"NULL"},{"type":"character","attributes":{},"value":["rmarkdown"]},{"type":"logical","attributes":{},"value":[true]},{"type":"character","attributes":{},"value":["2.11"]}]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name","version","src","meta","script","stylesheet","head","attachment","package","all_files","pkgVersion"]},"class":{"type":"character","attributes":{},"value":["html_dependency"]}},"value":[{"type":"character","attributes":{},"value":["tutorial"]},{"type":"character","attributes":{},"value":["0.10.1"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["file"]}},"value":[{"type":"character","attributes":{},"value":["lib/tutorial"]}]},{"type":"NULL"},{"type":"character","attributes":{},"value":["tutorial.js"]},{"type":"character","attributes":{},"value":["tutorial.css"]},{"type":"NULL"},{"type":"NULL"},{"type":"character","attributes":{},"value":["learnr"]},{"type":"logical","attributes":{},"value":[true]},{"type":"character","attributes":{},"value":["0.10.1"]}]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name","version","src","meta","script","stylesheet","head","attachment","package","all_files","pkgVersion"]},"class":{"type":"character","attributes":{},"value":["html_dependency"]}},"value":[{"type":"character","attributes":{},"value":["tutorial-autocompletion"]},{"type":"character","attributes":{},"value":["0.10.1"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["file"]}},"value":[{"type":"character","attributes":{},"value":["lib/tutorial"]}]},{"type":"NULL"},{"type":"character","attributes":{},"value":["tutorial-autocompletion.js"]},{"type":"NULL"},{"type":"NULL"},{"type":"NULL"},{"type":"character","attributes":{},"value":["learnr"]},{"type":"logical","attributes":{},"value":[true]},{"type":"character","attributes":{},"value":["0.10.1"]}]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name","version","src","meta","script","stylesheet","head","attachment","package","all_files","pkgVersion"]},"class":{"type":"character","attributes":{},"value":["html_dependency"]}},"value":[{"type":"character","attributes":{},"value":["tutorial-diagnostics"]},{"type":"character","attributes":{},"value":["0.10.1"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["file"]}},"value":[{"type":"character","attributes":{},"value":["lib/tutorial"]}]},{"type":"NULL"},{"type":"character","attributes":{},"value":["tutorial-diagnostics.js"]},{"type":"NULL"},{"type":"NULL"},{"type":"NULL"},{"type":"character","attributes":{},"value":["learnr"]},{"type":"logical","attributes":{},"value":[true]},{"type":"character","attributes":{},"value":["0.10.1"]}]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name","version","src","meta","script","stylesheet","head","attachment","package","all_files","pkgVersion"]},"class":{"type":"character","attributes":{},"value":["html_dependency"]}},"value":[{"type":"character","attributes":{},"value":["tutorial-format"]},{"type":"character","attributes":{},"value":["0.10.1"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["file"]}},"value":[{"type":"character","attributes":{},"value":["rmarkdown/templates/tutorial/resources"]}]},{"type":"NULL"},{"type":"character","attributes":{},"value":["tutorial-format.js"]},{"type":"character","attributes":{},"value":["tutorial-format.css"]},{"type":"NULL"},{"type":"NULL"},{"type":"character","attributes":{},"value":["learnr"]},{"type":"logical","attributes":{},"value":[true]},{"type":"character","attributes":{},"value":["0.10.1"]}]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name","version","src","meta","script","stylesheet","head","attachment","package","all_files"]},"class":{"type":"character","attributes":{},"value":["html_dependency"]}},"value":[{"type":"character","attributes":{},"value":["jquery"]},{"type":"character","attributes":{},"value":["3.6.0"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["file"]}},"value":[{"type":"character","attributes":{},"value":["lib/3.6.0"]}]},{"type":"NULL"},{"type":"character","attributes":{},"value":["jquery-3.6.0.min.js"]},{"type":"NULL"},{"type":"NULL"},{"type":"NULL"},{"type":"character","attributes":{},"value":["jquerylib"]},{"type":"logical","attributes":{},"value":[true]}]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name","version","src","meta","script","stylesheet","head","attachment","package","all_files","pkgVersion"]},"class":{"type":"character","attributes":{},"value":["html_dependency"]}},"value":[{"type":"character","attributes":{},"value":["navigation"]},{"type":"character","attributes":{},"value":["1.1"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["file"]}},"value":[{"type":"character","attributes":{},"value":["rmd/h/navigation-1.1"]}]},{"type":"NULL"},{"type":"character","attributes":{},"value":["tabsets.js"]},{"type":"NULL"},{"type":"NULL"},{"type":"NULL"},{"type":"character","attributes":{},"value":["rmarkdown"]},{"type":"logical","attributes":{},"value":[true]},{"type":"character","attributes":{},"value":["2.11"]}]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name","version","src","meta","script","stylesheet","head","attachment","package","all_files","pkgVersion"]},"class":{"type":"character","attributes":{},"value":["html_dependency"]}},"value":[{"type":"character","attributes":{},"value":["highlightjs"]},{"type":"character","attributes":{},"value":["9.12.0"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["file"]}},"value":[{"type":"character","attributes":{},"value":["rmd/h/highlightjs"]}]},{"type":"NULL"},{"type":"character","attributes":{},"value":["highlight.js"]},{"type":"character","attributes":{},"value":["default.css"]},{"type":"NULL"},{"type":"NULL"},{"type":"character","attributes":{},"value":["rmarkdown"]},{"type":"logical","attributes":{},"value":[true]},{"type":"character","attributes":{},"value":["2.11"]}]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name","version","src","meta","script","stylesheet","head","attachment","package","all_files"]},"class":{"type":"character","attributes":{},"value":["html_dependency"]}},"value":[{"type":"character","attributes":{},"value":["jquery"]},{"type":"character","attributes":{},"value":["3.6.0"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["file"]}},"value":[{"type":"character","attributes":{},"value":["lib/3.6.0"]}]},{"type":"NULL"},{"type":"character","attributes":{},"value":["jquery-3.6.0.min.js"]},{"type":"NULL"},{"type":"NULL"},{"type":"NULL"},{"type":"character","attributes":{},"value":["jquerylib"]},{"type":"logical","attributes":{},"value":[true]}]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name","version","src","meta","script","stylesheet","head","attachment","package","all_files","pkgVersion"]},"class":{"type":"character","attributes":{},"value":["html_dependency"]}},"value":[{"type":"character","attributes":{},"value":["font-awesome"]},{"type":"character","attributes":{},"value":["5.1.0"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["file"]}},"value":[{"type":"character","attributes":{},"value":["rmd/h/fontawesome"]}]},{"type":"NULL"},{"type":"NULL"},{"type":"character","attributes":{},"value":["css/all.css","css/v4-shims.css"]},{"type":"NULL"},{"type":"NULL"},{"type":"character","attributes":{},"value":["rmarkdown"]},{"type":"logical","attributes":{},"value":[true]},{"type":"character","attributes":{},"value":["2.11"]}]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name","version","src","meta","script","stylesheet","head","attachment","package","all_files","pkgVersion"]},"class":{"type":"character","attributes":{},"value":["html_dependency"]}},"value":[{"type":"character","attributes":{},"value":["bootbox"]},{"type":"character","attributes":{},"value":["4.4.0"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["file"]}},"value":[{"type":"character","attributes":{},"value":["lib/bootbox"]}]},{"type":"NULL"},{"type":"character","attributes":{},"value":["bootbox.min.js"]},{"type":"NULL"},{"type":"NULL"},{"type":"NULL"},{"type":"character","attributes":{},"value":["learnr"]},{"type":"logical","attributes":{},"value":[true]},{"type":"character","attributes":{},"value":["0.10.1"]}]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name","version","src","meta","script","stylesheet","head","attachment","package","all_files","pkgVersion"]},"class":{"type":"character","attributes":{},"value":["html_dependency"]}},"value":[{"type":"character","attributes":{},"value":["idb-keyvalue"]},{"type":"character","attributes":{},"value":["3.2.0"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["file"]}},"value":[{"type":"character","attributes":{},"value":["lib/idb-keyval"]}]},{"type":"NULL"},{"type":"character","attributes":{},"value":["idb-keyval-iife-compat.min.js"]},{"type":"NULL"},{"type":"NULL"},{"type":"NULL"},{"type":"character","attributes":{},"value":["learnr"]},{"type":"logical","attributes":{},"value":[false]},{"type":"character","attributes":{},"value":["0.10.1"]}]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name","version","src","meta","script","stylesheet","head","attachment","package","all_files","pkgVersion"]},"class":{"type":"character","attributes":{},"value":["html_dependency"]}},"value":[{"type":"character","attributes":{},"value":["tutorial"]},{"type":"character","attributes":{},"value":["0.10.1"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["file"]}},"value":[{"type":"character","attributes":{},"value":["lib/tutorial"]}]},{"type":"NULL"},{"type":"character","attributes":{},"value":["tutorial.js"]},{"type":"character","attributes":{},"value":["tutorial.css"]},{"type":"NULL"},{"type":"NULL"},{"type":"character","attributes":{},"value":["learnr"]},{"type":"logical","attributes":{},"value":[true]},{"type":"character","attributes":{},"value":["0.10.1"]}]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name","version","src","meta","script","stylesheet","head","attachment","package","all_files","pkgVersion"]},"class":{"type":"character","attributes":{},"value":["html_dependency"]}},"value":[{"type":"character","attributes":{},"value":["tutorial-autocompletion"]},{"type":"character","attributes":{},"value":["0.10.1"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["file"]}},"value":[{"type":"character","attributes":{},"value":["lib/tutorial"]}]},{"type":"NULL"},{"type":"character","attributes":{},"value":["tutorial-autocompletion.js"]},{"type":"NULL"},{"type":"NULL"},{"type":"NULL"},{"type":"character","attributes":{},"value":["learnr"]},{"type":"logical","attributes":{},"value":[true]},{"type":"character","attributes":{},"value":["0.10.1"]}]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name","version","src","meta","script","stylesheet","head","attachment","package","all_files","pkgVersion"]},"class":{"type":"character","attributes":{},"value":["html_dependency"]}},"value":[{"type":"character","attributes":{},"value":["tutorial-diagnostics"]},{"type":"character","attributes":{},"value":["0.10.1"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["file"]}},"value":[{"type":"character","attributes":{},"value":["lib/tutorial"]}]},{"type":"NULL"},{"type":"character","attributes":{},"value":["tutorial-diagnostics.js"]},{"type":"NULL"},{"type":"NULL"},{"type":"NULL"},{"type":"character","attributes":{},"value":["learnr"]},{"type":"logical","attributes":{},"value":[true]},{"type":"character","attributes":{},"value":["0.10.1"]}]}]}
</script>
<!--/html_preserve-->
<!--html_preserve-->
<script type="application/shiny-prerendered" data-context="execution_dependencies">
{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["packages"]}},"value":[{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["packages","version"]},"class":{"type":"character","attributes":{},"value":["data.frame"]},"row.names":{"type":"integer","attributes":{},"value":[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,84,85,86,87,88,89,90,91,92,93,94,95,96,97,98,99,100]}},"value":[{"type":"character","attributes":{},"value":["assertthat","backports","base","broom","bslib","cellranger","cli","coda","colorspace","compiler","crayon","datasets","DBI","dbplyr","digest","dplyr","ellipsis","evaluate","extraDistr","fansi","farver","fastmap","forcats","fs","generics","ggforce","ggplot2","ggtext","glue","graphics","grDevices","grid","gridExtra","gridtext","gtable","haven","highr","hms","htmltools","htmlwidgets","httpuv","httr","jquerylib","jsonlite","kableExtra","knitr","later","lattice","learnr","lifecycle","lubridate","magrittr","markdown","MASS","methods","mime","modelr","munsell","MXB341","pander","pillar","pkgconfig","polyclip","pracma","promises","purrr","R6","Rcpp","readr","readxl","reprex","rlang","rmarkdown","rprojroot","rstudioapi","rvest","sass","scales","shiny","stats","stringi","stringr","svglite","systemfonts","tibble","tidyr","tidyselect","tidyverse","tools","tweenr","utf8","utils","vctrs","viridisLite","webshot","withr","xfun","xml2","xtable","yaml"]},{"type":"character","attributes":{},"value":["0.2.1","1.2.1","4.0.5","0.7.8","0.2.5.1","1.1.0","2.5.0","0.19-4","2.0-2","4.0.5","1.4.1","4.0.5","1.1.1","2.1.1","0.6.27","1.0.7","0.3.2","0.14","1.9.1","0.5.0","2.1.0","1.1.0","0.5.1","1.5.0","0.1.0","0.3.3","3.3.5","0.1.1","1.5.0","4.0.5","4.0.5","4.0.5","2.3","0.1.4","0.3.0","2.4.1","0.9","1.1.0","0.5.1.1","1.5.3","1.6.1","1.4.2","0.1.4","1.7.2","1.3.4","1.33","1.2.0","0.20-44","0.10.1","1.0.0","1.7.10","2.0.1","1.1","7.3-54","4.0.5","0.12","0.1.8","0.5.0","1.0.0.2021","0.6.4","1.6.1","2.0.3","1.10-0","2.3.3","1.2.0.1","0.3.4","2.5.1","1.0.6","1.4.0","1.3.1","2.0.0","0.4.12","2.11","2.0.2","0.13","1.0.0","0.4.0","1.1.1","1.6.0","4.0.5","1.6.2","1.4.0","2.0.0","1.0.2","3.1.2","1.1.3","1.1.1","1.3.1","4.0.5","1.0.2","1.2.1","4.0.5","0.3.8","0.4.0","0.5.2","2.4.2","0.24","1.3.2","1.8-4","2.2.1"]}]}]}
</script>
<!--/html_preserve-->
</div>
</div>
<div class="footnotes">
<hr />
<ol>
<li id="section-fn1"><p>Hint: Find the standard errors of the estimates. Note that <span class="math inline">\(\tau\)</span> is distributed according to a Beta prime distribution.<a href="#section-fnref1" class="footnote-back">↩︎</a></p></li>
<li id="section-fn2"><p>Hint: <code>[p]acf()</code> and <code>effectiveSize()</code> in the <code>coda</code> package can assist you. Don’t forget to discard the first part of your sample as burnin.<a href="#section-fnref2" class="footnote-back">↩︎</a></p></li>
</ol>
</div>

</div> <!-- topics -->

<div class="topicsContainer">
<div class="topicsPositioner">
<div class="band">
<div class="bandContent topicsListContainer">

<!-- begin doc-metadata -->
<div id="doc-metadata">
<h2 class="title toc-ignore" style="display:none;">MXB341 Worksheet 09 - Bayesian Inference</h2>
</div>
<!-- end doc-metadata -->

</div> <!-- bandContent.topicsListContainer -->
</div> <!-- band -->
</div> <!-- topicsPositioner -->
</div> <!-- topicsContainer -->


</div> <!-- bandContent page -->
</div> <!-- pageContent band -->




<script>
// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.header').parent('thead').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});
</script>


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>


</body>

</html>
